{"summary": "the accuracy of SURPI aligners was evaluated by benchmarking its nucleotide alignment tool, SNAP, against BLASTn and two other aligners commonly used for human genome mapping. SNAP showed the highest specificity (>99.8%) and comparable sensitivity to BLASTn. a query data set of 100 base pair reads was randomly generated in silico from human, bacterial, and viral reference databases. SNAP and BLASTn were superior to BWA and BT2 in identifying reads from divergent viruses using low-stringency parameters. overall poor performance of all four nucleotide aligners in detecting divergent viral reads (20% sensitivity) underscored need for translated nucleotide alignment algorithms such as RAPSearch and BLASTx. Detection of reads corresponding to four viral genomes by nucleotide alignment. sequences of these viruses were removed from nucleotide and protein viral reference databases prior to alignment. speed of SURPI aligners (SNAP and RAPSearch) using in silico data. z-axis denotes approximate number of reads following computational subtraction against the human DB. SNAP performance times were benchmarked separately on local and cloud servers. SNAP and BLASTn exhibited superior sensitivity than BWA and BT2 in detection of reads corresponding to these three viruses. both exhibited superior sensitivity than BWA and BT2 in detection. SNAP and RAPSearch had comparable accuracy to BLASTx across all three clinical data sets. ROC curves were generated to evaluate the ability of nucleotide and translated nucleotide aligners to detect reads corresponding to three target viruses. SURPI was used to accurately classify viral pathogens down to the species and even strain level in various clinical metagenomic NGS data sets. plasma samples spiked with human immunodeficiency virus (HIV-1) at titers ranging from 102 to 104 copies/mL were identified and mapped to the correct strain. the SURPI pipeline correctly identifies viral species in clinical NGS data sets. target viruses are color-coded in yellow or orange. other viruses are color-coded ranked by their relative abundance in shades of blue. coverage plot mapping SURPI-classified genus-level Mastadenovirus reads (red/pink) to the SAdV-18 genome, or Mastadenovirus reads (red/pink) and all specific BASV reads (gray) to the BASV genome. in comprehensive mode, SURPI successfully identified adenovirus sequences in lung samples from moribund titi monkeys with TMAdV pneumonia. s classified as Rhabdoviridae were detected on the basis of protein homology using RAPSearch. a subsequent NGS data set was generated from the same serum aliquot. this data set was devoid of rotaviral sequences and because of longer reads and higher coverage of BASV. nucleatum was identified, with a 29-fold increase in tumor versus control samples. three NGS data sets corresponding to clinical samples or sample pools were analyzed using SURPI in comprehensive mode. in fast mode, processing times ranged from 11 min to nearly 5 h. in comprehensive mode, SURPI took 59 min to 16 h. overall, SURPI in fast mode was 5.3 faster than in comprehensive mode. sequences spanning genome of human herpesvirus 7 (HHV-7) were detected. no other pathogens were identified in patient sera and acute antibody IgG/IgM titers for HHV-7 were negative. the patient recovered spontaneously without any complications. ROC curves were generated to assess the sensitivity and specificity of each aligner in classifying human, bacterial, or viral reads. all nucleotide aligners shared >99.5% optimal sensitivity and specificity for human sequence identification. SNAP showed the highest specificity (>99.8%) and comparable sensitivity to BLASTn. detect in silico-generated NGS reads when mapped against human DB (A), bacterial DB (B) or viral nucleotide DB (C) accuracy of detection was assessed using Youden\u2019s index and the F1 score. ally longer estimated times for the larger data sets. SNAP scaled significantly better with larger data sets. ally was 2387 faster than BWA and BT2. RAPSearch was found to be 510 faster than BLASTx across all query data sets. ROC curves for viral detection were generated from three computationally challenging NGS data sets. SNAP and BLASTn exhibited superior sensitivity than BWA and BT2 in detection of reads corresponding to these viruses. 15 true hantavirus reads not detected by SNAP improved sensitivity from 93.8% to 98.1% due to increased detection of previously undetected reads without affecting specificity. by ROC curve analysis, RAPSearch had comparable accuracy to BLASTx across all three clinical data sets. read cropping prior to SNAP alignment to a length of 75 bp to maximize sensitivity for chimeric reads. read cropping prior to SNAP alignment to a length of 75 bp to maximize sensitivity for chimeric reads. serial coupling of SNAP and RAPSearch algorithms to maximize speed without sacrificing breadth of detection. in comprehensive mode, incorporating nucleotide alignments to the NCBI nt DB and viral protein similarity searches, SURPI was able to detect essentially 100% of viral reads corresponding to a given species. in contrast, due to lack of a protein similarity search step, SURPI in fast mode showed noticeably less coverage for more divergent viruses. coverage plots of HIV-1 spiked at titers of 102104 copies/mL. the number of mapped reads and percent coverage are plotted against the viral copy number (inset) the number of mapped reads and percent coverage are plotted against the viral copy number. in comprehensive mode, coverage of 41% of the TMAdV genome was achieved. in comprehensive mode, reads classified as Rhabdoviridae were detected on the basis of protein homology using RAPSearch (Fig. 5G) SURPI was used to analyze publicly available data from a study that detected an increase in aligned reads aligning to Fusobacterium nucleatum. a 29-fold increase in tumor versus control samples was identified. three NGS data sets corresponding to clinical samples or sample pools were analyzed using SURPI in comprehensive mode. speed of SURPI and feasibility for real-time clinical analysis. analyzed 15 data sets ranging from 6.7 to 509 million reads in size. in fast mode, processing times ranged from 11 min to nearly 5 h. acute serum sample from 20-yr-old female patient presenting with 3 d of fever to 101.5\u00b0C, myalgias, and headache. within 48-h sample-to-answer turnaround time and 13 min SURPI analysis time, sequences spanning the genome of human herpesvirus 7 (HHV-7) were detected. SURPI is the only pipeline for pathogen identification to be extensively tested across multiple clinical sample types representing a variety of infectious diseases. the pipeline is available via direct download or as a self-deployable cloud computing instance. SURPI accurately detected viral pathogens of realized or potential outbreak importance in clinical NGS data sets. there is an urgent need for the implementation of rapid, highly multiplexed assays for infectious disease diagnosis in the microbiology laboratory. SNAP is a new, hash-based nucleotide aligner developed for mapping of NGS data to reference genomes across a wide range of read lengths (50\u201310,000 bp) the aligner partially derives its speed from loading the entire indexed reference database into RAM. ROC curve analysis was used to compare RAPSearch and BLASTx performance when mapping translated nucleotide reads to the viral protein DB. details on the construction of the in silico query nucleotide data sets and range of parameters used for the ROC curve analysis are provided in the Supplemental Methods. BLASTn alignment against the target viral genome at an E-value cutoff of 108. the gold standard criterion for a correct viral classification was BLASTn alignment against the target viral genome at an E-value cutoff of 108. duplicates at the level of cropped reads are first removed using GenomeTools (gt) SEQUNIQ. the corresponding full-length reads are then de-multiplexed by barcode and analyzed using the Message Passing Interface (MPI)-based parallel version of the AbySS de novo assembler. a coverage map of the reference sequence with the highest percent coverage is generated, with priority given to reference sequences in the following order: (1) complete genomes; (2) complete sequences; or (3) partial sequences/individual genes. the output of the SURPI pipeline includes a list of classified reads annotated with their taxonomic assignment. the specific hardware used here for SURPI testing and benchmarking are provided in the Supplemental Methods. SNAP is a new, hash-based nucleotide aligner developed for mapping of NGS data to reference genomes across a wide range of read lengths. ROC curve analysis was used to evaluate the ability of the various nucleotide aligners to correctly classify a given set of in silico reads when mapped against the human DB, bacterial DB, or viral nucleotide DB. the gold standard criterion used for a correctly classified read to any given database was that the in silico read had originated from that database. seven million unique preprocessed reads were selected from each data set. human and bacterial reads were removed prior to ROC curve analysis. the gold standard criterion for a correct viral classification was BLASTn alignment against the target viral genome. matched reads are taxonomically classified by lookup of matched GI/accession numbers from the NCBI taxonomy database. the taxonomic classification is then appended to the SAM file outputted by SNAP. a user-defined option also allows for a protein homology search against the NCBI nr DB. for each discrete viral or bacterial genus, assigned NGS reads are directly mapped to all nucleotide reference sequences corresponding to that genus. SNAP alignment to the complete NCBI nt DB (comprehensive mode); (6) de novo contig assembly (comprehensive mode); (7) RAPSearch viral protein homology search using translated nucleotide queries. data access The genome sequence of the human parechovirus 1 strain described in this study has been deposited in GenBank as HPeV-1 isolate MX1 (KJ152442)."}