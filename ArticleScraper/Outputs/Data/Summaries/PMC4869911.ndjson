{"summary": "proteins with a specialized role in antiviral defense have been shown to have exceptionally high rates of adaptation. PKR is one of the fastest adaptively evolving proteins in mammals. PKR recognizes viral double-stranded RNA upon infection, halts translation, and blocks viral replication. VIPs tend to interact with proteins that are functionally important hubs in the protein-protein interaction network of the host. TFRC is responsible for iron uptake in many different cell types and is used as a cell surface receptor by diverse viruses in rodents and carnivores. VIPs experience much stronger evolutionary constraint than other proteins. this excess of adaptation is visible in VIPs across biological functions, on multiple time scales, in multiple taxa, and across multiple studied viruses. we curated a set of 1256 VIPs from low-throughput virology literature. iency Virus type 1 (HIV-1) is the best-represented virus with 240 VIPs. nine other viruses (HPV, HCV, EBV, HBV, HSV, Influenza Virus, ADV, HTLV and KSHV) have at least 50 VIPs. most - more than 80% - of the VIPs have known antiviral activity. we use the ratio of nonsynonymous to synonymous polymorphisms (abbreviated as pN/pS) within humans and great apes as a measure of purifying selection. on average, the VIPs have 15% lower mammal-wide dN/dS ratio compared to non-VIPs. the 1000 Genomes Project and the Great Apes Genome Project are complementary for this analysis. on the one hand, the 1000 Genomes Project provides high quality variants with frequencies estimated from a large number of individuals. on the other hand, the Great Ape Genome project includes fewer individuals and provides coarser frequency data. the blue curve is the density curve of pN/(pS+1) for 1256 VIPs. we use pN/(pS+1) instead of pS to account for those coding sequences where pS=0. average pN/pS in VIPs (blue dot) versus average pN/pS in non-VIPs. the number pN for non-VIPs is rescaled to the actual number pN multiplied by the number of VIPs divided by the number of non-VIPs. the x-axis gives the upper threshold for each bin. for example for the second bin, the upper frequency threshold is 0.002 and the lower frequency is 0.001. VIPs are expressed in more tissues than non-VIPs at the RNA level. the difference in pN/pS is strongly affected when comparing VIPs and non-VIPs with a similar number of protein-protein interactions. the difference in purifying selection is driven at least partly by the fact that VIPs tend to be hubs with many interacting partners in the human protein-protein interactions network. in great apes, GO-matched non-VIPs still have a much higher pN/pS ratio compared to VIPs from the same GO category. even immune VIPs (Supplementary file 1D) have a significantly reduced pN/pS ratio compared to immune non-VIPs. the reduction in pN/pS in non-immune VIPs is very similar to the reduction observed in the entire set of VIPs. the difference in is robust to recombination ( =0.025 in non-VIPs with similar recombination to VIPs versus 0.02 without control) it is also robust to coding sequence GC content (=0.019 with versus 0.02 without control), coding sequence length (=0.023 with versus 0.02 without control) the higher rate of adaptation in VIPs is not explained by higher rates of adaptation in the host GO processes where VIPs are well represented. the difference in between VIPs and non-VIPs remains highly significant (permutation test P10-3 in all cases) the 80% of VIPs with no known antiviral or broader immune function (Supplementary file 1D) have a strongly increased rate of adaptation according to the classic MK test. immune VIPs, including antiviral VIPs, do not show any increase of adaptation compared to immune non-VIPs. the asymptotic MK test is robust to demographic events such as bottlenecks or population expansions. both VIPs and non-VIPs in our dataset are limited to proteins conserved across all mammals. to test this hypothesis we use the Branch-Site Random Effect Likelihood test (BS-REL test) and the BUSTED test (Murrell et al., 2015) to detect episodes of adaptive evolution in each of the 44 branches of the mammalian tree used for the analysis. the statistical power of BUSTED and the BS-REL test has been shown to depend strongly on the amount of constraint in a coding sequence. higher constraint/purifying selection decreasing the ability to detect adaptation. we also use a permutation test with a target average (Materials and methods) that matches VIPs and non-VIPs with similar pN/pS ratios. the excess of adaptation in mammals is robust to the potential confounding factors of expression at the RNA and protein levels. adaptation in mammals remains at least twice more frequent in VIPs compared to non-VIPs expressed at the RNA level in many tissues. excess is shown for BUSTED p0.5. proportions of selected codons in VIPs (blue dot) and non-VIPs (red dot and 95% confidence interval) in mammalian clades. each fixed number of sampled non-VIPs, we authorize one non-VIP to drive the cumulated average outside of the target interval (red dots on the scheme) if the cumulated average is driven outside of the target interval, we sample as many non-VIPs as necessary that decrease or increase the cumulated average back to the target interval. the excess of adaptation could be due to more genes with evidence of adaptation, more branches per gene with adaptation, and/or a greater proportion of selected codon 109 VIPs of HCV are the only ones where we do not detect any excess of adaptation along the mammalian tree. GO-analysis of adaptation in mammals VIPs are represented in a wide range of GO functions. of these 162 GO categories, 118 (73%) have a 50% or greater excess of adaptation in VIPs. phylogenetically widespread excess of recurrent adaptation suggests many of the VIPs annotated in humans were also VIPs for a substantial evolutionary time in a wide range of mammals. all mammalian clades in the tree show a similar excess of adaptation in VIPs. proteins are ordered according to the number of branches with signals of adaptation. the most positively selected non-antiviral VIP that fulfills all these requirements is aminopeptidase N, abbreviated ANPEP, APN or CD13. 76 out of 165 branches in the tree showing signals of adaptation. adaptation of ANPEP has previously been detected in the context of oxidative stress in Cetaceans. it is used by group I coronaviruses as a receptor. adaptation excess (y axis) is defined as the number of observed codons with a MEME P-value lower than the P-value threshold on the x axis. stars give the significance of the excess. meME detects significant adaptation (MEME p0.05) in 85 of the 931 aligned codons. several of these adaptively evolving codons are within, or right next to the surface of contact with TGEV and PRCV. this enrichment fades very rapidly as one gets further from the surface of contact. identification of VIPs We curated a set of 1256 VIPs from the low-throughput virology literature. VIPs were defined as proteins that interact physically with viral proteins, viral RNA, and/or viral DNA. most of the VIPs correspond to an interaction between a protein and a virus infecting humans. identified 1256 VIPs are involved in diverse cellular and supracellular processes. 162 overlapping GO cellular and supracellular processes have more than 50 VIPs. only 57 VIPs or 5% of VIPs have known antiviral activity. selection using the BS-REL (Kosakovsky Pond et al., 2011) and BUSTED (Murrell et al., 2015) tests from the HYPHY package (Pond et al., 2005) to assess the prevalence of positive selection in VIPs compared to non-VIPs in the human lineage and in mammals in general. on average, the VIPs have 15% lower mammal-wide dN/dS ratio compared average pN/pS is 21% lower in VIPs compared to non-VIPs. in great apes, the average pN/pS ratio is 25% lower in VIPs compared to non-VIPs. pN and pS are measured using great ape genomes. pN for non-VIPs is rescaled to the actual number pN multiplied by the number of VIPs divided by the number of non-VIPs. pN for non-VIPs is rescaled to the actual number pN multiplied by the number of non-VIPs. the difference in pN/pS between VIPs and non-VIPs persists when comparing VIPs with non-VIPs with similar GC content (0.526 versus 0.655, P=0 after 109 iterations), similar coding sequence length (0.526 versus 0.654, P=0), or similar recombination rates (0.526 versus 0.702, P=0) VIPs have many more protein-protein interaction partners than non-VIPs. the difference in pN/pS is strongly affected when comparing VIPs and non-VIPs with a similar number of protein-protein interactions. the difference in purifying selection is driven at least partly by the fact that VIPs participate in the more constrained host functions. in great apes, GO-matched non-VIPs still have a much higher pN/pS ratio. this is only slightly lower than the average ratio in non-VIPs in general. even immune VIPs (Supplementary file 1D) have a significantly reduced pN/pS ratio compared to immune non-VIPs. we estimate the proportion of adaptive non-synonymous substitutions in VIPs and non-VIPs in the human lineage. the classic MK test is known to underestimate the true in the presence of slightly deleterious polymorphisms. sequence GC content (=0.019 with versus 0.02 without control), coding sequence length (=0.023 with versus 0.02 without control) the difference is robust to variation in levels of expression at the RNA level measured as the number of tissues with GTEx V4 RNA-seq expression RPKM10 (=0.001 with versus 0.02 without control) the difference in is not affected either by purifying selection. 80% of VIPs with no known antiviral or broader immune function have a strongly increased rate of adaptation according to the classic MK test. 80% of VIPs with no known antiviral or broader immune function have a strongly increased rate of adaptation. the asymptotic MK test is known to be biased downward by the presence of slightly deleterious non-synonymous variants. the classic MK test is known to be biased by the presence of slightly deleterious non-synonymous variants. the asymptotic MK test estimate of in VIPs is 27% (512 out of 1897 amino acid changes) compared to 9% (1293 out of 14,370 amino acid changes) in non-VIPs. both VIPs and non-VIPs are limited to proteins conserved across all mammals. the difference in is robust to recombination ( =0.025 in non-VIPs with similar recombination to VIPs versus 0.02 without control) it is also robust to coding sequence GC content (=0.019 with versus 0.02 without control), coding sequence length (=0.023 with versus 0.02 without control) the higher rate of adaptation in VIPs is not explained by higher rates of adaptation in the host GO processes where VIPs are well represented. the difference in between VIPs and non-VIPs remains highly significant (permutation test P10-3 in all cases) 80% of VIPs with no known antiviral or broader immune function (Supplementary file 1D) have a strongly increased rate of adaptation according to the classic MK test. unlike for non-immune VIPs, immune VIPs, including antiviral VIPs, do not show any increase of adaptation compared to immune non-VIPs. the asymptotic MK test is robust to demographic events such as bottlenecks or population expansions. both VIPs and non-VIPs in our dataset are limited to proteins conserved across all mammals. to test this hypothesis we use the Branch-Site Random Effect Likelihood test (BS-REL test) and the BUSTED test (Murrell et al., 2015) to detect episodes of adaptive evolution in each of the 44 branches of the mammalian tree used for the analysis. the statistical power of BUSTED and the BS-REL test has been shown to depend strongly on the amount of constraint in a coding sequence, with higher constraint/purifying selection decreasing the ability to detect adaptation. we therefore use a permutation test with a target average (Materials and methods) that matches VIPs and non-VIPs with similar pN/pS ratios. excess of adaptation in mammals is robust to potential confounding factors of expression at the RNA and protein levels. adaptation in mammals remains at least twice more frequent in VIPs compared to non-VIPs expressed at the RNA level in many tissues. excess is shown for BUSTED p0.5. Proportions of selected codons in VIPs (blue dot) and non-VIPs. each fixed number of sampled non-VIPs, we authorize one non-VIP to drive the cumulated average outside of the target interval (red dots on the scheme) we sample as many non-VIPs as necessary that decrease or increase the cumulated average back to the target interval based on whether the cumulated average is above or below the target interval (grey dots). the excess of adaptation could be due to more genes with evidence of adaptation, more branches per gene with adaptation, and/or a greater proportion 109 VIPs of HCV are the only ones where we do not detect any excess of adaptation along the mammalian tree. GO-analysis of adaptation in mammals VIPs are represented in a wide range of GO functions. of these 162 GO categories, 118 (73%) have a 50% or greater excess of adaptation in VIPs. mammals is due to higher rates of adaptation exclusively in the primate branches of the mammalian tree. however, all mammalian clades in the tree show a similar excess of adaptation in VIPs. this is most likely due to a lower statistical power of the BS-REL test in the short primate branches. we have shown that rates of adaptation are globally elevated in VIPs in humans and mammals in general. this suggests the existence of tens of thousands of isolated events of adaptation to a diverse range of viruses. to identify a non-antiviral VIP for in-depth investigation we first excluded all VIPs with a well-known antiviral activity. adaptation of ANPEP has previously been detected in the context of oxidative stress in Cetaceans. it is used by group I coronaviruses as a receptor, including the human Coronavirus 229E (HCoV-229E), Transmissible Gastroenteritis Virus (TGEV) and Feline Coronavirus (FCoV). gene glycosylation site in human ANPEP natively lacks it transforms it into a receptor for TGEV and PRCV. Legend is on the figure. meME detects significant adaptation (MEME p0.05) in 85 of the 931 aligned codons. codons in contact with TGEV and PRCV are strongly enriched in adaptation compared to ANPEP codons as a whole. this enrichment fades very rapidly as one gets further from the surface of contact with TGEV and PRCV. adaptive losses were due to selective pressure exerted by coronaviruses. viruses appear to drive 30% of all adaptive amino acid changes in the conserved part of the human proteome. however, the footprints of the arms race with viruses are visible in a large number of VIPs. not all of the 1256 VIPs we use here have been consistently interacting with viruses during evolution. most VIPs in the dataset (95%) were discovered in humans. some VIPs have been in contact with viruses for a very limited evolutionary time in mammals, and only in a limited range of lines. viruses exerted a very powerful selective pressure across the breadth of the mammalian proteome. we identified 1256 proteins that physically interact with viruses out of a total of 9,861 proteins with orthologs in the genomes of 24 mammals included in the analysis. we could identify 982 proteins with at least one known interaction with a viral protein, RNA or DNA. in total, 1256 of the 9861 orthologous proteins were found to interact with viral proteins, RNA or DNA according to low throughput methods. 9338 human CDS were found to have clear conserved synteny in at least 18 of the 23 non-human species. 9338 human CDS were found to have clear conserved synteny in at least 18 of the 23 non-human species. 9338 human CDS were found to have clear conserved synteny in at least 18 of the 23 non-human species. annotation of antiviral and immune mammalian orthologs We consider proteins as antiviral if they restrict viral replication in any way, for example by directly engaging viruses for recognition and/or degradation of viral molecules. we also annotated VIPs with immune functions while identifying VIPs. DN and DS are the number of substitutions in the human lineage since divergence with a closely related species. these substitutions are identified in human-chimpanzee-orangutan alignments of the mammalian orthologous CDS (Supplementary file 1E) these alignments are prepared the same way as the alignments of 24 mammals. asymptotic MK test works by estimating in bins of derived allele frequencies. can be calculated by counting only variants with a derived allele frequency between 0.1 and 0.2 to measure pN and pS. an exponential curve is then fitted to the estimates of across bins of frequency. a second potential issue when trying to fit a curve to predict in the asymptotic McDonald-Kreitman test is the mispolarization of alleles as ancestral or derived. the most severe distortion is usually within the high frequency part of the SFS. the number of non-synonymous variants pN might be more severely overestimated than pS. forward population simulations using SLIM simulate a typical, 400 codons, six exons coding sequence. each exon is separated by 4000 bp long introns. non-synonymous sites experience neutral, advantageous, strongly deleterious and slightly deleterious mutations. the logarithmic fit is easier to use than the exponential fit. we use the multiple alignments of the coding sequences from the 24 mammals listed above to quantify adaptation across mammals. there are three different types of tests aimed at detecting and quantifying adaptation in a multi-species coding sequence alignment: branch tests, site tests, and branch\u2013site tests. branch-site tests are designed to detect adaptation at specific codons in specific branches. the HYPHY branch-site test and the HYPHY BS-REL branch-site test differ mainly in the assumptions of their evolutionary models. the test uses a model that has no limitation regarding the occurrence of adaptation across the tree. HYPHY BS-REL uses the same codon evolution model as the BS-REL test. we compare VIPs and non-VIPs for weak (BUSTED P-values 0.9) to increasingly strong (BUSTED P-values 10\u20135) evidence of adaptation. we compute the average proportion of selected codons only from these 40 branches. we only include in the quantification the average proportions of selected codons from coding sequences with BUSTED P-value10x. for a low x, we compare how much strong, highly significant signals of adaptation occurred in VIPs compared to non-VIPs. permutation test makes it possible to compare adaptation in VIPs with adaptation in non-VIPs with the same amount of purifying selection. more adaptation would increase dN/dS in VIPs more than it does in non-VIPs. in all three cases, non-VIPs selected as controls would experience more adaptation than non-VIPs that would have been matched based on a more accurate measure of purifying selection. this ultimately results in underestimating any excess of adaptation in VIPs compared to non-VIPs. the pN/pS ratio is publicly available, based on the genome sequences of a sufficient number of individuals within a given species. the limited number of species of the mammalian tree with pN/pS information can still be used as a control of purifying selection in the permutation test. pN/pS ratio from primate species can therefore be used as a control for purifying selection. pN/pS ratio from populations of chimpanzees (Nigeria-Cameroon, Eastern and Central populations), gorillas (Western lowland population) and orangutans (Sumatran and Bornean populations) is less noisy and available for more proteins in populations with higher population sizes and higher genetic diversity. one can consider the case of VIPs where pN/pS is substantially lower than in non-VIPs. we would end up selecting non-VIPs with a lower pN/pS because of purifying selection. instead we use an indirect matching strategy. non-VIPs with the same pN/pS (purifying selection) as VIPs have a lower dN/dS. this means that non-VIPs with the same pN/pS have a lower dN/dS. the random sets of non-VIPs must fulfill two criteria to be comparable to VIPs. the target dN for non-VIPs can therefore take values between dN(inf) and dN(sup), where dN(inf) = 0.95(adN(vip)) and dN(sup = 1.05(adN(vip)) the fraction a is set manually through trial and error so that the sampled non-VIPs have the same average pN/pS. sampled non-VIPs can fall out of [dN(inf),dN(sup)] if the average dN is below dN(inf), we sample as many non-VIPs as necessary that each lower the average dN until it falls back within [dN(inf),dN(sup)]. to define the fraction a and X, we get 104 random samples of non-VIPs. non-VIPs compared to non-VIPs (0.81 in non-VIPs compared to 0.76 in VIPs, P=0.04) the combination of a and X gives the closest matching variances and a slightly higher pN/pS in non-VIPs than in VIPs. other combinations give closer averages of pN/pS, but more distant variances. there are 162 GO processes with 50 or more VIPs. the matching procedure is conducted using only these 162 processes. each VIP always has more than 5 non-VIPs to choose from. the last update was performed by automatically querying PUBMED again on the 10th of December 2014. titles of publications directly mentioning an interaction were retained for further inspection of their abstracts. those 24 mammals were those with high sequencing depth genomes as of December 2012. they include the assemblies hg19 for human, chimpanzee panTro4, gorilla gorGor3, orangutan ponAbe2, gibbon nomLeu3, macaque rheMac3, bushbaby otoGar3, mouse mm10, rat rn5, guinea pig cavPor3, squirrel speTri2, rabbit oryCun2, sheep oviAr the CDS of these 9338 orthologs were aligned using PRANK. any codon present in less than eight species was discarded. the first step of local alignment with Blat excludes segments of the CDS that are too diverged between mammals to be properly aligned. DN and DS are the number of fixed amino acid substitutions in the human lineage since divergence with a closely related species. these substitutions are identified in human-chimpanzee-orangutan alignments of the mammalian orthologous CDS (Supplementary file 1E) the classic MK test has been shown to underestimate even when excluding low frequency variants. it is therefore well suited to measure the relative difference in adaptation between VIPs and non-VIPs. but it is not well suited to actually measure the true absolute in VIPs and non-VIPs. the low number of high frequency variants means that estimates of in the high frequency bins are very noisy. a second potential issue when trying to fit a curve to predict in the asymptotic McDonald-Kreitman test is the mispolarization of alleles as ancestral or derived. a logarithmic fit of the form y = a + b ( ln ( x + c ) or an exponential fit of the form y = a + b exp ( x / c ) provides accurate estimates of for a wide range of evolutionary scenarios. one in four coding sites experiences neutral mutations. the modified asymptotic MK test gives accurate estimates of for all evolutionary scenarios tested (Supplementary file 1G) the logarithmic fit is easier to use than the exponential fit. codons with dN/dS >> 1 are codons that have accumulated many adaptive non-synonymous substitutions across the tested phylogeny. site tests ignore the case where specific codons have evolved adaptively on a specific branch, probably the most common case in coding sequence evolution. instead we use branch-site tests which are designed to detect adaptation at specific codons. the HYPHY BS-REL test detects significant (BS-REL test p0.05) signals of adaptation in 18 branches of the mammalian tree used in this study for PKR. in comparison, the PAML test detects only nine branches (PAML test p0.05) the 44 branches of the tree have conserved synteny. we compute the average proportion of selected codons only from these 40 branches. adaptation is quantified as the average proportions of selected codons in valid branches across VIPs. dN/dS is often used as a measure of purifying selection. comparing VIPs with non-VIPs with similar dN/dS ratios would underestimate an excess of adaptation in VIPs. this is because more adaptation would increase dN/dS in VIPs more than it does in non-VIPs. pN/pS is decreased by purifying selection, but is not affected by adaptive mutations that segregate for very short times in populations. proteome-wide estimates of pN/pS are not available for all the mammals included in this analysis. matched non-VIPs with similar pN/pS experience similar purifying selection. the relative difference in pN/pS is still a good measure of the general difference in purifying selection across mammals. pN/pS ratio from primate species can therefore be used as a control for purifying selection. pN/pS is noisy measure of purifying selection. a weakly constrained coding sequence may by chance have less non-synonymous variants, and a low pN/pS ratio. this is problematic if we want to use pN/pS as a control for purifying selection. dN/dS is influenced by both purifying selection and by adaptation. if VIPs experience more adaptation than non-VIPs then purifying selection being equal, we expect dN/dS to be lower in VIPs than in non-VIPs. non-VIPs should have the same overall average pN/pS as VIPs. non-VIPs should have the same variance in pN/pS, i.e. pN/pS values in non-VIPs are spread as much as they are in VIPs. permutations with a target average work as follows for the case of purifying selection. the average of all the sampled non-VIPs has to remain within [dN(inf),dN(sup)] except for every X non-VIP that is sampled completely randomly. if the average dN is above dN(inf), we sample non-VIPs that each increase the average dN until it falls back within [dN(inf),dN(sup)]. a=0.7 and X=3 give samples of non-VIPs with slightly higher average pN/pS than VIPs\u2019 pN/pS (0.56 in non-VIPs versus 0.526 in VIPs, P=0.03) and a very similar variance (0.53 in non-VIPs vs 0.552 in VIPs, P=0.35) pN/pS ratio in human african populations is also slightly higher in non-VIPs compared to there are 162 GO processes with 50 or more VIPs. the matching procedure is conducted using only these 162 processes. for each VIP, we find all the non-VIPs that have at least 60% of GO processes in common. author contributions DE, Conceived and designed the experiments, Performed the experiments, Interpreted the results, Wrote the paper, Acquisition of data. LC, Performed the experiments, Acquisition of data, Analysis and interpretation of data. CG, Performed the experiments, Acquisition of data, Analysis and interpretation of data. CG, Performed the experiments, Acquisition of data, Analysis and interpretation of data. the table provides all the 9,861 orthologs with best reciprocal hits (Material and methods) the first column is Ensembl Gene ID, the second column is BUSTED P-value, and the other columns are BS-REL estimated proportions of selected codons in all the 44 branches tested. Enard D, Cai L, Gwennap C, Petrov DA,2015,Data from: Viruses are a dominant driver of protein adaptation in mammals."}