{"summary": "recombination can reshuffle single mutations that originally occurred on different, but homologous, viral genomes. non-homologous recombination has the potential to mutate large swathes of the viral genome by deleting large portions to form \u2018defective genomes\u2019. ViReMa is compatible across a number of sequencing platforms that produce either long (e.g. 454 technologies) or short (e.g. Illumina) reads. multiple recombination events within a single read are detected, as are virus-to-host recombination and insertion and substitution events. an additional 2-h nuclease digestion was performed with 20 U DNase I and 0.5 ug RNase A in between the two sucrose gradient spins to remove any contaminating non-encapsidated RNA or DNA. ethanol precipitated and re-suspended in pure water. 400 ng RNA was used for cDNA library generation using standard TruSeq adaptors and barcodes. RESULTS ViReMa is a Python script that iteratively calls the small read alignment program, Bowtie (23), to try and map all portions of a candidate read. the process is similar to other recombination or fusion detection algorithms such as Tophat and Tophat-Fusion (24,25), FusionMap (26) or MapSplice (27) that split up a read into segments of a specific length, which are then mapped independently. if a mapping is found, ViReMa generates a new read segment from any unaligned nucleotides. if there are sufficient nucleotides present in the new segment, it is written into a new data file and again mapped by Bowtie. this continues iteratively until all portions of the read are either mapped or trimmed or a combination of both. a seed, typically comprising 20\u201330 nt, is extracted from the beginning of a sequence read and aligned to a reference genome using a Burrows\u2013Wheeler indexing technique. if multiple mapping locations are found in the reference genome, Bowtie (in \u2018best\u2019 mode) reports the mapping that raises the fewest mismatches in and after the seed. the first 45 aligned nucleotides correspond to the 5\u2032 region of a putative recombination junction up until the recombination breakpoint. the remaining nucleotides in the read after a detected breakpoint can then be extracted from the sequence alignment map file. a new segment will be generated from the remaining nucleotides beginning with the first disqualifying mismatch. if a successful alignment is not found during the mapping of a segment, then the first nucleotide is trimmed and a new segment is formed from the remaining nucleotides. this trimming process is crucial to remove short pads or adaptor sequences from the beginning of a sequence read that might prevent a seed from being mapped. this enables ViReMa to read through insertion events or regions of extensive mismatching. this code aids the second phase of the algorithm that analyzes the mapping results for each read. examples of the types of output generated by the first phase of ViReMa are given in Table 1. a read that is 76 nt in length has been broken into two segments. the first segment of 33 nt has been mapped to FHV RNA 1, nt 113\u2013145. the remaining 43 nt have mapped to FHV RNA 1, nt 1003\u20131045. the exact site of recombination is sometimes ambiguous due to the inherent \u2018fuzziness\u2019 of recombination junctions. this occurs when the nucleotides immediately upstream of the donor site are identical to the nucleotides immediately upstream of the donor site. in ViReMa, such \u2018fuzzy\u2019 junctions can be reported either at the 5\u2032 end, the middle or at the 3\u2032 end of the fuzzy nucleotides present in the reference sequence. the two flanking aligned segments provide a small window in which to search for a new alignment. if a single perfect match is found, then ViReMa will report two separate recombination events as opposed to one 'unknown' recombination. for each 189-nt fragment, this was repeated a random number of up to 100 times. seed of 20 nt, recombination events occurring in the first or last 19 cutting sites of the reads will not be detected leaving 56 possible sites. a theoretical maximum efficiency of recombination detection would be 56/94 = 59.6%. we detected 2 973 603 recombination events. error rate plateaus with an \u2018\u2013X\u2019 value of 5 nt for \u2013N = 1 and an \u2018\u2013X\u2019 value of 6 nt for \u2013N = 2. sensitivity decreases linearly with increasing mapping stringency. error rate decreases dramatically with increased mapping stringency. recombination events within the viral genome with a frequency approaching that of mismatch mutation (10) in total, we detected 1 346 768 recombination events using the pseudo-libraries with end-to-end mapping (Table 2). nt 41 565 66 731 63 857 FHV RNA2-RNA2 26 958 26 449 29 702 -MicroInDels 5 nt 6939 6659 7874 FHV RNA1-RNA2 11 068 10 545 13 274 FHV RNA2-RNA1 22 288 23 357 24 573 Other recombination events (see Table3) 160 090 18 111 20 149 Unmapped reads 1 recombination events were detected using ViReMa Mapping result. sensitivity improved by analyzing the raw dataset that contained 31.1 million reads ranging from 50 to 100 nt in length. the study of defective genomes has been highly important in establishing the regions of viral genomes required for replication and encapsidation. defective genomes that maintain sequence information required for replication or encapsidation gain a strong selective advantage over those that cannot and so will be successfully propagated. a short motif is present in RNA 2 at nt 186\u2013217 that forms a bulged stem loop and acts as a signal for RNA 2 packaging into virions. the internal regions at nt 538\u2013616 in RNA 2 and at nt 68\u2013205, nt 1227\u20131243 and nt 2322\u20133011 in RNA 1 have previously been demonstrated to contain sequence motifs that are required for replication. nt 186\u2013217 in RNA 2 form a 5\u2032 Stem-Loop (5\u2032 SL) required for RNA 2 encapsidation. an intRE at nt 536\u2013616 is required for RNA 2 replication. a seed, typically comprising 20\u201330 nt, is extracted from the beginning of a sequence read. first 45 aligned nucleotides correspond to the 5\u2032 region of a putative recombination junction up until the recombination breakpoint. the remaining nucleotides in the read after a detected breakpoint can then be extracted from the sequence alignment map file. a new segment will be generated from the remaining nucleotides beginning with the first disqualifying mismatch. ViReMa will first attempt to align the seed to the virus genome. if a mapping cannot be found, ViReMa will then attempt to map the read to the host genome. this will give preference to a mapping found in the host or viral genome. 'M' corresponds to mapped nucleotides; \u2018X\u2019 denotes mismatches within mapped segments; and \u2018U\u2019 denotes unmapped nucleotides that were either trimmed or could not form a new segment as required by the seed length. this code aids the second phase of the algorithm that analyses the mapping results for each read and identifies what types of events have occurred. recombination has taken place, but unidentified nucleotides are present that are smaller than the chosen seed (e.g. 25 nt) this may be the result of two recombination events having occurred within proximity, which can be tested using the optional command: \u2018\u2013Compound_Handling\u2019. the exact site of recombination is sometimes ambiguous due to the inherent \u2018fuzziness\u2019 of recombination junctions. such \u2018fuzzy\u2019 junctions can be reported either at the 5\u2032 end, the middle or at the 3\u2032 end of the fuzzy nucleotides present in the reference sequence. if both host and virus reference genomes are used, there will be one of each file for both reference genomes, plus an extra file for virus-to-host recombinations the \u2018\u2013Compound_Handling\u2019 option can be used to align these short fragments back to the virus genome. the two flanking aligned segments provide a small window in which to search for a new alignment. a reliable mapping for this fragment may therefore be found even if the fragment is smaller than the seed length. there are 94 possible \u2018cutting\u2019 sites in a 95-nt read at which a recombination may occur. a theoretical maximum efficiency of recombination detection would be 56/94 = 59.6%. we generated 5 043 791 synthetic reads containing 99 033 unique recombination events. junction detection is poor due to the first one or two nucleotides upstream of a recombination junction being counted as mismatches but in the downstream segment. error rate plateaus with an \u2018\u2013X\u2019 value of 5 nt for \u2013N = 1 and an \u2018\u2013X\u2019 value of 6 nt for \u2013N = 2 (Figure 3). sensitivity and error rate of ViReMa determined using simulated dataset. analysis of recombination events in RNA encapsidated by FHV. we collected 28 939 991 single reads that were quality filtered and all trimmed to exactly 95 nt. using an end-to-end alignment, we removed all reads that mapped to either the FHV or D. melanogaster genomes. the results for the pseudo-library-based mapping were performed in Routh et al. (10) and are compared against the number of recombination events found by ViReMa when using the same initial dataset containing only 95-nt long reads. the raw dataset containing 31 million reads was also mapped with ViReMa. a uses a stricter mapping procedure to determine which reads had been successfully mapped with the ViReMa algorithm. the majority of the extra events were detected in FHV RNA 1 which harbored the largest number of recombination events among the FHV genome. 1.1 million reads ranging from 50 to 100 nt in length. after this, 11 000 reads remained completely unmapped. de novo discovery of functional motifs in the genome of FHV FHV readily produces defective genomes. a short motif is present in RNA 2 at nt 186\u2013217 that forms a bulged stem loop. the internal regions at nt 538\u2013616 in RNA 2 and at nt 68\u2013205, nt 1227\u20131243 and nt 2322\u20133011 in RNA 1 have also previously been demonstrated to contain sequence motifs that are required for replication. cis-RE at nt 68\u2013205; the Proximal/Distal Subgenomic Control Elements at nt 1229\u20131239 and nt 2282\u20132777; an internal response element at nt 2322\u20132501; and a 3\u2032 RE at nt 2735\u20133011. all of these previously characterized elements are conserved in our analysis. over 31 million reads were detected, 180 075 recombination events could not be unambiguously identified and 11 000 reads could not be mapped. many recombination detection algorithms are focused on the detection of splice-junctions in eukaryotic mRNA or in the detection of chromosomal rearrangements or fusions. artifactual recombination can be detected by mixing separate samples before cDNA library generation. this can be achieved by comparing the recombination in the viral genome with non-viral templates such as transcribed RNA."}