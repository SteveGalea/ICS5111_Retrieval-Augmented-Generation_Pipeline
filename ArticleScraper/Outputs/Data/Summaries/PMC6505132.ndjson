{"summary": "genome data were obtained for a set of 72 CC strains available at the time of writing from http://csbio.unc.edu/CCstatus/index.py\"run=FounderProbs. of the 72 CC strains used in the simulations, 54 will be maintained and distributed by The UNC Systems Genetics Core. the genomes of the CC, as with other MPPs, can be represented by inferred mosaics of the original founder haplotypes (Mott et al. 2000) the genomes of the CC can be represented by inferred mosaics of the original founder haplotypes (Mott et al. 2000) phenotypes for CC strains were simulated based on effects from a single QTL, plus effects of polygenic background (\u201cstrain effects\u201d), and noise. in our simulation framework, we specified: 1) the QTL location, which was randomly sampled from the genome; 2) the sample size in terms of both strains and replicate; 3) how the eight possible haplotypes at that location are grouped into eight or fewer functional alleles. the allele effects were rescaled so that the QTL contributes a variance h QTL 2. by convention, these were specified as fractions summing to exactly 1. The allele dosage matrix X was generated by collapsing functionally equivalent haplotypes according to a specified allelic series. the allelic series was randomly sampled from all possible configurations of bi-alleles. each row is an allelic series, each column of the grid is a CC founder. the full space of series with two alleles is shown in Figure 9A. the QTL in the mapping population will deviate from h QTL 2 due to imbalance in both M and D. for a given h QTL 2, the allelic values will be constant across populations. haley-Knott (HK) regression is commonly used in MPP studies. HK regression on strain means (Valdar et al. 2006a; Zou et al. 2006a) using linear model y ( s ) = 1 + P A +, (3) where y ( s ) is the sth simulated n-vector of strain means, and is the n-vector of residual error on the means, distributed as N ( 0, I ( h the fit of Equation 3 was compared with that of an intercept-only null model via an F-test, and produced a p-value, reported as its negative base 10 logarithm, the logP. this procedure was performed for all loci across the genome, resulting in a genome scan for y. per genome scan and simulation s were then recorded using the R package evir. the upper = 0.05 quantile of this fitted GEV was then taken as the -level significance threshold, T a ( s ). a false positive was declared if one or more QTL were detected on chromosomes other than the chromosome harboring the simulated QTL. a simulated mapping experiment on strain means that assumes r replicates, strain effect h strain 2 and QTL effect size h QTL 2 is equivalent to a single-observation mapping experiment with no strain effect and QTL effect size h QTL 2 is equivalent to a single-observation mapping experiment. a mapping experiment on strain means with QTL effect size h QTL 2 = 0.3, h strain 2 = 0.4, 2 = 0.3, and r = 10 is equivalent to our simulation of a single-observation with no strain effect but QTL effect size h QTL 2 0.41 (Supplement) we conducted s = 1, 000 simulation trials per setting, providing estimates of power that are effectively averaged over the CC population. an assumption of equal relatedness among CC strains is commonplace. it is suggested by the exchangeable random funnel design used in the CC. this assumption simplifies QTL mapping analysis by obviating the need for an explicit modeling of genomic similarity. strain effects were generated according to an additive infinitesimal model. a false positive was declared if any QTL were detected based on the permutation-based significance threshold. a false positive was declared if any QTL were detected. SPARCC is available as an R package on GitHub at https://github.com/gkeele/sparcc. all analyses were conducted in the statistical programming language R. five simulated genome scans are generated by the code provided in a simple example using the R package SPARCC. red dashed lines represent 95% significance thresholds based on 100 permutation scans. red tick represents the simulated position for a QTL that was successfully detected. mosome were obtained for a set of 72 CC strains available at the time of writing from http://csbio.unc.edu/CCstatus/index.py\"run=FounderProbs. the genomes of the CC, as with other MPPs, can be represented by inferred mosaics of the original founder haplotypes. Founder haplotype mosaics were inferred previously by the UNC Systems Genetics Core (http://csbio.unc.edu/CCstatus/index.py\"run=FounderProbs) using the hidden Markov model of Fu et al. (2012) applied to genotype calls from megaMUGA. the HMM inference provides a vector of 36 probabilities for each CC strain for each of 77,551 loci across the genome. of the 72 CC strains used in the simulations, 54 will be maintained and distributed by the UNC Systems Genetics Core. a subset of the UNC 59 will eventually be maintained by The Jackson Laboratory, which will potentially maintain 11 of the 72 not among the UNC 59. the HMM inference provides a vector of 36 probabilities for each CC strain for each of 77,551 loci across the genome. adjacent genomic intervals were averaged if the maximum L2 norm between the probability vectors of all individuals is less than 10% of the maximum possible L2 norm. allele dosage matrix X was generated by collapsing functionally equivalent haplotypes according to a specified allelic series. X is an n m allele dosage matrix mapping individuals to strains. u is an n-vector of strain effects (representing polygenic background variation), and is an n-vector of strain effects. chromosome was treated identically to an autosome, most closely reflecting a study using female mice. X = D A M, (2) where A is an 36 8 additive model matrix that maps diplotype state to haplotype dosage (e.g., diplotype AA equals 2 doses of A) and M is an 8 m \u201cmerge matrix\u201d that encodes the allelic series, mapping the 8 haplotypes to m alleles. the proportion of variance explained by the QTL in the mapping population will deviate from h QTL 2 due to imbalance in both M and D. for a given QTL 2, the allelic values will adjust depending on which population they are in. the earlier power study of Valdar et al. (2006a) defined effect size in a manner comparable to Definition B. the previous subsections described simulation of a single phenotype conditional on a set of strains. the strain effects u and residual were rescaled to have population (rather than sample) variances h strain 2 and 2 respectively. the allele effects were rescaled so that the QTL contributes a variance h QTL 2. by convention, these were specified as fractions summing to exactly 1. the allelic series was randomly sampled from all possible configurations. in a smaller, more focused investigation of the effects of allele frequency imbalance, we sampled from all possible configurations of bi-alleles. the entire space of allelic series is not shown here. the proportion of variance explained by the QTL in the mapping population will deviate from h QTL 2 due to imbalance in both M and D. for a given h QTL 2, the allelic values will be constant across populations. QTL mapping was performed using a variant of Haley-Knott (HK) regression (Haley and Knott 1992; Martnez and Curnow 1992) that is commonly used in MPP studies (Mott et al. 2000; Liu et al. 2010; Fu et al. 2010; Fu et al. 2012; Gatti et al. 2012; Gatti et al. 2012; Zheng et al. 2015) the fit of Equation 3 was compared with that of an intercept-only null model via an F-test. it produced a p-value, reported as its negative base 10 logarithm, the logP. the CC panel is a balanced population with respect to founder genomic contributions. the maximum logPs per genome scan and simulation s were then recorded. the corresponding locus was considered to be a (positively) detected QTL. a false positive was declared if one or more QTL were detected on other chromosomes. power for a given simulation setting was then defined as the proportion of true positives. the maximum distance was necessarily 5Mb, and experimental settings would be expected to have fewer data points, yielding estimates that are unstable. we used HK regression on strain means via linear model y ( s ) = 1 + P A +. y ( s ) is the sth simulated n-vector of strain means, P is an n 36 matrix of inferred diplotype probabilities for the sampled CC genomes at the QTL. this assumption could lead to reduced power when there are fewer functional alleles. the fit of Equation 3 was compared with that of an intercept-only null model via an F-test, and produced a p-value, reported as its negative base 10 logarithm, the logP. the CC panel is a balanced population with respect to founder genomic contributions and, by design, has minimal population structure. for a given simulation, we declared a true positive if the detected QTL was within 5Mb of the true (simulated) QTL. the 5Mb window size was used to approximate a QTL support interval. a false positive was declared if one or more QTL were detected on chromosomes other than the chromosome harboring the simulated QTL. a simulated mapping experiment on strain means assumes r replicates, strain effect h strain 2 = 0 % with the understanding that results from these simulations provide information on other numbers of replicates and strain effect sizes implicitly. a mapping experiment on strain means assumes r replicates, strain effect h strain 2 = 0 %. CC strains and the position of the QTL were sampled for each simulation. we ran these settings for QTL effect sizes specified with respect to the observed mapping population (Definition DAMB). h QTL 2 = 0.3, h strain 2 = 0.4, 2 = 0.3, and r = 10, is equivalent to our simulation of a single-observation with no strain effect but QTL effect size h QTL 2 0.41. we conducted s = 1, 000 simulation trials per setting, providing estimates of power that are effectively averaged over the CC population. CC strains are equally related only in expectation. realized relatedness will depart from expectation due to chance at the point of mixing. we compared the eigenvalues of the realized genetic relationship matrix K. ll simulations were performed using either all 72 founder strains or 71 strains with the omission of CC059, one of the two highly-related cousin strains. a false positive was declared if any QTL were detected based on the permutation-based significance threshold. SPARCC is available as an R package on GitHub at https://github.com/gkeele/sparcc. specific arguments that control the phenotype simulations, the strains used, genomic position of simulated QTL, and allelic series, are listed. red dashed lines represent 95% significance thresholds based on 100 permutation scans. a blue tick represents the simulated position for a QTL that was detected. a red tick marks a QTL that was missed. the QTL is not mapped in the fourth simulation, ranked top to bottom. file S1 contains the founder haplotype mosaics required for the SPARCC package. Files S4, S5, and S6 can be used to perform the large-scale power analysis. results Power simulations were performed for varying numbers of strains, replicates, functional alleles, and for a ladder of QTL effect sizes. results were stratified by a number of replicates, background strain effect size, and the number of functional alleles. the vertical red dotted line marks 58 strains, which is currently the number of unrelated strains available from UNC. the columns correspond to two, three, and eight functional alleles. closed circles represent power estimates that were directly assessed. 0.4 0.182 0.118 0.035 0.038 0.056 0.298 0.335 0.383 0.711 0.717 0.792 0.45 0.214 0.141 0.048 0.063 0.078 0.456 0.467 0.539 0.858 0.857 0.905 0.5 0.250 0.167 0.098 0.102 0.114 0.620 0.630 0.712 0.964 0.924 0.964 0.55 0.289 0.196 0.156 0.180 0.208 0.789 assuming eight functional alleles, there is 96.4% power to detect a 50% QTL, 79.2% for a 40% QTL, 44.1% for a 30% QTL, and 12.4% for a 20% QTL. studies without replicates and with large numbers of strains were found to be well-powered to detect large effect QTL (>40%) power is based on a QTL effect size of 20%, no background strain effect, and two functional alleles. the gray diagonal lines represent fixed values of the number of CC strains. power is reduced as percentage of the sample that are replicates is increased. the simulations define QTL effect size based on Definition B with an eight allele QTL. cells are colored red to white with decreasing mean and blue to white with decreasing 95% quantile. the maximum possible location error was 5Mb due to the 10Mb window centered around the true QTL position used for detecting QTL. the inflation in FPR is greater for all 72 CC strains, which includes two closely related cousin strains (CC051 and CC059). the beavis effect is a form of selection bias and as such is expected to be most extreme when the selection involved is most severe. the beavis effect (inflation of QTL effect size estimates) is more pronounced with smaller simulated QTL effect sizes and reduced numbers of strains. black dots plot the ratio of the estimated effect size at a detected QTL peak to the effect size that was simulated at the true QTL locus. s effect will diminish to the extent that there is a significant background strain effect, following the general relationship of replicates to QTL effect size described in Equation 4. a fixed set of QTL allele effects is expected that power will always be greatest when allele frequencies are balanced. the horizontal red dotted line marks 80% power. the vertical black dashed line marks 58 strains. power remains constant across different allelic series and degrees of balance. the balance of the allelic series for a bi-allelic QTL and its effect on QTL mapping power is highly dependent on the allelic series. the 127 possible allelic series for a bi-allelic QTL, categorized by the balance in the distribution of alleles among the CC founder strains, and ordered with balanced allelic series at the top and imbalanced at the bottom. detecting a 20% effect-size QTL with a single replicate was near zero. using 50 strains, we determined the power to detect a 20% effect-size QTL with a single replicate was near zero. additional strains improved mapping power more than additional replicates. a cutout band is centered on 250 mice. power is lower at the top of the band when replicate mice are a relatively higher proportion of the total number of mice. location error is reported as stabilized estimates for different numbers of strains and QTL effect sizes, but averaged over all other conditions. possible location error was 5Mb due to the 10Mb window centered around the true QTL position used for detecting QTL. location error was improved by increasing the number of strains, increasing the QTL effect size, or both. as with power, location error was improved by increasing the number of strains. curves are based on 10,000 simulations for each setting of strain effect and strain sample, based on a single observation per strain. the inflation in FPR is greater for all 72 CC strains, including two closely related cousin strains (CC051 and CC059) black dots plot the ratio of the estimated effect size at a detected QTL peak to the effect size that was simulated at the true QTL locus. black diamonds represents the mean ratio for a category; horizontal red dashed line marks a ratio of 1, when QTL effect size estimates are unbiased (i.e., no Beavis effect). these results also imply that the Beavis effect would be reduced by use of replicates, at least to the extent that replicates boost effective QTL effect size QTL effect sizes are in reference to a population, though effect size in the specific mapping population will determine the mapping power. the mapping population (definition DAMB) and a population balanced in the functional alleles (definition B). a balanced population (Definition B) vs. the mapping population (Definition DAMB) is unimportant in terms of designing a robust mapping experiment in the CC. we performed additional simulations to evaluate bi-allelic QTL. power curves comparing three different sampling approaches for the allelic series with two functional alleles. the horizontal red dotted line marks 80% power, and the vertical black dashed line marks 58 strains. power is affected by factors such as the number of strains, the number of replicates, and the allelic series at the QTL. the relatively lower power with the realized data likely reflects both reduction in the number of strains by 28% (72 to 100) and the deviations from an ideally-randomized population. this emphasizes the challenge in projecting the results from Valdar et al. (2006a) into the realized population for the purpose of designing an experiment. Philip et al. (2011) mapped 17 QTL for 102 morphological and behavioral traits in 235 incipient CC strains, ranging from 5.3% (tail-clip latency) to 26% (red cell distribution width) Durrant et al. (2011) identified seven QTL for susceptibility to Aspergillus fumigatus infection in 371 mice from 66 strains. GWASs are observational, and as such include many additional sources of noise, reducing QTL effect sizes relative to what would be possible in more tightly-controlled experimental designs. experimental populations will also have larger QTL effect sizes because: 1) they typically have more balanced allele frequencies; 2) in the case of panels of RILs, such as the CC, they are homozygous across the genome. recombinant inbred lines such as the CC are uniquely able to combine such definitions with QTL mapping. strain-specific phenotypic variance ideally requires replicates. recombinant inbred lines such as the CC are uniquely able to combine such definitions with quantitative mapping. we simulated independent strain effects and used a fixed effect mapping procedure due to its computational efficiency. the results should be consistent with the use of a mixed effect model that correctly controls for correlated strain effects due to genetic relatedness. multi-allelic QTL (with more than two alleles) do occur. this has been seen in cis-regulation of gene expression that corresponds to the three subspecies lineages of Mus musculus. however, multi-allelic QTL will not be as powerfully detected through SNP association. the inclusion of genomes of extinct strains, or those that have drifted since the strains were genotyped, result in power calculations that do not perfectly correspond to the current CC population. they are preferable to simulated genomes, since they represent genomes that were viable at some point. QTL mapping experiments in the CC are well-powered for large-effect QTL, in the neighborhood of 20\u201340%, depending on the number of strains and replicates. comparisons of reported estimates of QTL effect size should be interpreted with caution because they vary across different traits and model systems. 478-739 eQTL (eQTL) were detected at genome-wide significance, ranging in effect size from 60\u201390%. results reiterate that QTL mapping studies in the CC are best suited for detection of large effect QTL, as are more common in molecular traits. recombinant inbred lines such as the CC are uniquely able to combine such definitions with QTL mapping. recombinant inbred lines such as the CC are uniquely able to combine such definitions with QTL mapping. recombinant inbred lines such as the CC are uniquely able to combine such definitions with QTL mapping. null simulations that assumed correlated strain effects due to genetic relatedness increased FPR for our mapping approach. this elevated FPR supports the use of QTL mapping approaches that account for the effect of genetic similarity on phenotypes. allelic series can strongly affect power through its influence on observed allele frequencies. imbalanced bi-allelic QTL have significantly reduced mapping power when the sole alternative allele is rarely observed. highly multi-allelic QTL are more easily detected because they will have multiple alleles observed within a given sample. RI panels such as the CC are an approximation to an ideal: they attempt to provide reproducible genomes that can be observed multiple times as well as across multiple studies. the inclusion of genomes of extinct strains, or those that have drifted since the strains were genotyped, result in power calculations that do not perfectly correspond to the current CC population. this discrepancy reflects the inherent challenge of maintaining a stable genetic population resource. a focused simulation approach incorporates realized CC genomes to provide more accurate estimates of QTL mapping power than were previously possible. the results of our simulations provide tailored power calculations to aide the design of future QTL mapping experiments in the CC. computational efficiency can be vastly increased by pre-computing and saving the QR decompositions for all X. if X j is the same across S simulations, the boost in computation can extend beyond permutations to samples of y ( s) CC strains were submitted in parallel to a distributed computing cluster. runtime varied depending on parameter settings and hardware used. longest jobs took approximately seven hours to complete. CC071, CC062, CC063, CC065, CC068, CC073, CC074, CC075, CC075, CC075, CC075, CC075, CC072, CC073, CC074, CC075, CC076. of the 72 CC strains used here, 54 are among a larger set of 59 that are currently maintained and distributed by UNC. Additive matrix A B C D E F G H A = AA BB CC DD EE FF GG HH AB AC AD AE AF AG AH BC BD BE BF BG BH CD CE CF CG CH DE DF DG DH EF EG EH FG FH GH [2 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 allelic series matrices We explore the influence of the allelic series on QTL mapping power via the simulation procedure. the allelic series can be sampled and encoded in the M.ID argument within the sim.CC.data() function of SPARCC. k o k 1 M = A B C D E F G H [ 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 additive matrix A B C D E F G H A = AA BB CC DD EE FF GG HH AB AC AD AE AF AG AH BC BD BE BF BG BH CD CE CF CG CH DE DF DG DH EF EG EH FG FH GH [ 2 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 allelic series matrices We explore the influence of the allelic series on QTL mapping power via the simulation procedure. the simulation procedure estimates separate parameters for each founder, though in reality there are likely fewer functional alleles. allelic series with eight alleles (maximum) M.ID = \u201c0,1,2,3,4,5,6,7\u201d k o k 1 k 2 k 3 k 4 k 5 k 6 k 7 M = I = A B C D E F G H [ 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 k o k 1 M = A B C D E F G H [ 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"}