{"summary": "the literature on molecular phylogenetics proposes a number of criteria for selecting a phylogeny from among plausible alternatives. such criteria can be expressed by means of objective functions, and the phylogenies that optimize them are referred to as optimal. finding the most parsimonious phylogeny for H involves solving an optimization problem. present the basic formulation and then introduce a series of provable valid constraints to reduce the solution space. we then prove that these constraints can lead to significant reductions in the gap between the optimal solution and its non-integral linear programming bound relative to the prior art. the work thus provides methodology suitable for provably optimal solution of some harder instances that resist all prior approaches. the criteria can usually be quantified and expressed in terms of objective functions, giving rise to families of optimization problems whose general paradigm can be stated as follows. problem 1 \u2013 The Phylogeny Estimation Problem (PEP) optimize f ( T ) s.t. g ( H, T ) = 1 T. a phylogeny of H is defined to be optimal under the parsimony criterion if it satisfies the following requirements. the first condition imposes the assumption that the smallest number of mutations consistent with the observed sequences is a good approximation to the true evolutionary process of the observed set of taxa. some variants of the MPPEP, see e.g., [15,16], can be solved in polynomial time. but in the most general case, the problem is N P -hard [11,17] and this fact has justified the development of a number of exact and approximate solution approaches, such as those described in [11,17,18] we present a formulation for the problem based on an adaptation of [23]\u2019s mixed integer formulation for the Steiner tree problem extended with a number of preprocessing techniques and reduction rules. we then show that it is possible to exploit the high symmetry inherent in most instances of the problem, through a series of strengthening valid inequalities, to eliminate redundant solutions. phylogeny of H is defined to be optimal under the parsimony criterion. it assumes that one taxon evolves from another by means of small changes. the most plausible phylogeny is that requiring the smallest number of changes. the first condition imposes the assumption that the smallest number of mutations consistent with the observed sequences is a good approximation to the true accumulated set of mutations. the second condition correlates the edge weights to the observed data. the assumption can be considered accurate in the limit of low mutation rates or short time scales. the literature describes some (rare) circumstances for which it is possible to solve the problem in polynomial time. in the general case the MPPEP-SNP is N P -hard and solving provably to optimality therefore generally requires the use of exact approaches based on implicit enumeration algorithms. the human genome is divided in 23 pairs of chromosomes, i.e., organized structures of DNA that contain many genes, regulatory elements and other nucleotide sequences. a nucleotide site of a specific chromosome region shows a variability within a population of individuals then it is called a single nucleotide polymorphism (SNP) hi and hj are adjacent if d h i h j = 1. phylogeny T of H is a spanning tree of G, i.e., an acyclic subgraph of G in which a pair of adjacent haplotypes h i, h j H is adjacent in T. the problem of finding a phylogeny of H that satisfies the parsimony criterion consists of solving the following optimization problem. problem 2 The most parsimonious phylogeny estimation problem from SNP haplotypes (MPPEP-SNP) the MPPEP-SNP can be seen as particular case of the Steiner tree problem in a graph, a notorious N P -hard combinatorial optimization problem. finding the optimal solutions to the MPPEP-SNP is fundamental to validating the parsimony criterion, i.e., to verify whether the results predicted by the criterion match the experimental ones. we can easily bound the cardinality of H \u2032 by means of the following approach. consider the complete graph = ( H, ), where = ( h i, h j ) and construct a minimum spanning tree T of. denote E ( T ) as the set of edges (hi,hj) of T. z ij s as a decision variable equal to 1 if the pair of distinct vertices i,jVis adjacent in the optimal solution to the MPPEP-SNP. yij as a decision variable equal to 1 if the pair of distinct vertices i,jVis adjacent in the optimal solution to the MPPEP-SNP and 0 otherwise. ij s = y ij i, j V : i j (1g) y ij u i i, j V : i j (1h) y ij u i i, j V : i j (1h) j V : i j y ij u i i i C u i 1 C V : C V H (1j) vertices ij V can be adjacent only if d h i h j = 1. constraints (1g)-(1h) impose that in the optimal solution to the problem variable yij may assume value 1 only if both vertices i and j are considered. constraints (1l) impose that the first n + LBvertices in V must be considered in the optimal solution to the problem. variables x i s and z ij s can be relaxed in Formulation 1c)-(1e) and convexity constraint (1f) suffice to guarantee integrality in any optimal solution to the problem. formulation 1 can be reduced in size by removing those variables that are redundant or whose value is known in the optimal solution to the problem. the input haplotype set H is characterized by equal alleles, i.e., by the existence of two alleles, say 1 and 2, such that h i ( 1 ) = h i ( 2 ), for all i S. if one removes one of the two alleles from S, say 2, and multiplies the 1 -th coordinate by 2 does not alter neither the structure nor the value of the optimal solution to the problem. u i s, i R (2b) s z ij s \u2032 + h i ( s ) x j s 1 s, i V H, j V H \u2032 (2d) s \u2032 s z ij s \u2032 x i s + x j s 1 s, i V H, j V H \u2032 : s \u2032 s in Formulation 2 variables x i s and z ij s cannot be relaxed anymore. a number of valid inequalities can be developed to strengthen Formulation 2. proof In a feasible solution to the problem variables ui, i V(Q n + UB), can assume only value 0 or 1. if ui = 0, constraint (3) reduces to ui + 1 0 which is trivially valid for Formulation 2. s s s 1 z ij s 1, s 2 : s 1 s 2, i, j V H \u2032 : i, j Z (5) x i s 2 + x j s 2 2 ( 1 z ij s 1 ) are valid for Formulation 2. z ij s 1 = 1 then constraint (5), (respectively constraint (6)) reduces to + x i s 2 x j s 2 0 (respectively x i s 2 + x j s 2 0 ). similar arguments can be used to prove the following proposition. a possible solution may consist of either a star centered in haplotype h3 = 10 or a star centered in haplotype h3 = 01. a possible solution to the instance may consist of either a star centered in haplotype h3 = 10 or a star centered in haplotype h3 = 01. the distinction between constraints (9) and (10) is necessary, as in principle vertices in R may not be needed in the optimal solution to the problem. the sum s z ij s, i, j V H \u2032, i,jZ, can assume only value 0 or 1. Proposition 7 Constraints s S z ik s + s S z kj s 1 i, j Q 3 (12) are valid for Formulation 2. Proof In a feasible solution the path between two distinct haplotypes h i, h j H cannot be shorter than the distance d h i h j. the path p between two distinct haplotypes h i, h j H cannot be shorter than the distance d h i h j. if the distance between hi and hj is greater or equal to d, at most |C| vertices can belong to p. two haplotypes h i, h j H, denote m as the set of alleles and hi(s), s S, as the s-th allele of haplotype h i H. d h i h j = s S h i h j = s h i h j | h i ( s ) h j as the distance between hi and hj. set H \u2032 consists of the minimum number of haplotypes that should be added to H so that the phylogeny T has minimum length. if the haplotype set H \u2032 is empty, i.e., if G = ( H, E ) is connected, then MPPEP-SNP. the MPPEP-SNP can be solved in polynomial time as the minimum spanning tree is a (optimal) solution to the MPPEP-SNP. if the input haplotype set H satisfies the perfect phylogeny condition then the MPPEP-SNP can be still solved in polynomial time. if the haplotype set H \u2032 is empty, then MPPEP-SNP can be solved in polynomial time. if the input haplotype set H satisfies the perfect phylogeny condition, then the MPPEP-SNP can be still solved in polynomial time. a mixed integer programming model for the MPPEP-SNP Let V = 1, 2,..., n, n + 1, n + 2,..., n + | H \u2032 | the set of potential vertices of a phylogeny T of H. we can easily bound the cardinality of H \u2032 by means of the following approach. a lower bound UB on the overall number of Steiner vertices of the optimal phylogeny T can be obtained by computing the sum UB = ( h i, h j ) E ( T ) d h i h j, a lower bound LB on the overall number of Steiner vertices of the optimal phylogeny T can be obtained as [30,31]: LB = L ( T ) 2 n + 1 formulation 1 Basic Model min i, j V : i j s S z ij s (1a) s.t. x i s = h i ( s ) s S, i H (1b) x i s u i s u i s S, i V (1c) z ij s + x i s x j s + y i the objective function (1a) aims at minimizing the length of the optimal phylogeny. Constraints (1b) impose that the s-th coordinate of vertex ui, i V, can assume value 1 only if vertex ui is considered in the optimal solution to the problem. formulation 1 can be easily extended to the case in which the haplotypes are represented by multi-character data, i.e., sequences over an alphabet = 0,1,2,.... if the generic haplotype were, for example, the string AACGT, then it could be represented as 1000 1000 0100 0010 0001. i j (1e) s S z ij s = y ij i, j V : i j (1g) y ij u i i, j V : i j (1h) j V : i j y ij u i i i V (1i) i, j C : i j y ij = i V u i constraints (1g)-(1h) impose that in the optimal solution to the problem variable yij may assume value 1 only if both vertices i and j are considered. constraints (1l) impose that the first n + LBvertices in V have to be considered in the optimal solution to the problem. variables x i s and z ij s can be relaxed in Formulation 1c)-(1e) and convexity constraint (1f) suffice to guarantee integrality in any optimal solution to the problem. formulation 1 can be reduced in size by removing those variables that are redundant or whose value is known in the optimal solution to the problem. the input haplotype set H is characterized by equal alleles, i.e., by the existence of two alleles, say 1 and 2, such that h i ( 1 ) = h i ( 2 ), for all i S. a similar situation occurs when there exists an allele S such that h i ( 1 ) = h i ( 2 ), for all i S. w s z ij s (2a) s.t. x i s u i s, i R (2b) s s z ij s s. i, j Z (2f) s s z ij s s. i, j Z (2f) s s z ij s s. i, j Z (2f) s i, j Z (2h) s z ij s u j j R, i V : i, j Z (2i) j V : j Z s s z ij s 1 i Q (2j) j V : j Z s s z ij s u i i i R (2k) i, j C : i, j Z s i R (2b) s \u2032 s z ij s \u2032 + h i ( s) x j s 1 s, i V H, j V H \u2032 (2d) s \u2032 : s \u2032 s z ij s \u2032 x i s + x j s 1 s, i V H, j V H \u2032 (2d) s ' in Formulation 2 variables x i s and z ij s cannot be relaxed anymore. a number of valid inequalities can be developed to strengthen Formulation 2. problem variable ui, i V(Q n + UB), can assume only value 0 or 1. if ui = 0, constraint (3) reduces to ui + 1 0 which is trivially valid for Formulation 2. if ui = 1, constraint (3) reduces to ui + 1 1 which is again valid. s s s 1 z ij s 1, s 2 : s 1 s 2, i, j V H \u2032 : i, j Z (5) x i s 2 + x j s 2 2 ( 1 z ij s 1 ). s s s 1 z ij s = 1 or z ij s 1 = 1. z ij s 1 = 1 then constraint (5) reduces to + x i s 2 x j s 2 0 (respectively x i s 2 + x j s 2 0 ) which is again valid. similar arguments can be used to prove the following proposition. a possible solution to the instance may consist of either a star centered in haplotype h3 = 10 or a star centered in haplotype h3 = 01. a possible strategy to break this class of symmetries consists of imposing the following constraints. Proposition 6 Constraints j V : j Z s z ij s j V : j Z s z ( i + 1 ) j s = 0, constraint (11) reduces to j V : j Z s z ij s 1 which is trivially valid due to Propositions 1 and 2. Proposition 7 Constraints s S z ik s + s S z kj s 1 i, j Q 3 (12) are valid for Formulation 2. Proof In a feasible solution the path between two distinct haplotypes h i, h j H cannot be shorter than the distance d h i h j. proposition 1 Constraints u i + 1 u i i V ( Q n + UB) (3) are valid for Formulation 2. proof In a feasible solution to the problem variable ui, i V(Q n + UB) can assume only value 0 or 1. if ui = 0, constraint (4) reduces to j V : j Z s z ij s 0 which is trivially valid. if ui = 0, constraint (4) reduces to j V : j Z s z ij s 2 which is again valid. s z ij s, i, j V H \u2032, i,jZ, can assume only value 0 or 1. s z ij s = 0, then constraint (5) reduces to + x i s 2 x j s 2 2. s s 1 z ij s s 1, s 2 : s 1 s 2, i V H, j V H \u2032 (7) h i ( s 2 ) + x j s 2 ( 1 z ij s 1 ) are valid for Formulation 2. i V H \u2032 R (9) p = 1 s 2 s p x i p p = 1 s 2 s p x i + 1 p + p = 1 s 2 s p x i + 1 p + p = 1 s 2 s p ( 1 u i + 1 ) s, i R n + UB (10) are valid for Formulation 2. j s = 0, constraint (11) reduces to j V : j Z s z ij s 1 which is trivially valid due to Propositions 1 and 2. Proposition 6 forces vertices in V H \u2032 to be sorted according to a decreasing degree order. only one of the two sums s S z ik s or s S z jk s can be equal to 1. Note that if k R then (12) can be strengthened by replacing the right-hand-side by uk. Proposition 7 can be generalized as follows. tion 1, the benefits obtained by the removal of redundant variables and by the inclusion of the valid inequalities previously described. we emphasize that the experiments aim simply to evaluate the runtime performance of our model for solving MPPEP-SNP. the GESC-RM consists of Formulation 2 strengthened by the valid inequalities previously described. the Flow-RM consists of Formulation 2 strengthened by the valid inequalities and such that the GSEC are replaced by a multi-commodity flows. in preliminary experiments we observed that the Flow-RM outperforms the GESC-RM in terms of solution time. this fact is due to the computational overhead introduced by the GSEC separation oracle which seems to be not compensated by the size of the analyzed instances. we also tested a number of generic primal heuristics for the Steiner tree problem to generate a first primal bound to the MPPEP-SNP. forbidden path constraints (13) are violated if there exists a path p having internal vertices in C V, 2 |C| d 1, C Qd =, and such that s S z ip 1 s + k = 1 | C | 1 s S z p k p k + 1 s + s S z p | C | j s > | C |. if all vertices have been selected but less than 10 distinct paths have been generated, then we select a larger subset of VQd (e.g., a triplet of vertices) this procedure may potentially generate all the possible paths violating (13) a decision variable s = 1 if the overall number of changes at coordinate s S of T is equal to 0 otherwise, for all s S and 1,2,...,q, and by adding the following constraints i, j V. we compared [1]\u2019s polynomial-size formulation versus the Flow-RM on [1]\u2019s real instances of the MPPEP-SNP. a set of four human mitochondrial DNA from HapMap [35. 40 haplotypes have 52 SNPs each, 395 haplotypes having 830 SNPs each, 13 haplotypes having 390 SNPs each, and 44 haplotypes having 405 SNPs each. such instances consist only of non-recombining data (Y chromosome, mitochondrial, and bacterial DNA) only in two cases, human mtDNA 4052 and human mtDNA 395830, the Flow-RM needed more than 5 minutes to find the optimal solutions. a more thorough implementation of the separation oracle and the use of more performing languages (e.g., C++) could help in speeding up computations in those instances at least. Flow-RM is able to tackle instances of the MPPEP-SNP containing up to 270 haplotypes having up to 9 SNPs each within 12 hours computing time. authors also observed that their algorithm is unable to solve larger instances of the MPPEP-SNP, no matter the maximum runtime considered. the table does not report on the performance of [1]\u2019s enumeration algorithm. they never found the optimal solution to the analyzed instances within the limit runtime of 3 hours. the only exceptions are the 7th instance of the group 15010, the 9th instance of the group 20010, the 2th instance of the group 25010, and 3th instance of the group 30010. 99 8 83 3497.73 2.17 421 9 62 862.48 2.85 540 9 72 1154.77 2.51 410 10 64 87.19 0 92 10 80 399.89 1.56 256 200 1 99 614.86 0 72 250 1 117 1155.41 0 197 2 99 1353.16 1.28 149 2 109 7757.98 1.72 1596 3 96 896.68 0.67 226 3 117 387.1 f1 constituted by 63 haplotypes having 16569 SNPs each. i2 constituted by 40 haplotypes having 977 SNPs each. m4 constituted by 26 haplotypes having 48 SNPs each. p5 constituted by 21 haplotypes having 16548 SNPs each. the Flow-RM was unable to solve, within the limit time, the considered instances for values of k 13,15. the Flow-RM exactly solved in less than a minute the instance f1 when considering values of k 10,13. in 20 minutes the instance i2 when considering k = 10; in less than 3 minutes the instance k3 when considering k = 10; and the instance m4 in 5 seconds. the Xpress Optimizer took more than 12 hours to exactly solve the instance p5 and explored over 10 million nodes in the search tree. despite the strengthening valid inequalities, p5 is characterized by highly fractional relaxations. e amino acid sequences having 176 sites each; a set of 500 sequences of mtDNA from the NCBI BLASTN best aligned taxa having 3000 sites each. a set of 500 sequences of mtDNA from the NCBI BLASTN best aligned taxa having 3000 sites each; and a set of 500 sequences of mtDNA from the NCBI BLASTN best aligned taxa having 10000 sites each. formulation 2 is characterized by faster linear relaxations at each node of the search tree. the Flow-RM consists of Formulation 2 strengthened by the valid inequalities previously described. the Flow-RM can be obtained by replacing constraints 2l. j f ji q = 0 q V H : q 1, i V : i q f qi q = 1 q V H : q 1 (17) f ij q 0 q V H : q 1, i, j V : i, j Z. separated oracles for forbidden path constraints are loaded together with reduced model. the valid inequalities (3)-(12) are dynamically generated by means of a separation oracle working as follows. we select two distinct vertices v1,v2 VQd such that edge (v1,v2) has the largest weight. we set C = v1,v2, mark v1 and v2 as visited. if p is satisfied then we add the constraint s S z ip 1 s + k = 1 | C | 1 s S z p k p k + 1 s + s S z p | C | j i, j V : i, j Z z ij s s S (21) or i, j V : i, j Z z ij s >, s S (22) where 1,2,...,q and q = min k V H h k ( s ), n / 2. a set of four human mitochondrial DNA from HapMap [35] constituted by 40 haplotypes having 52 SNPs each, 395 haplotypes having 830 SNPs each, 13 haplotypes having 390 SNPs each, and 44 haplotypes having 405 SNPs each. the Flow-RM is always characterized by (i.e., i.e., i.e., i.e., i.e., [1] proposes an alternative and faster exact approach to solution of the MPPEP-SNP based on the brute-force enumeration of all possible Steiner vertices necessary to solve a specific instance of the problem. despite the differences in terms of implementation language between the two programs, the Flow-RM proved to be competitive with [1]\u2019s enumeration algorithm. Flow-RM solution human chromosome Y 150 49 0.00 0.00 16 yes Bacterial mtDNA 17 1510 26.04 20.83 96 no Chimpanzee chromosome Y 15 98 0.00 0.00 99 yes Human mtDNA 40 52 24.66 1.37 73 no Human mtDNA 395 830 22.64 7.55 53 no Human mtDNA 13 390 12.50 6.25 48 no Human mtDNA 44 405 the results obtained in our experiments are shown in Table 2. Performances of the Flow-RM on a set of random instances of the MPPEP-SNP H Instance H post Time GAP (%) Nodes H In. 100 1 57 520.05 0 1807 150 1 82 284.51 0 424 2 60 59.74 0 174 2 83 314.27 0.76 56 3 63 377.75 1.45 110 3 81 799.01 0 67 4 61 2491.62 3.81 3351 4 67 1809.26 2.66 6617 5 60 2918.09 4.63 2062 5 79 1001.14 2.29 187 6 57 349.54 1.59 264 f1 constituted by 63 haplotypes having 16569 SNPs each, i2 constituted by 40 haplotypes having 977 SNPs each, k3 constituted by 100 haplotypes having 757 SNPs each, m4 constituted by 26 haplotypes having 48 SNPs each, and p5 constituted by 21 haplotypes having 16548 SNPs each. k = 15 was already a threshold after which the haplotype submatrix gave rise to too large formulations. for each k-block B in H r we considered the hamming distance d h i h j = s B | h i ( s ) h j ( s ) maximizing the sum h i, h j H r, h i h j d h i h the Xpress Optimizer took more than 12 hours to exactly solve the instance p5 and explored over 10 million nodes in the search tree. despite the presence of the strengthening valid inequalities, p5 is characterized by highly fractional relaxations. a set of 41 sequences of O.rufipogon DNA (red rice) having 1043 sites each. 80 human mtDNA sequences having 245 sites each. a set of 500 sequences of mtDNA from the NCBI BLASTN best aligned taxa having 3000 sites each. an exact approach entirely based on integer programming may perform better than the implicit enumeration of the vertices of the generalized Buneman graph. we investigated the most parsimonious phylogeny estimation problem from single nucleotide polymorphism (SNP) haplotypes. the MPPEP-SNP is N P -hard and this fact has justified the development of exact and approximate solution approaches. the work provides methodology suitable for provably optimal solution of some harder instances that resist all prior approaches. our results may provide useful guidance for strategies and prospects of similar optimization methods for other variants of phylogeny inference. authors declare that they have no competing interests."}