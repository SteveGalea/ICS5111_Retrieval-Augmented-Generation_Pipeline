{"summary": "techniques for genome-wide monitoring of expression data are increasingly moving into the clinic. techniques for designing microarray-based diagnostics or discovering disease subtypes require a reasonable number of samples representing each patient class. for rare diseases or genetically heterogeneous disorders, another analysis paradigm is needed. the problem of identifying differentially expressed genes has been viewed in the framework of outlier detection. the problem is that of identifying \u201cabnormal\u201d samples given only \u201cnormal\u201d samples as training data. the problem is particularly ill-suited for anomaly detection, as for many other machine learning problems. a single abnormal sample characterized by abnormal expression of a single gene could not possibly be detected by any method. our method is applicable when a sizable number of genes' expression levels are sufficiently different. we characterize the classes of anomalies we can expect to detect. the task is then to identify samples from class B after training on samples from class A alone. in most envisioned applications, such as diagnosing rare developmental disorders, abnormalities are likely to be one of a kind. in each data set in this compendium, we have a collection of relatively similar anomalies, and we know which samples we should expect to identify as anomalous. FRaC learns relationships among gene expression in the training data. it uses those models to estimate the likelihood of test set expression. the extent to which a test set gene's expression is considered anomalous is measured by the log-loss of its likelihood, according to those models. CSAX uses FRaC to compute an anomaly score for each gene. we use our own implementation of FRaC; the source code and documentation are available in the Supplementary Material. CSAX: A new method for expression anomaly detection. a single gene set may not be enough by itself to fully characterize an anomaly. a single gene set may not be enough by itself to fully characterize an anomaly. a single gene set may not be enough by itself to fully characterize an anomaly. we consider the gene sets with the best median rankings (lowest values of V) to be the most informative ones. let ES(g) be the enrichment score calculated by GSEA for gene set g. the method can be viewed as the likelihood that an anomaly detector assigns a higher anomaly score to a test set anomaly than it does to a test set normal. higher AUCs are better, the best possible score being 1.0. for each data set, we create an anomaly detection task. the second set combines data from several of our own studies of gene expression in second trimester amniotic fluid supernatant samples. abnormal samples include those from fetuses with trisomy 18, trisomy 21, Turner syndrome, twin-twin transfusion syndrome, or obese mothers. the controls are all control samples from these same studies. to create an anomaly detection task from a microarray study with two classes of samples, A and B, we randomly select a portion of the A samples for the test set. the task is then to identify samples from class B after training on samples from class A alone. in most envisioned applications, such as diagnosing rare developmental disorders, abnormalities are likely to be one of a kind. FRaC learns relationships among gene expression in the training data and measures their reliability. it uses those models to estimate the likelihood of test set expression. the extent to which a test set gene's expression is considered anomalous is measured by the log-loss of its likelihood, according to those models. we use leave-one-out cross-validation to sample the predictive error. we model Ei as a normal distribution, where and are set to the sample mean and standard deviation. SEA takes as input a list of genes, ranked by their anomaly scores. a normalized version of the enrichment score accounts for gene set size. a single gene set may not be enough by itself to fully characterize an anomaly. a single gene set may not be enough by itself to fully characterize an anomaly. the method that we use first considers the collection of rankings for each gene set and computes its median rank. if a gene set appears in the #1 position more often than not, its median rank will be 1. Let be our collection of G gene sets, and B be the number of bagging iterations. source code and documentation for CSAX can be found in the online Supplementary Material. the most successful general approaches include density-based methods such as the local outlier factor (LOF) (Breunig et al., 2000), which identifies outliers by comparing their distances from their nearest neighbors to the typical distances between nearby training examples. FRaC forms the core of our new method below. given a training set and an unlabeled test example, FRaC does the following for all genes i: 1. Infer a predictive model Ci of the expression of gene i from the training data. CSAX uses FRaC to compute an anomaly score for each gene. CSAX uses FRaC to compute an anomaly score for each gene. we run the \u201cpreranked\u201d version of GSEA on gene sets with at least 7 and at most 500 genes. gene sets that best explain a true difference between an unlabeled microarray and the training set will appear at or near the top of GSEA's ranked list over multiple iterations of bagging. gene sets that are only enriched because their genes are misrepresented in the training set are less likely to do so. a single gene set may not be enough by itself to fully characterize an anomaly. we define ES(g)=0 for any gene set g that does not appear in the table. we combine enrichment scores of each gene set, discounted by their position in. we randomly select 75% of the normal samples for training. the remaining 25% of the normal samples make up the test set. we repeat this process 20 times and report an average AUC for each anomaly detection method for each data set. the abnormal samples include those from fetuses with trisomy 18, trisomy 21, Turner syndrome, twin-twin transfusion syndrome, or obese mothers. the controls are all control samples from these same studies. CSAX performs well and identifies the gene sets that are most surprisingly dysregulated. on the Tasks in our Compendium Average AUC Task SVM LOF FRaC FRaC + Enrichment CSAX RAAD score atrt 1.00 1.00 0.99 0.99 1.258 bcat 0.97 0.95 0.97 0.92 0.87 1.102 bild 0.78 0.77 0.88 0.98 1.00 1.064 biomarkers 0.59 0.93 0.95 0.93 0.94 1.230 breast.basal 0.75 0.69 0.76 0.77 0.73 1.128 73 1.058 survey 0.61 0.67 0.88 0.81 0.86 1.043 tzd 0.57 0.54 0.60 0.61 0.59 1.057 Best AUC 7 5 14 6 10 Avg AUC 0.699 0.715 0.765 0.732 0.765 One-class SVMs (Sch\u00f6lkopf et al., 2000), FRaC (noto et al., 2011), FRaC + enrichment (as defined in the text) and src activation in the anomalous samples produces anomalous gene sets reflecting the direct effects of src expression. the top gene set identified by CSAX, with a median rank of 5, is \"Regulation of signaling by CBL\" the variation in performance seems to depend strongly on characteristics of individual data sets. we refer to this measure as the relative anomaly aggregate distance (RAAD) where is the training set, are the test set anomalous instances, are the test set normal instances, and |xq| indicates the vector distance between a training and test set instance. we use the l1 norm when computing vector distance because it is intuitive. preterm and amniotic fluid data sets were 1.045 and 0.98 respectively. the preterm data set had a CSAX AUC of 0.606 (compared to 0.580, 0.498, and 0.574 with LOF, SVM, and FRaC), respectively. despite the limited overall prediction accuracy, we found the gene sets CSAX highlighted for individuals or groups of samples. CSAX highlighted dysregulation of calcium signaling or homeostasis pathways in six individuals with PVL. CSAX highlighted dysregulation of calcium signaling or homeostasis pathways in six individuals with PVL. expression of genes involved in Notch signaling, required for neural stem cell development, is known to be disrupted in the brains of offspring of mice fed high fat diets. in individual samples we see different processes coming to the fore. one sample featured disruption of lipid and cholesterol transport pathways; in another, axonogenesis was most affected. CSAX is identifying valid characteristics of particular samples. each method performs best on some data sets. FRaC has the highest AUC (or is tied for highest AUC) on the largest number of data sets. bild 0.78 0.77 0.88 0.98 0.98 1.00 1.064 biomarkers 0.59 0.93 0.95 0.93 0.94 1.230 breast.basal 0.75 0.69 0.76 0.77 0.73 0.73 1.128 breast.er 0.65 0.78 0.83 0.78 0.82 1.104 desmoplastic 0.43 0.41 0.43 0.53 0.973 diabetes 0.49 0.45 0.49 0.42 0.44 0.913 downs 0.65 0.66 0.64 0.58 1.008 ethnic 0.59 0.65 0.732 0.765 One-class SVMs (Sch\u00f6lkopf et al., 2000), LOF (Breunig et al., 2000), FRaC + enrichment (as defined in the text) and CSAX. CSAX's most anomalous pathway across all src samples is \u201cSignaling by FGFR\u201d and \u201cDownstream signaling of activated FGFR\u201d. \"leukemia\" data sets distinguish between acute myeloid (normal) and acute lymphoblastic leukemia (anomalous) samples. the top gene set identified by CSAX, with a median rank of 5 is \"Regulation of signaling by CBL\" the variation in performance seems to depend strongly on characteristics of individual data sets. formally, where is the training set, are the test set anomalous instances, are the test set normal instances, and |xq| indicates the vector distance between a training and test set instance. a scatterplot comparing relative anomaly aggregate distance (RAAD) with test set performance over the 28 compendium data sets. preterm data set had a CSAX AUC of 0.606 (compared to 0.580, 0.498, and 0.574 with LOF, SVM, and FRaC, respectively) CSAX highlighted dysregulation of calcium signaling or homeostasis pathways in six individuals with PVL. amniotic fluid in aneuploidy and maternal obesity In the amniotic fluid data set, overall AUC is no better than chance. the poor RAAD and AUC scores for this data set make sense because the controls are highly variable. the most dysregulated pathways in trisomy 21 samples relate to neural development, heart development, and vision. in individual samples we see different processes coming to the fore. one sample featured disruption of lipid and cholesterol transport pathways. in another, axonogenesis was most affected. the top pathways implicated oxidative stress and inflammation. a single neonatal sample had retinopathy of prematurity (ROP) but no complications. the top gene sets in this sample were \"platelet degranulation\" and \"platelet activation\" there is an ongoing debate in the literature about whether platelets play a role in the pathogenesis of ROP. 16 of 38 abnormal samples were from fetuses with chromosomal aneupoidy. tooth development, immune processes, and glucocorticoid metabolism were among the top ten gene sets in trisomy 21 samples. the original analysis of the samples from obese and lean mothers noted that APOD is the most upregulated gene in fetuses of obese women. the gene has been demonstrated to regulate inflammatory response and exert neuroprotective and neurotrophic effects in a rodent model of excitotoxic brain injury. but until now, the link between increased expression of APOD and increased oxidative stress in second trimester fetuses of obese women has been only speculative. CSAX is about as accurate as FRaC (Table 1), but has two very important differences. it identifies gene sets that may help explain the nature of each anomaly. CSAX also outperforms the simple combination of running enrichment analysis. there is no reason that CSAX cannot be applied in an RNA-seq setting. there is no reason that CSAX cannot be applied in an RNA-seq setting. future work should include demonstrating CSAX's power to identify systematic anomalies in RNA-seq data."}