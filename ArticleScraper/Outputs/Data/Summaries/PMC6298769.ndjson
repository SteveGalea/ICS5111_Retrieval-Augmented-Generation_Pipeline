{"summary": "methicillin-resistant Staphylococcus aureus emerges as one of the most widespread and virulent pathogens. this entwined transmission among hospitals and the community has obscured understanding of the dynamics and persistence of MRSA. analyzing RSA outbreaks in Sweden offers a good opportunity to study the hybrid dynamics of MRSA in hospital settings where both nosocomial transmission and importation occurs. the problem is again complicated by the unobserved stealth transmission dynamics that occurs in highly complex time-varying contact networks. agent-based network model-Bayesian inference system for estimating unobserved colonization and importation rates from simple incidence records. we use this system to infer the transmission dynamics of the most commonly diagnosed MRSA strain, UK EMRSA-15. key features estimated include the number of infections acquired in hospital and imported from outside. in this study dataset, we use a raster plot to display the distribution of infections in 114 infected wards over time. infections are distributed without noticeable clustering, presumably due to effective control measures taken in the study hospitals that maintain a low infection rate. inset shows the scatter plot of the number of positive cases and patient-days per ward. the average number of infections is not observed to increase linearly with patient-days. in hospital settings, MRSA transmission is primarily mediated indirectly by healthcare workers. many previous studies have formulated transmission models using ordinary differential equations (ODEs) to account for heterogeneity among different settings. transmission occurs on the substrate of a time-varying contact network. the contact network is time-varying and exhibits high spatiotemporal complexity. the daily in-hospital patient number fluctuates between 4000 and 7000 during the study period. a patient located in one hospital can be involved in the transmission occurring in another when he/she moves across multiple facilities. the model simulates two connected dynamics: nosocomial transmission and importation from the community. the community is broadly defined as all locations outside the study hospitals. whereas decolonization, infection and recovery progress spontaneously, independent of the contact network. instead, two additional parameters are introduced to represent transmission intensity. for patients who appear for the first time in hospital, we assume they belong to states C and P with probability C 0 and I 0, respectively. IF can be used to infer the maximum likelihood estimates (MLEs) of parameters in an agent-based model. IF can be used to infer the maximum likelihood estimates (MLEs) of parameters in epidemic models. the inference system has been widely used in infectious disease forecast and inference. for real-world data the inference targets are unobserved. instead we test the inference system using model-generated synthetic outbreaks. CIs for the parameters, I 0 and C 0 are 9.00, [ 8.07, 9.68 ] 10 - 3, 1.91, [ 1.38, 2.54 ] 10 - 3 and 7.18, [ 5.84, 8.70 ] 10 - 2, with the actual values = 9 10 - 3, I 0 = 2 10 - 3 and C 0 = 7.5 10 - 2. In its implementation, the performance of the inference system thus accurately estimates and I 0 from noisy observations whiskers mark the inferred values within the range [Q1-1.5 IQR, Q3 + 1.5 IQR]. dots are outliers. red crosses represent the synthetic observations used during the inference (B) and actual colonization in the outbreak (C). the same analysis was also performed for RMSE (B), R 2 (C) and Pearson correlation coefficient (D) the posterior parameter distributions (300 ensemble members) for different iterations in one realization of the IF algorithm are shown by the blue boxes and whiskers. the red crosses represent the synthetic observations used in the inference. ferred parameters are shown by the blue boxes and whiskers. the red crosses represent the synthetic observations used in the inference. the inference system can distinguish the number of infections transmitted in hospital and imported from outside. Observed incidence every 4 weeks (red crosses) and corresponding distributions generated from 1000 simulated outbreaks using the inferred mean parameters (blue boxes and whiskers) the vertical red dash line indicates 114, the observed number of infected wards. the IF. Boxes show the inferred distributions of 300 posterior parameters. we generated the surrogate data (1000 synthetic outbreaks) using the inferred parameters. compared log likelihood (A), RMSE (B), R 2 (C) and Pearson correlation coefficient (D) from the inference in Figure 3B. the inferred parameters can be plugged back into the model to run simulations. for example, we performed 1000 model simulations using the inferred mean parameter values. the inferred parameters can be plugged back into the model to run simulations. the observed distribution agrees well with the simulated distributions. the inference system also discriminates the burdens of nosocomial transmission and infection importation. a substantial number of infections are inferred as importations. sporadic nosocomial transmission occurred during the first year of the outbreak. both transmission and importation rates, I 0 and C 0, also experienced growth. this simultaneous rise may have been caused by household transmission initiated by asymptomatically colonized patients discharged from hospitals. a clear heavy-tailed power-law distribution y x - 2.13 emerges in which the colonization probability spans several orders of magnitude. the complex spatiotemporal interaction patterns within the network give rise to a small number of patients with disproportionately high risk of colonization. each 4 weeks, we selected patients with an estimated colonization probability higher than a certain threshold for screening. if positive, these inpatients were decolonized. the results show that the proposed intervention strategy can avert considerable numbers of colonization and infection. the inset in (A) reports the Pearson correlation coefficient between colonization probability estimated in real time and that obtained using information from the whole course of the epidemic. curves are average cumulative cases obtained from 1000 experiments with a 100% decolonization success rate. tracing time windows ranging from 1 day to 14 days were tested. the number of screened patients does not increase significantly with tracing times longer than 14 days. if patients listed for screening have already discharged before diagnosis, they are screened upon their next re-admission. this preventive approach is more effective than contact tracing in the presence of frequent importation, as it disrupts probable transmission pathways. in real-world hospital settings, the proposed inference-based intervention could be implemented and evaluated in real time. the relative date of diagnosis and associated ward of each observed infection were recorded. the blue box defines the transmission process within hospitals. imported infection and colonization from outside the study hospitals are quantified by two parameters I 0 and C 0. Numerical data represented in Figure 1. infected wards tend to have a higher number of inpatients, a longer average length of stay as well as a larger ward size. intuitively, the number of MRSA infections in a ward should increase as patient-days within the ward increase. however, the average number of infections is not observed to increase linearly with patient-days. in this work, we model nosocomial MRSA transmission using an individual-level agent-based model. the heterogeneity of contact in different ward types can be accounted for within the model. if two patients stay in the same ward simultaneously, the shared healthcare personnel may facilitate transmission between them. the contact network is time-varying and exhibits high spatiotemporal complexity. the daily in-hospital patient number fluctuates between 4000 and 7000 during the study period. about 100 connected components coexist in the contact network each week. the transmission process is density-dependent, as the force of infection in a ward increases with the number of colonized patients within the ward. Upon colonization, asymptomatic persons can return to the susceptible state at a spontaneous decolonization rate. asymptomatic persons can test positive with an infection progression rate p. the parameter ranges are enlarged slightly to cover the values reported in these works. our main objective is to infer the three most important parameters governing transmission dynamics: the transmission rate, the infection importation rate I 0 and the colonization importation rate C 0.. IF can be used to infer the maximum likelihood estimates (MLEs) of parameters in epidemic models and has been successfully applied to infectious diseases such as cholera (King et al., 2008) and measles (He et al., 2010). IF has been generalized for other model forms (e.g. stochastic models) using the plug-and-play approach. based model to simulate weekly incidence during a one-year period (52 weeks), and then imposed noise to produce the observations used in inference. the inference system thus accurately estimates and I 0 from noisy observations, and slightly underestimates C 0. the distributions of weekly incidence (blue boxes) are compared with the observed cases (red crosses) in Figure 2B. we also evaluated the agreement between the observed and simulated incidences. distributions of inferred colonization and actual colonization in the synthetic outbreak in Figure 2C. distributions of inferred transmitted incidence and actual transmitted incidence in the synthetic outbreak in Figure 2D. distributions of inferred transmitted incidence and actual transmitted incidence in the synthetic outbreak in Figure 2E. the inference system can distinguish the number of infections transmitted in hospital and imported from outside the study hospitals. the inference system can distinguish the number of infections transmitted in hospital and imported from outside the study hospitals. more tests for alternate synthetic outbreaks and different observation frequencies were performed and are presented in Figure 2\u2014figure supplements 2\u20135. we inferred model parameters year by year (52 weeks) between 2 consecutive years, the inferred results from the previous year were used to initialize the inference system in the next. the data set includes: (1) distributions of inferred parameters in Figure 3A; (2) distributions of inferred incidence and actual observation in the real-world outbreak in Figure 3B; (3) distribution of the number of infected wards obtained from inference in Figure 3C; (3) distributions of the number of infections per ward in Figure 3D. the simulation results agree well with the classification using days from admission to infection. inferred parameters and 95% CIs across 6 years using the actual diagnostic data. results are obtained from 100 independent realizations of the IF algorithm. the inferred parameters can be plugged back into the model to run simulations and obtain information addressing our questions of interest. for example, we performed 1000 model simulations using the inferred mean parameter values, and generated distributions of incidence from the stochastic agent-based model. all observations fall within the whisker range of Tukey boxplots. in clinical practice, the number of days between hospital admission and infection is usually used to distinguish hospital-acquired from community-acquired infections. the number of imported and nosocomial cases obtained from inference generally matches the classification result. asymptomatic colonization is a major issue hindering the control and elimination of MRSA in hospitals. screening can identify colonized patients and evaluate the general colonization burden. however, it is an inefficient and costly measure that wastes resources that otherwise could be used to solve urgent problems. the distribution of colonization probability for each individual in hospital at T = 40 (week 160) calculated from 104 model simulations. the probability is color-coded in a logarithmic scale; node size reflects the number of connections. the proposed intervention strategy can avert considerable numbers of colonization and infection. the marginal benefit becomes negligible below a certain threshold value, as the remaining colonized and infected patients are possibly caused by importation. heuristic control measures relying on the number of contacts, length of stay and contact tracing all limit MRSA transmission. inference-based screening of approximately 0.89% (6,617/743,599) of all patients can avert up to 38% (121/315) of infections. inference-based intervention can identify and treat pivotal individuals or superspreaders who may otherwise transmit MRSA asymptomatically in the first place. this preventive approach is more effective than contact tracing in the presence of frequent importation, as it disrupts probable transmission pathways. the data assimilation scheme we developed here enables estimation of epidemiological parameters and key transmission information using aggregated incidence data. in the future, more contact information such as healthcare workers shared by a group of patients could be incorporated into the contact network. in the future, it could be used to provide actionable information for disease control in less developed settings where MRSA is endemic. in a highly interconnected area, transmission of antibiotic resistant pathogens from endemic regions to epidemic-free hospitals is more likely. iterated filtering for agent-based models We infer system epidemiological parameters using an iterated filtering algorithm (Ionides et al., 2006; King et al., 2008; Ionides et al., 2011). this algorithm has been coupled with ODE models and used to infer latent variables associated with the transmission of cholera. the es rule in a deterministic way such that the first two moments (mean and variance) of an observed variable are adjusted while higher moments remain unchanged during the update. in epidemiological studies, the EAKF has been widely used for parameter inference and forecast of infectious diseases. if a is too small, the algorithm may \u2018quench\u2019 too fast and fail to find the MLE; if it is too close to 1, the algorithm may not converge in a reasonable time interval. if the ensemble mean stabilizes, increasing the iteration time will not affect the MLE. for t = 1 to T do Run the agent-based model M with posterior z t - 1 l n obtained from last update for one week. return the ensemble of incidence: o t l n to posterior z t l n using the EAKF. an alternative method to infer posterior parameters is to use Approximate Bayesian computation (ABC) in a typical ABC rejection algorithm, large numbers of parameters are sampled from the prior distribution. the distance between simulated samples (generated using the parameters) and observed data is calculated. the colonization probability estimated in real time is highly correlated with that obtained using information from the entire outbreak record. in practice, every 4 weeks, the estimated colonization probability and the decolonization list were updated. data description The dataset contains admission and discharge records of 743,599 distinct patients from 66 hospitals (271 clinics, 1041 wards) in Stockholm County, Sweden. the exact dates and ward types are confidential for the protection of patient privacy. the distribution of parameters is iteratively optimized per observations and narrowed down to values that achieve maximum likelihood. in its original implementation, the data assimilation method used in IF is sequential Monte Carlo, or particle filtering. in its original implementation, the data assimilation method used in IF is sequential Monte Carlo, or particle filtering. the initial prior ranges for these parameters are reported in Table 1. the initial prior ranges for these parameters are reported in Table 1. if more specific information about these parameters become available, it may be possible in the future to better constrain the model with their incorporation into the system. Ionides et al. used \u2018sliced likelihood\u2019 to numerically estimate the Fisher information and standard errors (SEs) of MLEs. in different runs, the MLEs are slightly different due to stochasticity in the agent-based model. for t = 1 to T do Run the agent-based model M with posterior z t - 1 l n. update the prior distribution of parameters, I 0 and C 0. individual states are evolved per the agent-based model. a distance larger than a certain tolerance are rejected, and the retained parameters form the posterior distribution. the IF algorithm, instead, is applicable to computationally expensive agent-based models, but may become trapped in the local optimum of the posterior distribution. the inference-based intervention only uses information available at the time control measures are effected. in the inset of Figure 5A, we show that the colonization probability estimated in real time is highly correlated with that obtained using information from the entire outbreak record. each 4 weeks, the estimated colonization probability and the decolonization list were updated. the in-hospital patient number fluctuates between 4000 and 7000. the distribution of patient time in hospital follows a power-law shape with a heavy tail. this heterogeneity leads to high spatiotemporal contact network complexity. 128,119 patients were transferred from one ward to another during their stay. another 280,506 patients were readmitted within one year of their previous discharge. a traditional compartmental model using ordinary differential equations (ODE) may not adequately capture actual transmission dynamics. the model estimate of the observed state, that is 4 week incidence, was obtained by aggregating the total number of new infections across the entire population in the study hospitals. this aggregated, macroscopic state is then used in conjunction with the EAKF algorithm to update the parameter vector z = (, I 0, C 0 ) T. b s 2 + t, p r i o r 2 o t, p r i o r + t, o b s 2 + t, p r i o r 2 o t + t, o b s 2 + t, p r i o r 2 o t, o b s 2 + t, p r i x t, p o s t i - o t, p r i o r n, o t, p r i o r n. x t, p o s t i - o t, p r i o r n - are the posterior and prior of the unobserved variable or parameter. synthetic outbreak tested in Figure 2 was generated with the parameters = 9 10 - 3, I 0 = 2 10 - 3 and C 0 = 7.5 10 - 2. to mimic actual observational error variance, we assumed an observational error variance (OEV) of t, o 2 = 10 + ( 0.1 o s i m u l a t e ( t ) 2. the initial covariance matrix was assumed to be diagonal = d i a g. z m a x and z m i n are the vectors of the upper and lower bounds of parameters. for the EAKF, n = 300 ensemble members were used. in Figure 2\u2014figure supplement 1A, we compared the log likelihood computed from Figure 2B (vertical red line) with this distribution (blue bars) and calculated the 2-sided p-value. the p-value is well above zero, indicating that, in terms of log likelihood, our inferred dynamics span. in Figure 2 and Figure 2\u2014figure supplement 2, we used weekly observations. in Figure 2\u2014figure supplement 4, we assimilated 4 week incidence for a synthetic outbreak generated with the same parameter setting as in Figure 2. The findings indicate that this change of observational frequency does not affect the performance of the inference system. the evolution of the posterior parameter distributions for 20 iterations through the record is shown in Figure 3\u2014figure supplement 1. in general, the ensemble means of parameters become stable after 10 iterations with the EAKF through the record. increasing L will lead to narrower distributions of posterior parameters in Figure 3\u2014figure supplement 1. the best x m i n value was selected by choosing the value that minimizes the Kolmogorov-Smirnov statistic between the data and the fitted model. the fitted power-law exponent is = 2.13 with a standard deviation of 0.12. law fitting generated 10 4 synthetic datasets using the fitted model. we computed their KS statistic with respect to the model. we reject the hypothesis that the data are generated from the fitted model. otherwise, the power-law fitting is statistically significant. the data used in this article is a completely anonymized subset of the original data material, and keys to exact dates and identities of hospitals and individuals were not provided. the data used in this article is a completely anonymized subset of the original data material, and keys to exact dates and identities of hospitals and individuals were not provided. requests for data access should be addressed to FL. the Matlab code for parameter inference in a synthetic MRSA outbreak is provided as Source code file 1."}