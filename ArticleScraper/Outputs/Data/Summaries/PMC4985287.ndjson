{"summary": "large-scale datasets combined with quantitative analysis have successfully unraveled important features of empirical fitness landscapes. however, there is a huge gap between the limited throughput of fitness measurements (usually on the order of 102 variants) and the vast size of sequence space. reversions can occur during adaptive walks in diallelic sequence spaces. adaptation proceeds via \u201cindirect paths\u201d. the extra dimensions may further provide additional routes for adaptation. the four chosen sites contain 12 of the top 20 positively epistatic interactions in protein GB1. thus the sequence space is expected to cover highly beneficial variants. this empirical fitness landscape is expected to provide us insights on how high dimensionality would influence evolutionary accessibility. we first analyzed subgraphs of sequence space including only two amino acids at each site. each subgraph represented a classical adaptive landscape connecting WT to a beneficial quadruple mutant. each subgraph is combinatorially complete with 24 = 16 variants, including WT, the quadruple mutant, and all intermediate variants. we classified the types of all 24 pairwise epistasis in each subgraph. we computed the level of ruggedness as f s i g n + 2 f r e c i p r o c a l, where f t y p e was the fraction of each type of pairwise epistasis. the number of selectively inaccessible direct paths, i.e. paths that involve fitness declines, was each node represents a genotype, which is within a sequence space of two loci and two alleles. green arrows represent the accessible paths from genotype \u201c00\u201d to a beneficial double mutant \u201c11\u201d (colored in red) the fitness rank of the wild type genotype is 2.4% in the distribution of fitness measurements. 19.7% of the measured genotypes are lethal (fitness=0) bias of probability of realization in each subgraph was quantified using the Gini index. it is shown as a histogram in the inset. a total of 526 subgraphs were analyzed. the level of ruggedness is quantified as f s i g n + 2 f r e c i p r o c a l. the number inside a symbol indicates the number of subgraphs with identical properties. adaptation can be trapped when direct paths are blocked by reciprocal sign epistasis. a successful bypass would require a conversion step that substitutes one of the two interacting sites with an extra amino acid ( 00 20 ). this bypass is feasible only if the original reciprocal sign epistasis is changed to sign epistasis after the conversion. adaptation involves a detour step to gain a mutation at the third site ( 000 100 ). the original reciprocal sign epistasis is changed to either magnitude epistasis or sign epistasis on the new genetic background after detour. we found that there were on average 1.2 conversion bypasses and 0.27 detour bypasses. the maximum number of possible detour bypasses is proportional to the sequence length L of the entire protein. the pervasiveness of extra-dimensional bypasses in our system contrasts with the prevailing view that adaptive evolution is often blocked by reciprocal sign epistasis. the fitness of variants can be reconstructed by expansion of Fourier coefficients up to a certain order. in our system with four sites, the fourth order Fourier expansion will always reproduce the measured fitness. this indicates the presence of higher-order epistasis. the fraction of variance in fitness explained by expansion of Fourier coefficients truncated to different orders is shown for each subgraph. the blue line corresponds to the median. the top 0.1% subgraphs with fitness contributions from higher-order epistasis are shown in red lines. the fitness contribution from higher-order epistasis is small (bottom 0.1%, from VDGV to CSPA) in (A) and large (top 0.1%, from VDGV to WLLH) in (B). the fitness of variants can be reconstructed using Fourier coefficients truncated to a certain order. the relationship between the predicted G and the total size of residue 39, 41, and 54 for all variants is shown as a scatter plot. the predicted G increased as the total volume of core residues increased, indicating that the protein would be destabilized (i.e. decrease in fitness) when the core was overpacked. entropic effect and conformational effect in IgG-FC binding may also contribute to higher-order epistasis. stasis between G41F and V54A across different genetic backgrounds is shown. the epistasis value is color coded. amino acids of WT are boxed. the magnitude of pairwise epistasis was computed between each pair of amino acid substitutions. the interaction changed to negative epistasis when site 39 carried a tyrosine [Y] or a tryptophan [W] (Figure 3C\u2013D). paths at a global scale, we performed simulated adaptation in the entire sequence space of 160,000 variants. the fitness landscape was completed by imputing fitness values of the 10,639 missing variants that had fewer than 10 sequencing read counts in the input library. the model of protein fitness incorporated main effects of single mutations, pairwise interactions, and three-way interactions among site 39, 41 and 54. the scale on the right is for Correlated Fixation Model and Equal Fixation Model. a large fraction of beneficial variants in the sequence space (fitness > 1) were accessible from WT only via indirect paths. the fraction of genotypes accessible to 15 fitness peaks increased substantially when indirect paths are allowed in adaptation. to study evolutionary accessibility under constraints imposed by the standard genetic code, we restricted amino acid substitutions to those that were different by a single nucleotide. dimensional bypass did not fully commit to a fitness peak until the last two steps. only 100 randomly sampled lines are shown due to the difficulty in visualizing a large number of lines. the median entropy at each step in each category is represented by the red line. adaptive paths divided into three categories based on the change of Hamming distance to the destination (a fitness peak, in this case) conversion was found to be pervasive during adaptation in our fitness landscape (17% of mutational steps for Greedy Model, 41% for Correlated Fixation Model, 59% for Equal Fixation Model) a conversion step would increase the length of an adaptive path by 1, while a detour step would increase the length by 2. fraction of genotypes with accessible paths to all 15 fitness peaks increased from 34% to 93% when indirect adaptive paths were allowed. a substantial fraction of beneficial variants (fitness > 1) in the sequence space were accessible from WT only if indirect paths were used. a mutant library containing all amino acids at these four sites was generated by codon randomization. the \u201cfitness\u201d of protein GB1 variants was measured in a high-throughput manner by coupling mRNA display with Illumina sequencing. the relative frequency of mutant sequences before and after selection allowed us to compute the fitness of each variant relative to the wild type protein. each subgraph is combinatorially complete with 24 = 16 variants. we identified a total of 29 subgraphs in which the quadruple mutant was the only fitness peak. the number of selectively accessible paths varied from 12 to 1 among the 29 subgraphs. f t y p e was the fraction of each type of pairwise epistasis. the number of selectively inaccessible direct paths was positively correlated with the ruggedness induced by pairwise epistasis. each variant in the subgraph is represented by a node. each node represents a genotype, which is within a sequence space of two loci and two alleles. green arrows represent the accessible paths from genotype \u201c00\u201d to a beneficial double mutant \u201c11\u201d (colored in red) the high correlation (Pearson correlation = 0.97, p2.2 1016) validates the fitness data obtained in this study. the fitness rank of the wild type genotype is 2.4% in the distribution of fitness measurements. 19.7% of the measured genotypes are lethal. ious variants have a Hamming distance (HD) of 4 from WT to WT. the quadruple variant has a fitness between 0.01 and 1. a total of 526 subgraphs were analyzed. f t y p e denotes the fraction of each type of pairwise epistasis. the number inside a symbol indicates the number of subgraphs with identical properties. adaptation can be trapped when direct paths are blocked by reciprocal sign epistasis. all 20 possible amino acids were considered, the total number of neighbors would be 38. a successful bypass would require a conversion step that substitutes one of the two interacting sites with an extra amino acid. this bypass is feasible only if the original reciprocal sign epistasis is changed to sign epistasis after the conversion. the original reciprocal sign epistasis is changed to either magnitude epistasis or sign epistasis on the new genetic background after detour. detour bypass has a lower probability of success (20%, inset) and is less prevalent. the maximum number of possible detour bypasses is always fixed. the maximum number of possible detour bypasses is proportional to the sequence length L of the entire protein. the pervasiveness of extra-dimensional bypasses in our system contrasts with the prevailing view that adaptive evolution is often blocked by reciprocal sign epistasis. the fitness of variants can be reconstructed using Fourier coefficients truncated to a certain order. the fraction of variance in fitness explained equals 1). in our system with four sites, the fourth order Fourier expansion will always reproduce the measured fitness. the top 0.1% subgraphs with fitness contributions from higher-order epistasis are shown in red lines. a sequence logo was generated for the quadruple mutants corresponding to the top 0.1% subgraphs with higher-order epistasis. the fitness of variants can be reconstructed using Fourier coefficients truncated to a certain order. the fourier coefficients can be interpreted as epistatic interactions of different orders. the main effects of single mutations (the first order), pairwise epistasis (the second order) and higher-order epistasis (the third and the fourth order) variants shown as a scatter plot for (C) all variants (Pearson correlation = 0.41) and (D) variants with HD of 4 from WT (Pearson correlation = 0.34). the purple line represents the linear regression. predicted G increased as the total volume of core residues increased. therefore, the higher-order epistasis observed in this study could be partially attributed to steric effect. epistasis that cannot be determined due to missing variant is colored in grey. higher-order epistasis can change the type of pairwise epistasis. we computed the magnitude of pairwise epistasis between each pair of amino acid substitutions. we observed numerous instances where the sign of pairwise epistasis depended on genetic background. tyrosine [Y] or tryptophan [W] at site 39 were involved in the most significant higher-order interactions. in the complete sequence space, we identified a total of 30 fitness peaks. among them 15 peaks had fitness larger than WT and their combined basins of attraction covered 99% of the sequence space. the size of each basin of attraction is identified by the Greedy Model. a large fraction of beneficial variants in the sequence space were accessible from WT only via indirect paths. the fraction of genotypes accessible to 15 fitness peaks increased substantially when indirect paths are allowed in adaptation. accessibility to beneficial variants from WT was determined under constraints imposed by the standard genetic code. entropy of evolutionary outcome was calculated for each of the 160,000 variants. adaptation proceeds by sequential fixation of mutations that render the largest fitness gain at each step. in the Greedy Model, adaptation proceeds by sequential fixation of mutations that render the largest fitness gain at each step. the use of detour was less frequent (0.1% of mutational steps for Greedy Model, 1.3% for Correlated Fixation Model, 3.7% for Equal Fixation Model) detour bypass was less available than conversion bypass in our fitness landscape with L = 4. a conversion step would increase the length of an adaptive path by 1, while a detour step would increase the length by 2. we repeated the analysis in Figure 4F with the consideration of the constraints imposed by the standard genetic code. the constraints decreased the number of accessible variants due to the reduction in connectivity. however, this reduction in connectivity did not alter our core finding that indirect paths substantially increase evolutionary accessibility in rugged fitness landscapes. our analysis also ignored measurement errors, but the measurement errors are expected to be very small due to the high reproducibility in the data. imputation of missing variants and measurement errors can lead to slight mis-specification of the topological structure of the fitness landscape. higher-order epistasis has been reported in a few biological systems. the possible number of detour bypasses scales up with sequence length. it is plausible that the sequence of a large protein may never be trapped in adaptation. this work takes the optimistic view that we can push the boundary further and discover new mechanisms underlying evolution. ide was extended in a reaction containing 0.5 M of each oligonucleotide, 50 mM NaCl, 10 mM Tris-HCl pH 7.9, 10 mM MgCl2, 1 mM DTT, 250 M each dNTP. a constant region was generated by PCR amplification using KOD DNA polymerase (EMD Millipore, Billerica, MA) purified constant region and cassette I were digested with BciVI (New England Biolabs) and purified by PureLink PCR Purification Kit (Life Technologies) according to manufacturer\u2019s instructions. ligated product was purified from agarose gel using Zymoclean Gel DNA recovery kit. the DNA library was transcribed by T7 RNA polymerase (Life Technologies) according to manufacturer\u2019s instructions. mRNA-protein fusion was reverse transcribed using SuperScript III Reverse Transcriptase (Life Technologies) eluted sample was referred to as'selected library' PCR amplification was performed using KOD DNA polymerase (EMD Millipore) with 1.5 mM MgSO4, 0.2 mM of each dNTP (dATP, dCTP, dGTP, and dTTP), the selected library, and 0.5 M each of 5\u2019-CTA CAC GAC GCT CTT CCG ATC TNN NAG CAG TAC G we aimed to obtain at least 20 million paired-end reads for each input library and post-selection library. the average coverage for each variant would be more than 100 paired-end reads. there were 89,075,246 paired-end reads obtained for the input library. amino acid level for site 39, 40, 41, and 54 in both input library and selected library were counted. each paired-end read represented 1 count. custom python scripts and bash scripts were used for sequencing data processing. the fitness of each variant, wi, could be viewed as the fitness relative to WT (VDGV), such that = 1. Variants with c o u n t i n p u t 10 were filtered to reduce noise. the fraction of possible variants that passed this filter was 93.4% (149,361 out of 160,000 all possible variants) ln ( w a w B G ) - ln ( w b w B G ) (2) where wab represents the fitness of the double substitution, ln(wa) and ln(wb) represents the fitness of each of the single substitution respectively. wBG represents the fitness of each of the single substitution respectively. rule 1 prevents epistasis being artificially estimated from low-fitness variants. rule 2 prevents overestimation of epistasis due to low fitness of one of the two single substitutions. rule 3 prevents underestimation of epistasis due to low fitness of the double substitution. the fourier decomposition theorem states that the fitness function f ( z ) can be expressed as. f ( z ) = k f k ( - 1 ) z k (3) The formula for the Fourier coefficients f k is then: f k = 1 2 L z f ( - 1 ) z k (4). fitness values for 10,639 variants (6.6% of the entire sequence space) were not directly measured (read count in the input pool = 0) or were filtered out because of low read counts in the input pool. we performed regularized regression on fitness values of observed variants. 149,361 variants with experimentally measured fitness values were non-lethal. out of the 149,361 variants with experimentally measured fitness values, 119,884 variants were non-lethal ( f > 0 ). lasso regression adds a penalty term | | when minimizing the least squares. three models, namely the Greedy Model (de Visser and Krug, 2014), the Correlated Fixation Model (Gillespie, 1984), and the Equal Fixation Model (weinreich et al., 2006) were employed in this study to simulate the mutational steps in adaptive trajectories. the probability of fixation of a deleterious or neutral mutation is 0. the shortest path between a low-fitness variant and a high-fitness variant is inaccessible. if the length of the shortest path is larger than the genetic distance between two variants, adaptation requires indirect paths. the probabilities of all possible mutational trajectories were sorted from large to small. inaccessible trajectories were also included in this sorted list with a probability of 0. This sorted list was converted into a list of cumulative probabilities, which is denoted as. extra-dimensional bypass is mediated by higher-order epistasis. f 000 = 0 f 001 = 0 + 1 f 010 = 0 + 2 f 100 = 0 + 3 f 011 = 0 + 1 + 2 + 12 f 101 = 0 + 1 + 3 + 13 f 110 = 0 + 2 + 3 + 13 f 110 = 0 + 2 + 3 + 13 f 110 = 0 + 2 + 3 + 13 f 110 for the scenario illustrated in (B), we have 100 101 : 1 + 13 > 0 (20) 100 110 : 2 + 23 > 0 (21) Combining inequality (14) and (20) gives 13 > 0 (22) Combining inequality (15) and (21) gives 23 > 0 (23) For the scenario in (C), the proof of higher-order epistasis is similar. cleotide was extended in a reaction containing 0.5 M of each oligonucleotide, 50 mM NaCl, 10 mM Tris-HCl pH 7.9, 10 mM MgCl2, 1 mM DTT, 250 M each dNTP. a constant region was generated by PCR amplification using KOD DNA polymerase (EMD Millipore, Billerica, MA) purified constant region and cassette I were digested with BciVI. purified by PureLink PCR Purification Kit (Life Technologies) according to manufacturer\u2019s instructions. ligated product was purified from agarose gel using Zymoclean Gel DNA recovery kit. the DNA library was transcribed by T7 RNA polymerase (Life Technologies) according to manufacturer\u2019s instructions. the ligated product was purified by urea PAGE and translated in a 100 L reaction volume. the mRNA-protein fusion was then reverse transcribed using SuperScript III Reverse Transcriptase (Life Technologies) thermocycler was set as follows: 2 min at 95\u00b0C, then 10 to 12 three-step cycles of 20 s at 95\u00b0C, 15 s at 56\u00b0C, and 20 s at 68\u00b0C, and 1 min final extension at 68\u00b0C. eluted sample was referred as'selected library' the PCR product was then subjected to 2 100 bp paired-end sequencing. the average coverage for each variant would be more than 100 paired-end reads. 89,075,246 paired-end reads were obtained for the input library. custom python scripts and bash scripts were used for sequencing data processing. all scripts have been deposited to https://github.com/wchnicholas/ProteinGFourMutants. the fitness of each variant, wi, could be viewed as the fitness relative to WT (VDGV), such that = 1. Variants with c o u n t i n p u t 10 were filtered to reduce noise. the fraction of all possible variants that passed this filter was 93.4%. ln ( w a w B G ) - ln ( w b w B G ) (2) where wab represents the fitness of the double substitution, ln(wa) and ln(wb) represents the fitness of each of the single substitution respectively, and wBG represents the fitness of the background variant. rule 1 prevents epistasis being artificially estimated from low-fitness variants. rule 2 prevents overestimation of epistasis due to low fitness of one of the two single substitutions. rule 3 prevents underestimation of epistasis due to low fitness of the double substitution. the fourier decomposition theorem states that the fitness function f ( z ) can be expressed as. f ( z ) = k f k ( - 1 ) z k (3) The formula for the Fourier coefficients f k is then: f k = 1 2 L z f ( z ) ( - 1 ) z k (4). fitness values for 10,639 variants (6.6% of the entire sequence space) were not directly measured (read count in the input pool = 0) or were filtered out because of low read counts in the input pool. we performed regularized regression on fitness values of observed variants. 149,361 variants with experimentally measured fitness values were non-lethal. out of the 149,361 variants with experimentally measured fitness values, 119,884 variants were non-lethal ( f > 0 ). we then used the fitted model to impute the fitness of the 10,639 missing variants and complete the entire fitness landscape. three models, namely the Greedy Model (de Visser and Krug, 2014), the Correlated Fixation Model (Gillespie, 1984), and the Equal Fixation Model (weinreich et al., 2006) were employed in this study to simulate the mutational steps in adaptive trajectories. the shortest path between a low-fitness variant and a high-fitness variant is inaccessible. if the length of the shortest path is larger than the genetic distance between two variants, adaptation requires indirect paths. sorted list was converted into a list of cumulative probabilities, which is denoted as ( A i j, 1, A i j, 2,... A i j, t ), where A i j, t = n = 1 t P i j, t. the probability of all possible mutational trajectories were sorted from large to small. extra-dimensional bypass is mediated by higher-order epistasis. f 000 = 0 f 001 = 0 + 1 f 010 = 0 + 2 f 100 = 0 + 3 f 011 = 0 + 1 + 2 + 12 f 101 = 0 + 1 + 3 + 13 f 110 = 0 + 2 + 3 + 13 f 110 = 0 + 2 + 3 + 13 f 110 = 0 + 2 + 3 + 13 f 110 for the scenario illustrated in (B), we have 100 101 : 1 + 13 > 0 (20) 100 110 : 2 + 23 > 0 (21) Combining inequality (14) and (20) gives 13 > 0 (22) Combining inequality (15) and (21) gives 23 > 0 (23) For the scenario in (C), the proof of higher-order epistasis is similar. LD, Analysis and interpretation of data, Drafting or revising the article. RS, Conception and design, Drafting or revising the article. Additional files Supplementary file 1. The fitness of each profiled variant. BI Gene Expression Omnibus (Accession no: PRJNA278685)."}