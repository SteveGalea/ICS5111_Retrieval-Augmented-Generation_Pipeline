{"summary": "single nucleotide polymorphism (SNP) and PCR-restriction fragment length polymorphism (PCR-RFLP) analyses across multiple isolate sequences of a species are described. PCR-RFLP analysis includes prediction and selection of optimal primers and restriction enzymes to enable maximum discrimination based on sequence information. software and source code for SPR Opt is publicly available and free for non-profit use at http://www.llnl.gov/IPandC/technology/softwaretitles/spropt.php. forensics and epidemiology is important in tracking the source of a pathogen, whether the disease is a naturally occurring outbreak or part of a criminal investigation. a full-genome analysis of sequence data could be used to classify an unknown isolate. the results could be available within hours, long before full sequence information becomes available. this requires a full knowledge of all the SNPs and fragment length polymorphisms that distinguish known isolates. SNP and PCR-RFLP solutions computed by the SPR Opt software include multiple loci when necessary for maximum sequence discrimination. both input sequences may also be referred to as genomes. a single polymorphic base surrounded by conserved sequence is specified by the user. conservation is required among the input sequences surrounding the variable site. a microarray with oligos chosen so that the central base is a SNP. if there is not a hybridization signal from any of the four oligos, then there may be a problem. if markers in the same haplotype are separated in the genome, it may indicate that a recombination event has occurred. if markers in the same haplotype are separated in the genome, it may indicate that a recombination event has occurred. however, the \"backend\" of this computational forensics pipeline depends only on the haplotypes. the application of SPR Opt is illustrated for two viruses for which multiple genomes are publicly available. the software and source code is publicly available and free for non-profit use at http://www.llnl.gov/IPandC/technology/software/softwaretitles/spropt.php. types lists the co-segregating SNPs or PCR-RFLPs that characterize each haplotype all_discriminating_sets for each genome. each row is a unique combination that has the best score found. each row is a unique combination that has the best score found, where the score is the number of haplotypes required. s No. Haplo-types No. Unresolved clusters Min. No. Assays Mumps 1,070 3,113 288 13 13 SARS 1,694 7,344 440 75 99 The number of combinations of Amplicon X Enzyme X Unique Fragment Length Distributions is summed over all variable amplicon, enzyme combinations in the PCR-RFLP analyses. polymorphisms in SARS and mumps viruses Enzyme SARS Mumps Enzyme SARS Mumps Tru9I 335 149 NciI 54 32 Hsp92II 320 98 EcoRV 52 36 Rsal 318 101 TthlllI 52 15 DdeI 317 104 EclHKI 52 11 Alul 270 135 Csp45I 51 29 Bsp1286I 227 48 Bbul 47 14 TaqI 213 121 PCR without digestion was adequate for genome discrimination. if only a small number of restriction enzymes are available, then analyses using SPR Opt indicate that SNPs outperform PCR-RFLP. in most cases, either SNPs or PCR-RFLPs can discriminate most genomes. if only the subset of SNPs determined to be optimal for forensic discrimination are queried, phylogenetic trees based on this information may not be representative of the true phylogenic relationships. if only the subset of SNPs determined to be optimal for forensic discrimination are queried, phylogenetic trees based on this information may not be representative of the true phylogenic relationships. a bioinformatic software called SPR Opt is described to optimize SNP and PCR-RFLP analyses in order to provide the maximum amount of genotyping information from the fewest possible assays. the software is described to optimize the selection of forensic markers to maximize information gained from the fewest assays. a consensus \"gestalt\" is automatically constructed from the multiple sequence alignment. conserved bases are indicated as letters (A, C, G, or T) and dots indicate positions where all input sequences do not agree. a polymorphic base differs in one or more of the input genomes. if a less restrictive definition of a SNP is required, it is possible to set either (but not both) min_len_downstream or min_len_upstream equal to 0, and thus pick up more regions. this might be a desired approach for the single base extension assay, since only conservation immediately 5' of the variable position matters. PCR-RFLPs A PCR-RFLP variation occurs if amplicons or fragments that result after restriction digest of such amplicons have a different length distribution among the input genomes. the fragments are generated by first determining amplicons in which the forward and reverse primers are conserved among the input genomes. restriction digest must differ in length among the genomes. a simple examination of the markers within a given haploblock should indicate those that query the same site as a result of using too small a value for the jump parameter. the largest value of jump that still provides the greatest discrimination among genomes may be selected from these fragments using MIT's primer3 software. num_restriction_enzymes = 1 can be digested by only one enzyme at a time. digestion of the original PCR products may be performed as long as each digestion is followed by its own fragment length measurement. the final solution guiding how to discriminate all input sequences may involve a number of different enzymes. the total number of SNPs is counted as the number of positions that are variable. for PCR-RFLPs, the software reports the number of unique combinations of primer pair sequences and restriction enzyme(s) that yield variation in fragment length distributions among the genomes. the second computation the software performs is to divide the SNPs into co-segregating groups called character haplotypes. the file genome_groups gives the associated genome groups. the software computes all sets of 1 or more character haplotype(s) that maximally discriminate each genome. each genome requires the testing of one or more polymorphic sites to pull it out from the other genomes. examining the intersections of all possible combinations of 3 genome groups requires 100C3 = 161,700 tests. we represent each genome group as a bit vector of 1's and 0's indicating the membership or exclusion of each of the genomes in that genome group. all genome groups containing only a single genome are reported. the number of genome groups making up all preliminary solutions for the specific genome A is a small subset of the total number of genome groups. this generates new solution sets, each of which contains more genome groups than the preliminary solution sets. each of these new solution sets for the given genome has an identical list of others(A), so that the index i may be dropped. the second step is computed automatically based on results of comparing others(A) with others(B) for all genomes A and B. in most cases, there are few enough genome groups to select a sufficiently large value of number_combinations_to_test to find optimal solution sets with the fewest possible genome groups for each genome. this is to exclude consideration of those genome groups with the fewest genomes from the combinatoric calculations. simulated annealing was used to search for approximately optimal solutions. the best score is the minimum number of haplotypes that must be examined. simulated annealing was used to find approximately optimal solutions. numbers given in the file all_discriminating_sets are not the same as the genome group or character haplotype numbers. simulated annealing predicted the true global optimum. the minimum length of conserved upstream and downstream bases was selected to be 7 because it enabled a finer level of genome discrimination than did 12-mers. newick trees were created using the neighbor program to generate the trees based on a distance matrix of pairwise distances between the genomes. for the multiple sequence alignment, the dnadist program using maximum likelihood was used to generate the distance matrix. the algorithm described below was validated by comparing the resulting phylogenetic tree with that created from a standard SNP matrix. phylogenetic trees (phylograms) were drawn using a web interface. a phylogenetic tree was also created in a similar manner to that described above. a phylogenetic tree was also created in a similar manner to that described above. SNPs A SNP is defined to be a single polymorphic base surrounded by conserved upstream sequence of length min_len_upstream bases. by conserved sequence, it is meant that the sequence is identical among all input genomes. a polymorphic base differs in one or more of the input genomes. min_len_upstream and min_len_downstream equal to 0, and thus pick up more regions, including those that may be the beginning of insertion/deletion variations among genotypes. if min_len_upstream and min_len_downstream are too short, then sequence surrounding the SNP is likely to be repeated within a given genome. fragments are generated by first determining amplicons in which the forward and reverse primers are conserved among the input genomes. restriction digest, the distribution of fragment lengths after cutting the amplicon with restriction enzymes must differ among the genomes. genomes are searched for an exact match to each primer pair on the plus and minus strands. those primer pairs are discarded in which one or both primers are absent from any of the genomes. in the analyses, it is assumed that any distance longer than 1200 bases is too long for amplification. num_restriction_enzymes = 2 or 3 is allowed. the software does not assess enzyme compatibility. the restriction enzymes to be considered are specified by the user. the parameters min_len_upstream and min_len_downstream are user-specified. the software finds SNPs using the conservation gestalt. in the conservation gestalt, any dot surrounded by at least min_len_upstream and min_len_downstream letters is a candidate SNP. a microarray chip platform using oligos of length 25 bases is to be used for the assay. setting min_len_upstream and min_len_downstream equal to 12 will predict 25-mers with the central base position the SNP. this software excludes degenerate bases indicated within a given genome from consideration as SNPs. sequence fragments that contain a PCR-RFLP marker are selected from the conservation gestalt. they are chosen to be just over the max_amplicon_length, to have at least one variable position. if jump is too large, the same insertion/deletion variation may be counted more than once if it is contained within more than one pair of primers. num_restriction_enzymes = 1 can be cut by 0, 1, 2 or 3 enzymes simultaneously. a given PCR product may be digested by only one enzyme at a time. if num_restriction_enzymes = 1, digestion is always done only with one enzyme at a time. the software is not implemented for non-palindromic restriction enzymes. the software is not implemented for non-palindromic restriction enzymes. the software calculates all SNPs or all PCR-RFLP sites. genome group identification number is the same as the character haplotype identification number. at each variable site, genomes are grouped by the marker identity. each genome contains at that locus, and the marker is stored in the character haplotype associated with that genome group. genome group 1 (associated with haplotype 1) contains genomes A, B, and C, and genome group 2 (associated with haplotype 2) contains genomes A and D. if in an unknown sample, one found a SNP that was included in haplotype 1 and another that was included in haplotype 2, then it would be concluded that the unknown sample was like A, and not B, C, or D. if the target in question cannot be uniquely discriminated, the most specific level to which it can be discerned is output. if there are many genomes and many genome groups, it may be necessary to take two additional steps to find the combinations to maximally discriminate sequences. this method is fast and does give a good solution in the many test cases examined. we repeat this procedure for all the genomes that cannot be uniquely discriminated. this generates final solution set(s) for each genome that may contain many more genome groups than the original combinatoric size number_combinations_to_test. if pare_groups = 1 then the algorithm finds the cutoff number of genomes per genome group below which there are genome groups that together contain all the input genomes. only the haplotypes that contain fewer than this cutoff number of genomes are considered in the combinatoric steps described above. simulated annealing was used to search for approximately optimal solutions. the best score is the minimum number of haplotypes that must be examined. many of these simulated annealing solutions are very similar to one another. genomes that co-segregate for a particular character haplotype are called the genome group. for easy association, the genome group identification number is the same as the character haplotype identification number. the algorithm to generate the list of character haplotypes and genome groups works in the following way: at each variable site, genomes are grouped by the marker identity. the third part of the software computes all sets of 1 or more character haplotype(s) that maximally discriminate each genome. each genome requires the testing of one or more polymorphic sites to pull it out from the other genomes. each solution set to resolve a given genome contains one to many haplotypes. fewer in which the bitwise AND (intersection) is a single genome. the maximum number of genome groups per combination is the parameter number_combinations_to_test. if there is not an intersection that contains uniquely the target genome, the most specific level to which it can be discerned is output. a second step is sometimes required to find maximum discriminating multi-locus combinations in situations with large numbers of genomes and genome groups. for genome B that is in the list of others(A), then one should be able to discriminate genome A to a higher level (with fewer others(A)) if more genome groups are included in the solution set, this method is fast and does give a good solution in the many tests examined. all solution sets for each genome are given in the file all_discriminating_sets. this is to exclude consideration of those genome groups with many genomes from the combinatoric calculations. this is an optional parameter pare_groups that can be set to 1. simulated annealing was used to search for approximately optimal solutions. the best score is the minimum number of haplotypes that must be examined. simulated annealing predicted the true global optimum. the minimum length of conserved upstream and downstream bases was selected to be 7 because it enabled a finer level of genome discrimination than did 12-mers. the maximum length of conserved bases was selected to be 7 because it enabled a finer level of genome discrimination than did 12-mers. shorter amplicons are allowed if longer ones cannot be found. phylogenetic trees were created using a web interface. a phylogenetic tree was created in a similar manner to that described above. a phylogenetic tree was created in a similar manner to that described above. a tree would represent a purported phylogeny if only the data from a set chosen for maximum forensic discrimination is used to predict phylogenetic relationships. a distance matrix was created from a traditional SNP matrix. in the SNP matrix, columns correspond to the SNPs and rows correspond to the isolates. en_downstream minimum length of conserved sequence downstream (3') of a SNP max_amplicon_length maximum amplicon length allowed for PCR-RFLP analysis are chosen by sliding a window along the consensus gestalt. each new window must start at least jump bases from the start of the previous window. precision there must be at least one difference in fragment lengths. there are a total of 27 files containing all the microbial forensic results and data described above. all are in text format, and can be found at http://est.llnl.gov/forensics."}