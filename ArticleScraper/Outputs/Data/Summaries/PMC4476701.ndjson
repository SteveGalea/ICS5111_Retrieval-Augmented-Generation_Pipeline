{"summary": "the decline in sequencing costs [1] now makes this technology broadly accessible. some recent viral discoveries have potential health and economic benefits. the use of NGS is not straightforward. problem with this approach is firstly the viral database used (1.2 million entries), which is heavily skewed towards a small number of viral species. the human reads in this study are artificially generated and subtracted against a dataset that was the source of the artificial reads themselves resulting in an unrealistic scenario. more rigorous algorithm comparisons have been focused on bacterial genome characterization. an assembly algorithm that is ideal for transcriptome assembly is often not suitable for genome assembly. a review of novel viral discovery literature and related pipelines has highlighted the need for improved testing of assembly algorithms. five Illumina Hi-Seq datasets derived from human liver tissue were used in this study. a database of 62 human virus chromatids from 35 distinct viruses were used to generate simulated Illumina read pairs (10x coverage depth) these paired reads (167,004) were combined with 16.7 million Illumina paired sequence reads from a \u2018clean\u2019 healthy liver sample. the greatest number of host sequence reads was subtracted through mapping to the human genome including the mitochondria (87.4 4.3%, arithmetic mean standard deviation) the use of both reference data sets was additive, with 89.2% of Illumina reads removed. also applied hostmapping subtraction to our rRNA references. the reads were assembled using four algorithms: Velvet [43], MetaCortex [44\u201345], ABySS [46] and CLC and a range of word sizes. the longest viral contigs assembled (as a % of the reference genome length) by each algorithm over a range of word sizes is shown in Fig 5. the largest viral contigs as a percentage of the reference viral genomes across the range of assemblers and datasets was -23% to +10.4% relative to assembled reads alone. pre-assembly host-mapping subtraction alone (0.7x and 9x deep viral coverage sets) resulted in changes to the total viral contig coverage of the reference across the range of -8.1% to +33.0% relative to assembly alone. k-mer filtering reduced the number of contigs assembled by 98.7\u201399.6%. k-mer filtering reduced the number of contigs assembled by 98.5\u201399.6%. the use of the low complexity filter alone reduced the total length of the reference genome covered and largest viral contig size by 32% and 52% respectively compared to assembly with no low complexity filtering. the combination of host mapping subtraction, k-mer filtering and low complexity filtering negatively affected the largest viral contig assembled. k-mer filtering (k-mer) / mapper subtraction (Map) and low-complexity filtering (LC) on post-assembly contig numbers. artificial viral Illumina read set embedded in Illumina reads derived from healthy liver total RNA. mean N90 values suggest large overlapping contigs without gaps. largest single contig range as a percentage of reference was 52.7% to 99.7%. largest single contig range as a percentage of reference was 76.5% to 99.9%. read subtraction filtering and optimal de novo assembly to idiopathic hepatitis liver samples were processed for total RNA and SISPA processed for Illumina NGS. sample 1 (121 million 100nt reads) and sample 2 (105 million reads 100nt reads) were filtered by the application of a short read mapper (Kontaminant) four viral hits were detected between the two idiopathic samples. a retrovirus\u2013like sequence with greatest homology to the SIV sequence. a herpes-like hit with greatest homology to the HHV4 sequence AJ507799 complete genome (171823nt) k-mer filtering (K-mer) & host mapping subtraction (Map) on viral contig number. k-mer similarity filtering (K-mer) & host mapping subtraction (Map) on viral contig size and reference coverage. the assembled contig numbers were 7563 / 42900 / 41957 respectively. the assembled contigs generated were aligned by us to the reference sequences to ascertain the largest contigs and the total reference coverage of all the assembled contigs. SURPI assembled largest contig was 2% of the reference and total reference coverage of all viral contigs assembled was 3.5%. this compares to 37% and 46% for our processes without k-mer filtering and with the addition of k-mer filtering. the most host sequence reads was subtracted through mapping to the human genome including the mitochondria (87.4 4.3%, arithmetic mean standard deviation) 89.2% of the host sequence reads were removed by mapping to the human rRNA data set alone. the GC % content profile of the viral reads that were filtered mirrored the unfiltered viral reads. mapping of the remaining (unfiltered) reads to the reference viral genomes revealed minimal gaps in coverage were present (0.6 0.6%) at the reference terminal ends only. tex and Abyss were generally less effective at the 200x deep viral coverage compared to the 20x coverage. the artificial viral sequence dataset was also assembled using CLC v6.5 with extensive testing of the word sizes revealing an optimal word size of 21. k-mer filtering alone resulted in changes in the total reference coverage of all assembled viral contigs. k-mer filtering reduced the number of contigs assembled by 98.7\u201399.6%. k-mer filtering reduced the number of contigs assembled by 98.5\u201399.6%. low complexity filtering combined with k-mer filtering resulted in a similar output to k-mer filtering alone. 0.7x and 9x viral coverage read sets did not include sequence reads spanning the 3\u2019 proximal homopolymeric T tract of HCV. the use of DUST resulted in up to 33.8% more contigs assembled. however, a small reduction in the number of assembled contigs (10%) was observed. low complexity filtering, k-mer filtering and low complexity filtering negatively affected the largest viral contig assembled. total reference coverage was comparable to assembly alone, the k-mer filtering and host mapping subtraction alone. contigs with greater than 90% homology to a viral reference genome were extracted from the assembled contigs and sorted by viral reference and percentage reference coverage. the mean reference coverage of the single largest contigs to each viral reference following assembly only was 86.3% 19.7% (arithmetic mean SD) the largest single contig range as a percentage of the reference was 76.5% to 99.9% for the host-mapping subtracted set. for the k-mer filtered set, the largest single contig range as a percentage of the reference was 32.1% to 99.8% again with the exception of the herpes 1, herpes 8 and Vaccinia virus contigs. two human hepatitis liver samples clinically defined as idiopathic (explanted liver from the transplant setting) were processed for total RNA and SISPA processed for Illumina NGS. sample 1 (121 million 100nt reads) and sample 2 (105 million reads 100nt reads) were filtered by the application of a short read mapper, with and without the application of the k-mer filter (Kontaminant) four viral hits were detected between the two idiopathic samples. a retrovirus\u2013like sequence with greatest homology to the SIV sequence U42720 complete cds. a herpes-like hit with greatest homology to the HHV4 sequence AJ507799 complete genome. -mer filtering (K-mer) & host mapping subtraction (Map) on viral contig size and reference coverage. -mer filtering (K-mer) followed by the 2 low coverage real HCV datasets. the assembled contigs generated were aligned by us to the reference sequences to ascertain the largest contigs and the total reference coverage of all contigs. k-mer filter tool results in a still superior 80.6% mean and a lower range of 5.5% with an SD of 25.9. analysis of contigs generated from the very low coverage (0.7%) dataset, the SURPI assembled largest contig was 2% of the reference and total reference coverage of all viral contigs assembled was 3.5%. this compares to 37% and 46% for our processes without k-mer filtering and with the addition of k-mer filtering. we first characterized NGS read reduction potential using two distinct approaches. k-mer filtering and de novo assembly settings were then applied to our five data sets. post-assembly analysis suggests host read mapping subtraction did not compromise, in some cases significantly improved, the likelihood of assembling longer viral contigs. we used the contaminant removal software (Kontaminant) to reduce the number of contigs assembled. the maximum viral contig sizes as a percentage of the viral references were generally reduced relative to identical sets that were not filtered using Kontaminant. however, post-assembly, the maximum viral contig sizes were generally reduced relative to identical sets that were not filtered using Kontaminant. the use of the PIRS software will not introduce the same level of sequence bias that may be seen with randomly amplified nucleic acids. the application of the optimized mapping subtraction protocol and k-mer filter (Kontaminant) to our idiopathic hepatitis liver samples shows post-assembly data that is consistent with our viral control and artificial datasets. stringencies defined to maximize subtraction of host can then be applied to the novel sequence datasets to provide a reduced set that significantly improves the subsequent assembly of viral contigs. step 2 entails the use of a k-mer frequency filtering system (Kontaminant) in order to remove most of the remaining host reads. the overall dramatically reduced set is small enough to directly use BLASTn and even tBLASTx to a complete NCBInt database. two liver samples naturally infected with HCV and HBV viruses were used in this study. total extracted RNA and cytosolic viral particle enriched fractions (for each sample) were prepared using the SISPA protocol and sequenced using the Illumina platform. quality control analysis revealed sequence read level (arithmetic mean) PHRED score averages of over 40 for all sets, with no single read mean PHRED score less than 30. de novo assembly algorithms The HCV and HBV sets (0.7x\u2013200x viral coverage) were used in the first instance to ascertain optimal word size values with four assembler algorithms. Velvet 1.1.04 [43], MetaCortex 0.1 [44\u201345], ABySS 1.3.4 [46] and adeno-associated_virus_1, group II, NC_002077.1. human_ parvovirus_B19, group II, NC_000883.2. Torque_teno_virus group II, NC_015783.1. human liver sample total RNA Illumina hi-Seq FASTQ data set was used to train the software to modify viral genome sequences. the viral read sequences were pIRS selected to match the clean liver reads including the mean paired distance at 327.96nt with an SD of 77.1. the different viral coverage data sets were then embedded into 17,200,000 paired-end reads from the healthy liver FASTQ set used to \u2018train\u2019 the pIRS software. the largest viral contigs and total reference coverage of all contigs was optimal at a word size of 21 for all the datasets. pIRS generated viral metagenomics data set embedded in total RNA derived non-infected liver Illumina paired-end reads was used to determine the percentage subtraction of host and viral sequence reads. the artificial, pIRS generated viral metagenomics data set embedded in total RNA derived non-infected liver Illumina. the mitochondrial consensus is not included in the GRC human build 37. the four cytoplasmic rRNA molecules (non-MT encoded) are included separately due to the presence of the spacer DNA in the genomic sequence. k-mer filtering was carried out using the freely available Kontaminant tool. low complexity filtering was performed using mdust [47], a standalone version of the DUST module from BLAST. Default settings were used: maximum word size of 3 and cutoff of 28. the nucleotide sequences of all the resulting viral contigs deviated from the reference by less than 1%. standard N25-N90 values used (defined as the smallest contig of a minimal set of contigs required to achieve coverage of the viral reference indicated, expressed as a % of the reference coverage) matching query sequences from each sample were collated and mapped to the best-hit reference to determine percentage coverage of each contig and total coverage of the reference. smaller contigs outside of the filtering strategy were then categorised by aligning all the assembled contigs to the references. ethics service, Cambridge 3 Research Ethics Committee, Cambridge CB21 5XB (REC reference numbers 09/HO306/52, 09/HO306/60) and Kings College Hospital Research Ethics Committee, London SE5 9RS (REC reference number 04/Q0703/27). liver samples naturally infected with HCV and HBV viruses together with an uninfected \u2018healthy\u2019 liver sample were used in this study. quality control analysis revealed sequence read level (arithmetic mean) PHRED score averages of over 40 for all sets, with no single read mean PHRED score less than 30. de novo assembly algorithms The HCV and HBV sets (0.7x\u2013200x viral coverage) were used in the first instance to ascertain optimal word size values with four assembler algorithms. Velvet 1.1.04 [43], MetaCortex 0.1 [44\u201345], ABySS 1.3.4 [46] and adeno-associated_virus_1, group II, NC_002077.1. human_ parvovirus_B19, group II, NC_000883.2. Torque_teno_virus group II, NC_015783.1. human liver sample total RNA Illumina hi-Seq FASTQ data set was used to train the software to modify the viral genome sequences. the viral read sequences were pIRS selected to match the clean liver reads including the mean paired distance at 327.96nt. Optimal word size assembly was determined with the use of CLC Bio assembler v6.1, (Arhus, Denmark) the largest viral contigs and total reference coverage of all contigs was optimal at a word size of 21 for all the datasets (0.5, 1, 2, 5, 10 and 100x coverage data sets) the artificial, pIRS generated viral metagenomics data set embedded in total RNA derived non-infected liver Illumina paired-end reads was used to determine the percentage subtraction of host and viral sequence reads. the pIRS generated viral metagenomics data set embedded in total RNA derived non-infected liver Illumina. the mitochondrial consensus is not included in the GRC human build 37. the four cytoplasmic rRNA molecules (non-MT encoded) are included separately. k-mer filtering was carried out using the freely available Kontaminant tool. low complexity filtering was performed using mdust [47], a standalone version of the DUST module from BLAST. Default settings were used: maximum word size of 3 and cutoff of 28. the nucleotide sequences of all the resulting viral contigs deviated from the reference by less than 1%. standard N25-N90 values used (defined as the smallest contig of a minimal set of contigs required to achieve coverage of the viral reference indicated, expressed as a % of the reference coverage) matching query sequences from each sample were collated and mapped to the best-hit reference to determine percentage coverage of each contig and total coverage of the reference. idiopathic samples showed viral hits to two distinct viral families only (U42720, AY232737 and AF345527, AJ507799 respectively)."}