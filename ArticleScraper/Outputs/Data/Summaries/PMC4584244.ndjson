{"summary": "in 1995, haemophilus influenza was the first free-living organism to have its genome completely sequenced. this took about a year to finish the 1.8 Mb genome using conventional shotgun Sanger sequencing. the development of high throughput Next Generation Sequencing platforms has led to a rapid increase in genomes available. a complex series of susceptibility testing workflows are undertaken. the whole process can take several days to weeks. PCR assays have been designed to detect specific pathogens from clinical sample specimens. a metagenomic analysis pipeline was built using benchtop technology to provide realistic sequencing depths. a reagent containing a mixed population of 25 known viruses [34] was stored at 80\u00b0C in 100 L aliquots. the supernatant was retained for generation of separate DNA and RNA libraries. the DNA library used supernatant from one 100 L aliquot extracted using the PureLink Viral RNA/DNA kit (Life Technologies-Invitrogen) according to manufacturer's instructions, with the exception that 10 g of linear polyacrylamide (LPA) was used instead of the supplied carrier RNA provided to aid with nucleic acid precipitation. nucleic acids were eluted in 15 L of nuclease-free water. DNA and cDNA libraries were prepared using the Nextera XT library preparation kit (Illumina) to homogenise the faeces, 2 mL of 1x PBS and 1 mL of 2% 2-mercaptoethanol were added to aid in dissolution of cells. the homogenised faeces were transferred to a 50 mL falcon tube and centrifuged at 3,000 g for 10 minutes. the cells were spun at 12,000 g for 2 minutes and supernatant was removed. the pellet was resuspended in 100 L of a DNase I. inactivation was performed by incubation at 75\u00b0C for 30 minutes. Quality Filtering and Removal of Host Sequences Filtering of PE reads consisted of read inspection, trimming of adapter and poor quality bases. key quality control metrics were calculated using FastQC (v0.11.2) [36], and Trimmomatic (v0.32) [37] was used to remove potential adapter contamination and poor quality reads. Species Identification Targeted detection of the 25 viruses within the viral sample was based on the metagenomic binning tool BBSplit (v33) an index of 25 respective viral genomes sequences was used as references. an index of 25 respective viral genomes sequences was used as references. the average blast loge-value of the contigs was used to colour the taxa within Krona. a custom database was built for Kraken using RefSeq (version 66) complete bacteria (3,471 genomes), virus (4,121 genomes), and Archaea (307) genome sequences. Viral RNA/DNA kit (Life Technologies-Invitrogen) according to manufacturer's instructions. 10 g of linear polyacrylamide (LPA) was used instead of supplied carrier RNA. nucleic acids were eluted in 15 L of nuclease-free water. 440 mg of porcine faeces were thawed at room temperature for 1 hour before use. 2 mL of 1x PBS and 1 mL of 2% 2-mercaptoethanol were added. samples were placed on a rotator for 2 hours. centrifugation and washing were repeated and the pellet was resuspended. the pellet was resuspended in 100 L of a DNase I. inactivation was performed by incubation at 75\u00b0C for 15 minutes. cells were centrifuged at 12,000 g for 2 minutes and supernatant was removed. key quality control metrics were calculated using FastQC (v0.11.2) [36], and Trimmomatic (v0.32) [37] was used to remove potential adapter contamination and poor quality reads. Default parameters were used except for those detailed above. Species Identification Targeted detection of the 25 viruses within the viral sample was based on the metagenomic binning tool BBSplit (v33), which uses BBMap for mapping. Default mapping parameters were used except for minratio 0.56, minhits 1 and maxindel 16000. a custom database was built for Kraken using RefSeq (version 66) complete bacteria (3,471 genomes), virus (4,121 genomes), and Archaea (307) genome sequences. a total of 8,040 genomes were for classification by Kraken. nonhuman model sample was sequenced as two technical replicates within a single MiSeq run. the viral sample was expected to harbour a complex mixture of taxa at a range of abundances. the viral sample was split over two indexed libraries. 0.0 Coxsackievirus B4 7,397 30.72 20,706 0.2 14,422 0.1 Cytomegalovirus 230,290 28.95 580,431 5.2 584,018 5.2 Epstein-Barr virus 171,823 31.27 43,600 0.4 43,882 0.4 Herpes simplex virus 1 152,261 30.59 10,189 0.1 10,220 0.1 Herpes simplex virus 1 152,261 a bioinformatic pipeline was constructed to address the questions set out by this study. the \u201cknowns\u201d approach used the composition of the viral dataset to bin sequence reads simultaneously by mapping to reference sequences of the expected 25 viruses in a targeted approach. the targeted approach has four stages. a targeted mapping approach was not possible for the nonhuman model dataset. a fast classification pipeline was built around a recent kmer classification method, Kraken [14], and using a database of just over 8,000 genomes. this approach took 30 min following QC to complete mapping and reporting. the kmer-based method was highly similar to the mapping approach based on the number of reads classified to each virus (Pearson's r = 0.98), with 57.3% (6.5 M reads) and 43.0% (4.8 M reads) of the QC passed reads classified to the target viruses. the whole process took just over 1 hour to report the results, with the classification of the 11.3 M input reads only taking 23 minutes. over half of the reads mapping to the contigs were identified as the target viruses (0.9 M reads) most of the nontarget taxa belonged to bacterial species (0.5 M reads), including the families Enterobacteriaceae and Pseudomonadaceae, such as Escherichia coli. in total 2.8 M reads (24.2%) were classified. this dropped to 146 species if only those above 0.1% abundance levels were included. 5 genera accounted for 70.1% of the classified reads. reads were mapped against a reference genome of the most abundant strain within the respective species identified. Species identified (strain name) Mapped reads Bases (Mb) Depth of coverage (bp) Genome coverage (%) Lactobacillus reuteri (5007) 983,484 457.1 234.7 98.6 Lactobacillus johnsonii (DPC_6026) 51,947 24.2 12.3 87.8 Lactobacillus the number of reads generated or alternative library normalisation methods are required to provide better capture of the genome sequences within the metagenomic samples. the number of sequences surviving the common preprocessing stages are shown. adenovirus types 2 and 41 and parainfluenza virus types 1\u20134 were generated from porcine faeces to represent an \u201cunknowns\u201d sample. the viral sample was split over two indexed libraries, as separate DNA and RNA libraries were generated to enable capture of the two viral types. 7,397 30.72 20,706 0.2 14,422 0.1 Cytomegalovirus 230,290 28.95 580,431 5.2 584,018 5.2 Epstein-Barr virus 171,823 31.27 43,600 0.4 43,882 0.4 Herpes simplex virus 1 152,261 30.59 10,189 0.1 10,220 0.1 Herpes simplex virus 2 154,675 32.48 36,786 0.3 36 a bioinformatic pipeline was constructed to address the questions set out by this study. the \u201cknowns\u201d approach used the composition of the viral dataset to bin sequence reads simultaneously by mapping to reference sequences of the expected 25 viruses in a targeted approach. a targeted mapping approach was not possible for the nonhuman model dataset. a fast classification pipeline was built around a recent kmer classification method, Kraken [14], and using a database of just over 8,000 genomes. this approach took 30 min following QC to complete mapping and reporting. the kmer-based method was highly similar to the mapping approach based on the number of reads classified to each virus (Pearson's r = 0.98), with 57.3% (6.5 M reads) and 43.0% (4.8 M reads) of the QC passed reads classified to the target viruses for the mapping and kmer approaches. the whole process took just over 1 hour to report the results. over half of the reads mapping to the contigs were identified as the target viruses (0.9 M reads) most of the nontarget taxa belonged to bacterial species (0.5 M reads), including the families Enterobacteriaceae and Pseudomonadaceae, such as Escherichia coli. in total 2.8 M reads (24.2%) were classified. this dropped to 146 species if only those above 0.1% abundance levels were included. 5 genera accounted for 70.1% of the classified reads. bacillus was the most dominant genus identified within the nonhuman model dataset. reads were mapped against a reference genome of the most abundant strain within the respective species identified. preprocessing is another source of sequence loss, resulting in 2.3 M reads (16.8% of raw reads) and 1.2 M reads (9.6% of raw reads) being discarded. the number of sequences surviving the common preprocessing stages are shown. classified sequences are based on the targeted then assembly approach within the viral dataset. storage (in GB) consists of all fastq and intermediate files including bam and bed format files, generated throughout the analysis. the study demonstrates that it is now possible to build a diagnostic pipeline that takes raw sequence reads and provides a comprehensive bacterial and viral identification of clinically relevant samples within a few hours."}