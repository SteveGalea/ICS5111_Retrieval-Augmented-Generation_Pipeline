{"summary": "an estimated 17% of cancers worldwide are associated with infectious causes. these infectious agents include viruses, bacteria, parasites and other microbes. epstein-Barr virus (EBV) in nasopharyngeal cancer. there are several challenges in detection of viruses in tumors. the extent and biological significance of viral presence/infection is generally unknown but could be measured using human transcriptome data from tumor samples. the popularity of next-generation sequencing (NGS) technology has exploded in the last decade. in recent years, US regulators approved a viral based cancer therapy (Ledford, 2015), proving that the study of viruses in the human transcriptome has biomedical interest. we present our pipeline viGEN to detect and quantify read counts at the individual viral-gene level, but also detect viral variants from human RNA-seq data. the characterization of viral variants helps enable better epidemiological analysis. a publicly available RNA-seq sample from an HBV liver cancer patient from NCBI SRA. we also provided step-by-step instructions on how to run our viGEN pipeline on this sample data, along with the code at https://github.com/ICBI/viGEN/. this allows other users to apply this pipeline to explore viruses in their data and disease of interest. yes No Both No Yes Can be applied to samples infected with undiagnosed viruses PathSeq (Kostic et al., 2011) Yes No RNA-seq No No Generates contigs with these non-human sequences Kraken (Wood and Salzberg, 2014) Yes No No Metagenomic analysis tool viGEN (our pipeline) one of the outputs of RSEM includes sequences that did not align to the human genome (hence the name \u201cfiltered human sample input\u201d). these un-aligned sequences were taken and aligned to the viral reference file using popular alignment tools BWA. a d e n g t h G e n o m e l e n o m e l e n g t h only those viral species with copy number more than a threshold are selected for the next module. our in-house algorithm used region-based information from the general-feature-format (GFF) files5 of each viral genome. the Viral reference file was created from combining all known and sequenced human viruses obtained from NCBI2. variant calling tool Varscan2 allows detection of low-frequency variants. variants were flagged, but not filtered out, in case these low values were due to low viral load. the dataset consisted of 50 HBV Liver cancer patients, and 5 adjacent normal liver tissues. we downloaded the raw reads for one sample, and applied our viGEN pipeline to it. we first applied the viGEN pipeline on the 50 samples using the Globus Genomics platform. the viGEN pipeline includes 4 major modules. each module has a color, shown in the legend. one of the outputs of RSEM includes sequences that did not align to the human genome (hence the name \u201cfiltered human sample input\u201d). these un-aligned sequences were taken and aligned to the viral reference file using popular alignment tools BWA. d l e n g t h G e n o m e l e n o m e l e n g t h Only those viral species with copy number more than a threshold are selected for the next module. module 3 calculated quantitate read counts at the individual viral-gene level. the Viral reference file was created from combining all known and sequenced human viruses obtained from NCBI2. variant calling tool Varscan2 allows detection of low-frequency variants. variants were flagged, but not filtered out, in case these low values were due to low viral load. genome level counts were calculated using idxstats or Picard BAMIndexStats4 tools. we estimated the number of reads that covered the genome. only those viral species with copy number more than a threshold are selected. the source code for our in-house algorithm, written using the R programming language, has been made public at available at github.com/ICBI/viGEN. the source code for our in-house algorithm, written using the R programming language, has been made public. the in-house algorithm, along with a tutorial on how to execute the code on sample data has been made public at https://github.com/ICBI/viGEN/. we chose one sample (SRR1946637) from publicly available HBV liver cancer RNA-seq dataset from NCBI SRA. 304 cervical cancer patients had virus detection confirmed by PCR or other lab methods. 22 patients had virus detection confirmed by PCR or other lab methods. we then applied the viGEN pipeline on the 50 samples using the Globus Genomics platform. cox proportional hazards (Cox PH) regression model was applied on all 50 samples in the cohort (i.e., 25 Hep B and 25 HepB+HepC) samples to maximize power. we also compared dead and alive samples at the viral RNA variant level in the HepB group using a tool called PLINK. genomes were detected, we then chose only the high abundance viral species for the gene quantification step and viral variant detection steps. we then performed a focused analysis on the viral-gene expression read counts, to examine the differences between \u201cDead\u201d and \u201cAlive\u201d samples. out of 25 HepB patients, 16 were alive (baseline group), and 9 dead (comparison group) as per the clinical data. the threshold copy number limit that defines a \u201cpositive\u201d detection is one of the parameters of the software which could be set by the user depending on the specifics of the experiment. 22 patients had virus detection confirmed by PCR or other lab methods. high abundance was defined as those virus species detected in at-least 5 samples. a complete list is provided in Table 3. Table 3. Virus species detected in at-least 5 samples. log counts per million (logCPM) P-Value Q-Value (FDR) Name of virus Region annotation A NC_003977.1_gene_1814_2452 1.128 13.449 1.71E06 0.000243 Hepatitis B virus Contains Gene C that produces pre-code protein external core antigen. HBeAg is produced by proteolytic processing of the pre-core protein. 2.75 11.741 5.84E22 6.20E19 Hepatitis B virus Encodes Gene S that produces a large surface protein/L glycoprotein/L-HBsAG NC_003977.1_CDS_2848_4050 2.75 11.741 5.84E22 6.20E19 Hepatitis B virus Encodes Gene S that produces small envelope protein, S protein; S-HBsAg, B NC_001405.1_intron_9724_12307 2.527 human endogenous retrovirus K113 Sequence-tagged site (STS), locus_tag = Q779_gp1, standard_name = D22S1651, UniSTS: 474031 NC_022518.1_STS_5100_5381 1.051 9.532 0.000118 0.0139 Human endogenous retrovirus K113 gag-pro-pol. Table 4A shows transcript level read counts in the Hepatitis B virus. Table 4B shows transcript level read counts in other species. a region of the Hepatitis B genome that produced the HBeAg and HBcAg proteins were overexpressed in the dead patients. survival analysis (cox regression) using viral gene expression data Based on the results from previous section, we selected two most informative regions from the Hepatitis B genome. the results from this model are consistent with the results from differential expression analysis. cox PH model shows that assuming other covariant to be constant, unit increase in expression of this region NC_003977.1_CDS_1814_2452, increases the hazard of event (death) by 43%. overall model is significant with p-value 0.05 from the Log rank test (also called Score test) we compared the dead and alive samples at the viral-variant level on the 25 HepB patients. most of the top variants from filtered human sample (Module 1 + Module 4) and unfiltered human sample (Module 2 + Module 4) were the same. gi|21326584|ref|NC_003977.1| Hepatitis B virus 2651 T 4 0 C 0.00476 product = polymerase, gi|21326584|ref|NC_003977.1| Hepatitis B virus 2813 C 2 0 T 0.03571 protein_id = NP_647604.2 gi|21326584|ref|NC_003977.1| Hepatitis B gi|21326584|ref|NC_003977.1| Hepatitis B virus 126 C 2 0 T 0.02222 Is_circular = true, gbkey = Src, genome = genomic DNA, strain = ayr gi|21326584|ref|NC_003977.1| Hepatitis B virus 1762 T 0 4 A 0.06061 Gene = X, Name = NP_647606.1, two missense variants were common among the top results, but not significant. a few variants of the human endogenous retrovirus K113 complete genome (HERV K113) were also common. sensitivity of 83% and specificity of 60% for HPV-16 detection. sensitivity of 75% and specificity of 94% for HPV-18 detection. PCR or other lab techniques for screening viruses. Virus species detected in at-least 5 samples. name of Virus Hepatitis C virus Tick-borne encephalitis virus. Contains Gene C that produces pre-code protein external core antigen. 0.053928 Hepatitis B virus Encodes Gene S that produces small envelope protein, S protein; S glycoprotein; S-HBsAg, NC_003977.1_gene_2307_4838 2.133 12.655 2.61E15 1.11E12 Hepatitis B virus Gene P, encodes protein P NC_003977.1_CDS_2307_4838 2.133 12.655 2.61E15 1.11E12 Hepatitis B virus Gene P, protein, S protein; S glycoprotein; S-HBsAg, B NC_001405.1_intron_9724_12307 2.527 6.463 4.02E08 1.22E05 Human mastadenovirus C Gene = L1, locus_tag = HAdVC_gp10, note = precedes capsid protein precursor pIIIa CDS NC_001405.1_intron_9724_11039 2.5 6.451 6.65E08 1.28E05 Human masta a region of the Hepatitis B genome that produced the HBeAg and HBcAg proteins were overexpressed in the dead patients. a region of the Hepatitis B genome that produced the HBeAg protein was overexpressed in the dead patients. region contains pre-core protein Region NC_003977.1_CDS_1901_2452. this region encodes a different core antigen HBcAg. this region encodes a different core antigen HBcAg. cox proportional hazard survival analysis (across 25 HepB samples and 25 HepB + HepC Samples) n = 37, number of events = 5 (13 observations deleted due to missingness) n = 37, number of events = 5 (13 observations deleted due to missingness) cox PH model shows that assuming other covariant to be constant, unit increase in expression of this region NC_003977.1_CDS_1814_2452 increases the hazard of event (death) by 70%. overall model is significant with p-value 0.05 from the Log rank test (also called Score test) nucleotide 1479), Gene P (2573, 2651, 2813) and preS1 region (nucleotides 2990, 2997, 3105, 3156) all these variants were found mutated more in the cases than controls. other significant common results included variants in Gene C (nucleotide 1979, 2396) and variants in PreS2 region (nucleotide positions 115, 126 and 148). i|21326584|ref|NC_003977.1| Hepatitis B virus 2997 C 2 0 T 0.03571 protein_id = NP_647604.2; gi|21326584|ref|NC_003977.1| Hepatitis B virus 3105 C 2 0 A 0.02222 Gene = S, product = large envelope gi|21326584|ref|NC_003977.1| Hepatitis gene = X, Name = NP_647606.1, product = X protein, gi|21326584|ref|NC_003977.1| Hepatitis B virus 1764 A 0 4 G 0.06061 protein_id = NP_647606.1 B gi|548558394|ref|NC_022518.1| Human endogenous retrovirus K113 7476 0 10 14 TACTG 0.00600 ID = gene0 Detection of hepatitis B virus at the genome level We applied our viGEN pipeline (modules 1 and 2) on the RNAseq data from the TCGA liver cancer tumors. we obtained genome-level read counts for each viral species. high abundance was defined as those virus species that were detected in at-least 5 samples. Table 4A lists only the differentially expressed regions from other viruses. Table 4B shows the differentially expressed regions from other viruses. 11E12 Hepatitis B virus Gene P encodes protein P NC_003977.1_CDS_3205_4050 2.352 8.67 1.93E12 6.84E10 Hepatitis B virus Gene S. encodes middle envelope protein pre-S2/S NC_003977.1_gene_2848_4050 2.75 11.741 5.84E22 6.20E19 Hepatitis B virus Encodes Gene S that produces a large surface protein/L glycoprotein 02 NC_001405.1_transcript_10866_11023 2.5 6.451 6.65E08 1.28E05 Human mastadenovirus C Gene = VAII, locus_tag = HAdVC_gs02, GeneID:2653002 NC_001405.1_exon_10866_11023 2.5 6.451 6.65E08 1.28E05 Human mastadenovirus C Gene = VAII, locus_tag = HAdVC_gs02, 002645.1_gene_293_20568 2.598 6.126 3.93E05 0.004911 Human coronavirus 229E locus_tag = HCoV229Egp1, GeneID: 918764, replicase polyprotein 1ab These results shown used the viral-gene data obtained from Module 1. Table 4A shows transcript level read counts in the Hepatitis B virus while Table 4B shows transcript level read counts in other species. we also found several regions of the human endogenous retrovirus K113 (HERV K113) viral genome to be about 2 times overexpressed on average in alive patients. survival analysis (cox regression) using viral gene expression data Based on the results from previous section, we selected two most informative regions from the Hepatitis B genome. 003977.1_CDS_2848_4050 0.5742 1.7415 0.1337 2.465 NC_003977.1_CDS_1814_2452 0.6993 0.5885 0.5096 5.667 Concordance = 0.654 (max possible = 0.188) Likelihood ratio test = 4.74 on 2 df, p = 0.09343 Wald test = 0.75 on 2 df, p = 0.6856 Score (logrank) test = 10. the overall model is significant with p-value 0.05 from the Log rank test. we performed variant calling (Module 4) on the 25 HepB patients. most of the top variants from filtered human sample (Module 1 + Module 4) were the same. gi|21326584|ref|NC_003977.1| Hepatitis B virus 1479 C 4 0 A 0.02857 Gene = X, product = X protein, protein_id = NP_647606.1 gi|21326584|ref|NC_003977.1| Hepatitis B virus 2573 C 0 6 T 0.03571 Gene = P, gi|21326584|ref|NC_00 96 0 4 0 CG 0.01499 protein_id = YP_355335.1, NP_647607.1 gi|21326584|ref|NC_003977.1| Hepatitis B virus 115 C 2 0 A 0.02222 Pre S2 region, ID = id0, Dbxref = taxon: 10407, gi|21326584|ref|NC_003977.1| He ous retrovirus K113 8086 T 3 0 C 0.00714 protein_id = YP_008603282.1 Table 6A shows variants in the Hepatitis B virus only while Table 6B shows variants in other species. there were two missense variants that were common among the top results, but not significant (p-value = 0.06) the viGEN pipeline was able to match the sensitivity and specificity of Centrifuge tool and surpassed that of Kraken. the virus was detected in 20% of the samples. the viral gene X (HBx) was the most predominately expressed viral gene. the highest levels of HBsAg in the virus are known to occur in the \u201cimmunotolerant phase\u201d. the highest levels of HBsAg in the virus are known to occur in the \u201cimmunotolerant phase\u201d. the human endogenous retrovirus K113 (HERV K113) genome was overexpressed in the alive patients. the third region was in the gag-pro-pol region that has frameshifts. mutations in 1762/1764 positions of the X gene are known to be associated with greater risk of HCC. this mutation combination is also known to be associated with acute-on-chronic liver failure. it is predicted that mutations associated with HCC variants are likely generated during HBV-induced pathogenesis. our viGEN pipeline is dependent on sequence information from reference genome. this makes it challenging to detect viral strains where reference sequence information is not known. this makes it challenging to detect viral strains where reference sequence information is not known. the same cohort of TCGA patients shared the results with us. they used an abundance of 0.02 as a positive viral detection. the results are in the same range for all three tools. the viral gene X (HBx) was the most predominately expressed viral gene in liver cancer samples. a region of the Hepatitis B genome that produced the HBeAg protein was overexpressed in the dead patients. this means the person infected with the virus can likely transmit the virus on to another person. the highest levels of HBsAg in the virus are known to occur in the \u201cimmunotolerant phase\u201d. this pattern is seen in patients who are inactive carriers of the virus. the virus has been in the host for so long, that the host does not see the virus as a foreign protein in the body. mutation in the 2396 position lies in a known CpG island (ranging from 2215 to 2490), whose methylation level is significantly correlated with hepatocarcinogenesis. Mutations in preS2 are associated with persistent HBV infection and emerge in chronic infections. studies have shown a strong association between HERV-K antibodies and clinical manifestation of disease and therapeutic response. it is hypothesized that retroviral gene products can be \u201creawakened\u201d when genetic damage occurs through mutations, frameshifts and chromosome breaks. the highest levels of HBsAg in the virus are known to occur in the \u201cimmunotolerant phase\u201d. the virus has been in the host for so long, that the host does not see the virus as a foreign protein in the body. the gene C region creates the pre-capsid protein, which plays a role in regulating genome replication. the mutation in the 2396 position lies in a known CpG island (ranging from 2215 to 2490) studies have shown that this envelope protein mediates infections of cells. HERV K113 is a provirus and is capable of producing intact viral particles. it has shown potential as diagnostic or prognostic biomarkers and for immunotherapeutic purposes including vaccines. viGEN pipeline can thus be used on cancer and non-cancer human NGS data to provide additional insights into the biological significance of viral and other types of infection in complex diseases, and tumorigeneses. results show that it is possible to detect viral sequences from whole-transcriptome (RNA-seq) data in humans. the data can be obtained from https://cancergenome.nih.gov/. the authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest. Supplementary material The Supplementary Material for this article can be found online at https://www.frontiersin.org/articles/10.3389/fmicb.2018.01172/full#supplementary-material Additional File 1 viGEN Github tutorial."}