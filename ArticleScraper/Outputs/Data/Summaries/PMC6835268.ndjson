{"summary": "Metabolomics aims to measure, identify and (semi-)quantify a large number of metabolites in a biological system. the methods of choice are generally Nuclear Magnetic Resonance (NMR) spectroscopy or Mass Spectrometry (MS) the latter can be used directly (e.g., direct infusion MS), but is normally coupled to a separation system such as Gas Chromatography (GC-MS), Liquid Chromatography (LC-MS) or Ca many tools and methods have been developed to facilitate the processing and analysis of metabolomics data. most seek to solve a specific challenge in the multi-step data processing and analysis workflow. we have included packages even if they are not anymore part of current CRAN or Bioconductor. in untargeted metabolomics, the selected features contain only the characteristics (e.g., m/z, retention time, chemical shift, intensity) obtained from the measurement, but not the metabolite identification or chemical structure as such. large parts of the metabolomics software landscape in general have been covered in reviews, recent ones include the large list of software packages. this review will focus on the ecosystem of R packages for metabolomics. it provides an overview of packages to carry out one or multiple of the above-mentioned steps. some aspects are not covered in depth or not at all. the bioconductor project (BioC for short) was started by a team around Robert Gentleman in 2001 [17] and has become a vibrant community of around 1000 contributors. each package has a landing page pointing to sources, build information, binary packages and documentation. each package has a landing page pointing to sources, build information, binary packages and documentation. the non-profit initiative rOpenSci maintains an ecosystem around reproducible research, including staff and community-contributed R packages with additional peer review. the GitHub (and also GitLab, Bitbucket) hosting services are not specific to R development. useR!2015 and JSM2015 conferences showed the analysis of the CRAN and BioC dependency network structure [23,24,25] we repeated such an analysis with the packages mentioned in this review and created a network of reverse dependencies. green nodes correspond to packages in CRAN or BioC not covered in the review. the first step for any metabolomics study is conversion from vendor formats into open data formats and pre-processing of the obtained raw data. the latter entails converting chromatographic (usually hyphenated to MS) or spectroscopic data into a data matrix suitable for data analysis. the final matrix will have samples in one dimension and so-called features (unique chromatographic features or spectral bins) in the other dimension. large parts of the metabolomics software landscape in general have been covered in reviews. recent ones include the large list of software packages [8] first described by Spicer et al. [9] and a series of annual reviews covering the list maintained by Misra and others. this review will focus on the ecosystem of R packages for metabolomics. some aspects are not covered in depth or not at all. the Comprehensive R Archive Network (CRAN) repository contains over 14,500 packages for many applications, including some for bioinformatics and metabolomics. the most relevant Task View is \u201cChemometrics and Computational Physics\u201d [16] edited by Katharine Mullen. the bioconductor project (BioC for short) was started by a team around Robert Gentleman in 2001. both CRAN and BioC have a well-defined process for accepting new packages. the respective developer guidelines cover the package life-cycle from submission, updates and maintenance, to deprecation/orphaning of packages. the non-profit initiative rOpenSci maintains an ecosystem around reproducible research. the rdrr.io is a comprehensive index of R packages and documentation from CRAN, Bioconductor, GitHub and R-Forge. it serves as a hub to actually run R code without local installation. R-Packages for Metabolomics This section reviews packages, relates some of those with similar functionality, and mentions how some of the packages can be used together. the sections in this review are ordered according to specific analytical approaches. rmzTab-M [37] GitHub Converts MRM-MS files to LC-MS style.mzML. spectra GitHub Peak Picking, Grouping and Alignment (LC-MS Focussed or General) Pre-processing and visualisation for (LC/GC-) MS data. Includes visualisation and simple statistics. cosmiq BioC m/z detection (i.e., peak picking) for accurate mass data, collecting all data points above an intensity threshold, grouping them by m/z values and estimating representative m/z values for the clusters. enviGCMS [45] CRAN Sequential partitioning, clustering and peak detection of centroided LC-MS mass spectrometry data. X13CMS [48] GitHub Finding the dual (or multiple) isotope labeled analytes using dual labeling of metabolites for metabolome analysis (DLEMMA) approach, described in Liron [50]. Miso [51] CRAN Targeted MS Peak picking using peak apex intensities for selected masses. reference library matching, RT/RI conversion plus metabolite identification using multiple correlated masses. erah [60] CRAN Pre-processing for GC/MS, MassBank search, NIST format export. osd [64,65] CRAN Corrects overloaded signals directly in raw data. also GC-FID or any single channel data since it works directly on peak lists. GitHub Flow Injection/Direct Infusion Analysis Pre-processing of data from Flow Injection Analysis (FIA) coupled to high-resolution mass spectrometry (HRMS) can be used for direct infusion experiments. mass spectra can be recorded in profile (also called continuum) mode, but are often \u2018centroided\u2019. mass spectrum is a gaussian region of a continuum spectrum with a sufficiently high signal to noise ratio. this results in data of reduced size\u2014what was many m/z-intensity pairs is reduced to a single m/z-intensity pair. xcms provides a wrapper for this function in the findPeaks.MSW function. apLCMS, yamss, KPIC2 and enviPick also provide peak picking for LC-MS data independently of xcms. xcms and apLCMS include methods to group the peaks by their m/z and retention times within tolerance levels. the groups are split into sub-groups using density functions. the consensus m/z and retention time is assigned to each bin. two-dimensional chromatography offers two separations in the chromatographic (retention time) domain. the eluent from one column is captured by retention time range and transferred to a second column, where a fast orthogonal separation occurs. this generates four-dimensional data (m/z, first retention time, second retention time, intensity) msPeak package provides peak picking for unit resolution GCGC-MS. peak picking is done on the total ion chromatogram, thus not taking advantage of the mass selectivity provided by the MS detector. msPeak package provides peak picking for GCGC-MS data. package rmzTab-M provides support for exporting quantitative and identification results backed by analytical and mass spectrometry evidence into the mzTab-M metabolomics file format. packages that support interpretation of the relationship between the ion species, including adducts, isotopes and in-source fragmentation, are interpretMSSpectrum, CAMERA, nontarget and mzMatch [82]. enviPat GitHub Checking element isotopes, calculating (isotope labelled) exact monoisotopic mass, m/z values, mass accuracy, and inspecting possible contaminant mass peaks. MSbox CRAN Simulation of and decomposition of Isotopic Patterns. MScombine [93] CRAN Grouping of correlated features into pseudo compound spectra using correlation across sample. annotation of isotopes and adducts. Can work directly with the xcms output. structure directed analysis to find potential relationship among those independent peaks. xcms, replicate merging, noise, blank and missingness filtering, feature grouping, annotation of known compounds, isotopic labeling analysis, common biotransformations and probabilistic putative metabolite annotation. the individual ranked lists of formulae are re-evaluated to maximise the number of pairs with (potential) biochemical substrate-product pairs. the masstrixR package contains several utility functions for accurate mass lookup. this enables matching of measured m/z values against a given database. baitmet [113] CRAN MS/MS spectra similarity and unsupervised statistical methods. workflow from raw data to visualisations and interfaceable with xcms. the MetShot package supports creating targeted method files for some Bruker and Waters instruments. the instrument is configured to apply a set of rules, which determine which precursor ions are fragmented and MS/MS spectra acquired. the packages rcdk, MetShot and RMassBank can be combined into a workflow. it allows the user to specify an arbitrary number RT-m/z pairs. it is possible to allow multiple collision energies in a single or separate experiment methods. the OrgMassSpecR package contains a simple cosine spectral matching between two spectra. the two spectra are aligned with each other within a defined m/z error window using one spectrum as the reference. the feature-rich compMS2Miner can import msp files and uses the dot product to calculate the spectral similarity. most of the packages support the format shown in Listing S1 (see Supplemental File S1, \u2018basic NIST\u2019 in Table S1). the metaMS package supports NIST msp files as shown in Listing S2 (see Supplemental File S1, termed \u2018canonical NIST\u2019) the remaining packages partially support the export of results to NIST msp files (see Table S1). the pepsNMR and speaq are two examples of such R-based packages. the 1D NMR spectra can then be segmented into spectral regions (also known as bins or buckets) subjected directly to statistical data analysis after a normalisation step. peak picking (based on the regions of interest, ROI) can be performed and individual compounds can be identified and integrated prior to statistical analysis. processing includes baseline correction, ppm calibration, removal of solvents and contaminants and re-alignment of chemical shifts. MetaboMate GitHub A tool for processing of 1H NMR data including baseline correction, baseline correction, bucketing, Fourier transformation, warping and phase correction. mQTL.NMR provides a complete metabotype quantitative trait locus mapping analysis pipeline for metabolomic data. mQTL.NMR provides a complete metabotype quantitative trait locus mapping analysis pipeline for metabolomic data. a photo-diode array detector (DAD or PDA) is part of an LC-MS system, actually an LC-UV-MS setup. alignment and baseline correction are typically the first steps of pre-processing LC-UV data. mdatools CRAN Parametric Time Warping (RT correction) for both DAD and LC-MS. different paths to statistical analysis are available in R and Bioconductor. MetaboQC [188] SF Multiple fitting models to correct intra- and inter-batch effects. MetNorm [190] CRAN Collection of functions designed to implement, assess, and choose a suitable normalisation method for a given metabolomics study. normalizeMets [191] CRAN Support Vector Regression based normalisation and integration for large-scale metabolomics data. MWSL [199] GitHub Multivariate Modeling and Feature Selection Find biomarkers in two class discrimination problems with variable selection methods provided for several classification methods. biosigner [177] BioC General framework for building regression and classification models. klaR [201] CRAN Unsupervised feature extraction specifically designed for analysing noisy and high-dimensional datasets. multiway CRAN Predictive multivariate modelling using PLS and Random Forest Data. repeated double cross unbiased validation and variable selection. ropls [210] BioC Fits multi-way component models via alternating least squares algorithms. threeWay [211] CRAN Contains ordination methods such as ReDundancy Analysis (RDA), (Canonical or Detrended) Correspondence Analysis (CCA, DCA for binary explanatory variables), (Non-metric) MDS and other univariate and multivariate methods. vegan CRAN Biomarker validation for predicting survival. omicade4 [215] BioC STATegRa combines information in multiple omics datasets to evaluate the reproducibility among samples and across experimental conditions. STRUCT GitHub Integration of omics data using multivariate methods such as PLS. missMDA allows missing data imputation using in categorial, continuous or mixed-type datasets. an out-of-bag error estimate is used for model optimisation. mice [227] CRAN Missing data imputation using an approximate Bayesian framework. MetaboAnalystR [232,233] GitHub Pipeline for metabolomics data pre-processing. identifies sources of variability in the experiment and performs additional analysis. phenomis GitHub Missing value filtering and imputation. metabolite profiling is performed by most untargeted metabolomics studies. a bottom-up approach is taken where sets or classes of pre-defined metabolites are studied usually in different phenotypes of the same biological species. differences in metabolites are usually related to more coarse functional or biological levels. untargeted metabolomics data is related to other \u2018omics using network analysis or Procrustes analysis to visualise (dis)similarities between two or more \u2018omics data sets [170,171,172,173]. a great number of packages are available for performing statistics on metabolomics datasets. some focus on performing several specific tasks, such as sample size estimation, batch normalisation, exploratory data analysis, univariate hypothesis testing, multivariate modeling and omics data integration. the pre-processing is limited to missing value imputation, noise filtering, variable scaling and data normalisation. the package also provides tools for outlier detection, univariate and multivariate analysis. MetaboAnalystR functionalities cover a wide range of tools. include exploratory statistical analysis, biomarker analysis, power analysis, biomarker meta-analysis, functional enrichment analysis, pathway and joint pathway analysis. using the mummichog algorithm, MetaboAnalystR provides access to metabolite set libraries, compound libraries and pathway libraries. rinchi GitHub Provides fingerprinting methods for rcdk. fingerprint CRAN Database Queries Calculation of molecular properties. rpubchem CRAN Querying information from various web services. rcdk provides a computer readable representation of molecular structures. rinchi provides reading and writing of InChI and InChIKeys. rinchi provides reading and writing of InChI and InChIKeys. bridgeDbR can be used to map identifiers (metabolites, but also genes and proteins, and interactions) between databases. RMassBank and RChemMass also provide some useful web-retrieval functions. the classyfireR package supports the retrieval of substance classes using the RESTful API of the classyFire tool based on InChIKeys. bioNetStat BioC Annotation Putative annotation of unknowns in MS1 data. xMSAnnotator [106] SF Putative annotation of unknowns using MS/MS data. MetDNA [264] GitHub Visualisation of spectral similarity networks. SDAMS BioC Biomarker identification. lilikoi [284] CRAN Biomarker identification. INDEED [285] BioC Biomarker identification. lilikoi [284] CRAN Differential analysis. lilikoi [284] CRAN Biomarker identification. INDEED [285] BioC Biomarker identification. bioC interface to gaggle-enabled software (Cytoscape, Firegoose, Gaggle Genome browser). bioC interface to bioPAX OWL files and the PW molecular interaction database. includes user-friendly R shiny web application for queries. a major challenge in metabolomics is metabolite annotation, spanning the annotation of known compounds (dereplication) or annotation of unknown metabolites and proposing hypotheses of their structures. the package xMSAnnotator incorporates a multi-criteria scoring algorithm to annotate mass features into different confidence levels. MetDNA, implemented in R, JavaScript and Python, combines MS1 and MS/MS data to putatively annotate features in metabolomics data sets [264] MetCirc visualises the spectral similarity matrix between MS/MS spectra in a Circos-like interactive shiny application. MetaMapR generates metabolic networks by integrating enzymatic transformation, structural similarity between metabolites, mass spectral similarity and empirical correlation information. MetaMapR queries biochemical reactions in KEGG and molecular fingerprints for structural similarities in PubChem. FELLA is a Bioconductor package for enrichment analysis. lilikoi maps features to pathways by using standardised HMDB IDs. lilikoi transforms metabolomic profiles to pathway-based profiles. inDEED aims to detect biomarkers by performing a differential expression analysis. activity scores are calculated based on differences detected in the differential expression and the topology of the differential network that will guide the selection of biomarkers. the package MetaboLouise simulates longitudinal metabolomics data. the simulation builds on a mathematical representation that is parameterised according to underlying biological networks, i.e., by defining metabolites and relation between them by initialising enzyme rates. rWikiPathways is an interface between R and WikiPathways.org. rWikiPathways integrates pathway, gene, and metabolite annotations from KEGG, HMDB, Reactome, and WikiPathways. several multifunctional R-based workflows have been developed over the years. most of the functions the user needs are available within the same \u201cenvironment\u201d so that the data does not have to be formatted to comply with functions in other packages. simExTargId GitHub Pre-processing of large LC-MS datasets. Performs automatic PCA with iterative automatic outlier removal and, clustering analysis and biomarker discovery. the considered workflows support both MS-based data (LC-MS and GC-MS) and data generated by different analytical platforms. the considered workflows support both MS-based data (LC-MS and GC-MS) mzMatch is slightly different from the above-mentioned workflows. the project also includes a dedicated file format (peakML) and a Java environment. mzMatch supports peak picking and grouping using xcms. specmine provides a general framework that addresses a variety of different analytical platforms, such as LC-MS, GC-MS, NMR, IR and UV-Vis. it relies on xcms for LC-MS and GC-MS data pre-processing, hyperSpec for NMR, IR and UV/VIS data processing and on MAIT for metabolite identification. RMassScreening is a workflow for batch processing of LC-HRMS datasets. it provides wrappers for script-based usage of enviPick and basic enviMass components. it implements suspect screening and combinatorial prediction of possible metabolites (transformation products) from parent compounds. the shiny framework can create web apps using the full power of R packages as the backend. there are several approaches to creating, sharing and using data analysis in R for developers and users, with different strengths and weaknesses. the binder project is an infrastructure for creating and using shareable, interactive and reproducible data analysis (not only) with R [313] by taking any GitHub repository, turning it into a Docker image and launching it on a cloud service. a public instance is the mybinder.org service providing (limited) resources to execute R-based scripts in a hosted Rstudio or Jupyter notebook. reticulate CRAN Several workflow systems support workflow nodes and tools that can wrap and execute R code. systems like KNIME [315,316] and Galaxy [317,318] also provide visual programming using the wrapped R functionality. Metabolomics data sets are available from MetaboLights [326] in the EU, GNPS [122] and Metabolomics Workbench [327] in the US. in this review, we focus instead on data in R packages. there is no difference in R between software and data packages per se. patRoonData GitHub Proteomics, metabolomics GC-MS and Lipidomics data from Calu-3 cell culture. 3 mockulum treated and 9 MERS-CoV treated. pmartRdata GitHub FIA-MS 6 mzML files (human plasma spiked with 40 compounds acquired in positive mode on an orbitrap fusion) also includes data sets with 10 technical injections of human urine and another 10 injections from leaf tissue (ecotype ABR1). one of the first steps in metabolomics data processing is usually the reduction of the typically large raw data produced by the instrument. features normally represent integrated peaks for a given mass that have been aligned across samples. features normally represent integrated peaks for a given mass that have been aligned across samples. xcms [31,32] BioC Automatic optimisation of xcms parameters based on isotopes. autotuner BioC Parameter tuning algorithm for xcms, MZmine2 and other metabolomics data processing software. yamss [40] BioC Peak picking with xcms and apLCMS, low intensity peak detection via replicate analyses. enviPick CRAN Peak picking with xcms. Groups chemically related features before alignment across samples. additional processing after alignment includes feature validation, re-integration and annotation based on custom database. massFlowR GitHub KPIC2 extracts pure ion chromatograms (PIC) via K-means clustering of ions in region of interest. targetSearch [52] BioC Pre-processing for targeted (SIM) GC-MS data. guided selection of appropriate fragments for targets of interest by using user provided library. MRMAnalyzer [54] Automatic analysis of large-scale MRM experiments. osd [64,65] CRAN Corrects overloaded signals directly in raw data. also GC-FID or any single channel data since it works directly on peak lists. msPeak [69] SF Peak alignment for GCGC-MS data with homogeneous peaks based on mixture similarity measures. massSpecWavelet [75] BioC Other Filtering of features originating from artifactual interference. metaMS [68] BioC Processing of peaktables from AMDIS, xcms or ChromaTOF. the centroiding can be done either during acquisition on the fly by the instrument software, or as an initial processing step. post-acquisition centroiding can be performed during conversion of the vendor data format to open formats. Dedicated vendor tools can also be used. xcms is widely used for pre-processing of LC-MS and GC-MS data. apLCMS, yamss, KPIC2 and enviPick also provide peak picking for LC-MS data independently of xcms. intensity for a given mass over (retention) time can be represented as two equal length vectors. the data thus contains no spectra, but several SICs. recent versions of xcms are also able to process such data. a gas phase separation method offers resolution of ions based on molecular shape. this separation occurs on timescales of tens of microseconds, which generates a nested data structure. this chromatogram is nested within the actual chromatographic separation. LC-IMS-MS is the most common use-case, even though high-resolution MS could further improve signal deconvolution and ultimately, analyte identification. such capabilities are crucial for moving these new powerful analytical approaches into mainstream metabolomics analysis. package rmzTab-M provides support for exporting quantitative and identification results into the mzTab-M metabolomics file format [37]. package rmzTab-M provides support for exporting quantitative and identification results backed by analytical and mass spectrometry evidence into the mzTab-M metabolomics file format [37]. MSbox CRAN Simulation of and decomposition of Isotopic Patterns. CAMERA [86] CRAN Cluster-based feature grouping for non-targeted GC or LC-MS data. nontarget [91] CRAN Automatic interpretation of fragments and adducts in MS spectra. Molecular formula prediction based on fragmentation. interpretMSSpectrum [97] CRAN Automated annotation using MS/MS data or databases and retention time. Calculation of spectral and chemical networks. xMSAnnotator [106] SF Detailed reconstructed isotope patterns can be used to determine the molecular formula of potential candidates. the m/z and intensities for a given (set of) features can be used to calculate a ranked list of possible molecular formulas based on the accurate mass and relative isotope abundances. tra can be recorded in profile (also called continuum) mode, but are often \u2018centroided\u2019. a gaussian region of a continuum spectrum with a sufficiently high signal to noise ratio is integrated to give a centroided mass. this results in data of reduced size\u2014what was many m/z-intensity pairs is reduced to a single m/z-intensity pair. xcms provides a wrapper for this function in the findPeaks.MSW function. apLCMS, yamss, KPIC2 and enviPick also provide peak picking for LC-MS data independently of xcms. xcms and apLCMS include methods to group the peaks by their m/z and retention times within tolerance levels. the groups are split into sub-groups using density functions. the consensus m/z and retention time is assigned to each bin. two-dimensional chromatography offers two separations in the chromatographic (retention time) domain. the eluent from one column is captured by retention time range and transferred to a second column. this generates four-dimensional data (m/z, first retention time, second retention time, intensity) msPeak package provides peak picking for unit resolution GCGC-MS. the peak picking is done on the total ion chromatogram. it does not appear that any package for R exists that provides peak picking for GCGC-MS. package rmzTab-M provides support for exporting quantitative and identification results backed by analytical and mass spectrometry evidence into the mzTab-M metabolomics file format. packages that support interpretation of the relationship between the ion species, including adducts, isotopes and in-source fragmentation, are interpretMSSpectrum, CAMERA, nontarget and mzMatch [82]. enviPat GitHub Checking element isotopes, calculating (isotope labelled) exact monoisotopic mass, m/z values, mass accuracy, and inspecting possible contaminant mass peaks. MSbox CRAN Simulation of and decomposition of Isotopic Patterns. MScombine [93] CRAN Grouping of correlated features into pseudo compound spectra using correlation across sample. annotation of isotopes and adducts. Can work directly with the xcms output. structure directed analysis to find potential relationship among those independent peaks. xcms, replicate merging, noise, blank and missingness filtering, feature grouping, annotation of known compounds, isotopic labeling analysis and probabilistic putative metabolite annotation using MetAssign. the individual ranked lists of formulae are re-evaluated to maximise the number of pairs with biochemical substrate-product pairs. the masstrixR package contains several utility functions for accurate mass lookup. this enables matching of measured m/z values against a given database or library. metabolites targeting mass spectral/retention time libraries into full scan-acquired GC-MS chromatograms. baitmet [113] CRAN MS/MS spectra similarity and unsupervised statistical methods. the MetShot package supports creating targeted method files for some Bruker and Waters instruments. optimised lists of non-overlapping peaks (RT-m/z pairs) can be generated to optimise acquisition in the lowest possible number of methods. rcdk, MetShot and RMassBank can be combined into a workflow. it allows the user to specify an arbitrary number RT-m/z pairs. it is possible to allow multiple collision energies in a single or separate experiment methods. a growing number of packages, e.g., LOBSTAHS [99], LipidMatch [100] and LipidMS [101], support the annotation of lipids, see Table 2. they use a combination of lipid database lookup, spectral or selected fragment mass matching and in silico spectra prediction. they typically rely on identifying specific MS/MS feature masses that are indicative of substructure fragments. most of the packages support the format shown in Listing S1 (see Supplemental File S1, \u2018basic NIST\u2019 in Table S1). the metaMS package supports NIST msp files as shown in Listing S2 (see Supplemental File S1, termed \u2018canonical NIST\u2019) the remaining packages partially support the export of results to NIST msp files (see Table S1). the MetShot package supports creating targeted method files for some Bruker and Waters instruments. in data-dependent acquisition (DDA), the instrument is configured to apply a set of rules, which determine which precursor ions are fragmented and MS/MS spectra acquired. rcdk, MetShot and RMassBank can be combined into a workflow. it allows the user to specify an arbitrary number RT-m/z pairs. it is possible to allow multiple collision energies in a single or separate experiment methods. the OrgMassSpecR package contains a simple cosine spectral matching between two spectra. the two spectra are aligned with each other within a defined m/z error window using one spectrum as the reference. the feature-rich compMS2Miner can import msp files and uses the dot product to calculate the spectral similarity. most of the packages support the format shown in Listing S1 (see Supplemental File S1, \u2018basic NIST\u2019 in Table S1). the metaMS package supports NIST msp files as shown in Listing S2 (see Supplemental File S1, termed \u2018canonical NIST\u2019) the remaining packages partially support the export of results to NIST msp files (see Table S1). the pepsNMR and speaq are two examples of such R-based packages. the 1D NMR spectra can then be segmented into spectral regions (also known as bins or buckets) subjected directly to statistical data analysis after a normalisation step. peak picking (based on the regions of interest, ROI) can be performed and individual compounds can be identified and integrated prior to statistical analysis. processing includes baseline correction, ppm calibration, removal of solvents and contaminants and re-alignment of chemical shifts. MetaboMate GitHub A tool for processing of 1H NMR data including apodisation, baseline correction, bucketing, Fourier transformation, warping and phase correction. mQTL.NMR provides a complete metabotype quantitative trait locus mapping analysis pipeline for metabolomic data. mQTL.NMR provides a complete metabotype quantitative trait locus mapping analysis pipeline for metabolomic data. a photo-diode array detector (DAD or PDA) is part of an LC-MS system, actually an LC-UV-MS setup. alignment and baseline correction are typically the first steps of pre-processing LC-UV data. mdatools CRAN Parametric Time Warping (RT correction) for both DAD and LC-MS. different paths to statistical analysis are available in R and Bioconductor. MetaboQC [188] SF Multiple fitting models to correct intra- and inter-batch effects. MetNorm [190] CRAN Collection of functions designed to implement, assess, and choose a suitable normalisation method for a given metabolomics study. normalizeMets [191] CRAN Support Vector Regression based normalisation and integration for large-scale metabolomics data. MWSL [199] GitHub Multivariate Modeling and Feature Selection Find Biomarkers in two class discrimination problems with variable selection methods provided for several classification methods. biosigner [177] BioC General framework for building regression and classification models. klaR [201] CRAN Various additions to PCA like PPCA, PPCCA, MPPCA. multiway CRAN Predictive multivariate modelling using PLS and Random Forest Data. repeated double cross unbiased validation and variable selection. ropls [210] BioC Fits multi-way component models via alternating least squares algorithms. CRAN Contains ordination methods such as ReDundancy Analysis (RDA), (Canonical or Detrended) Correspondence Analysis (CCA, DCA for binary explanatory variables), (Non-metric) MDS and other univariate and multivariate methods. vegan CRAN Biomarker validation for predicting survival. cross validation methods to validate and select biomarkers when the outcome of interest is survival. omicade4 [215] BioC STATegRa combines information in multiple omics datasets to evaluate the reproducibility among samples and across experimental conditions. STRUCT GitHub Integration of omics data using multivariate methods such as PLS. missMDA allows missing data imputation using in categorial, continuous or mixed-type datasets. an out-of-bag error estimate is used for model optimisation. mice [227] CRAN Missing data imputation using an approximate Bayesian framework. MetaboAnalystR [232,233] GitHub Pipeline for metabolomics data pre-processing. identifies sources of variability in the experiment and performs additional analysis. phenomis GitHub Missing value filtering and imputation. metabolite profiling is performed by most untargeted metabolomics studies. a bottom-up approach is taken where sets or classes of pre-defined metabolites are studied usually in different phenotypes of the same biological species. differences in metabolites are usually related to more coarse functional or biological levels. untargeted metabolomics data is related to other \u2018omics using network analysis or Procrustes analysis to visualise (dis)similarities between two or more \u2018omics data sets [170,171,172,173]. a great number of packages are available for performing statistics on metabolomics datasets. some focus on performing several specific tasks, such as sample size estimation, batch normalisation, exploratory data analysis, univariate hypothesis testing and multivariate modeling. the pre-processing is limited to missing value imputation, noise filtering, variable scaling and data normalisation. the package also provides tools for outlier detection, univariate and multivariate analysis. MetaboAnalystR functionalities cover a wide range of tools. tools include exploratory statistical analysis, biomarker analysis, power analysis, biomarker meta-analysis, pathway and joint pathway analysis. using the mummichog algorithm, MetaboAnalystR provides access to metabolite set libraries, compound libraries and pathway libraries. rinchi GitHub Provides fingerprinting methods for rcdk. fingerprint CRAN Database Queries Calculation of molecular properties. rpubchem CRAN Querying information from various web services. rcdk provides a computer readable representation of molecular structures. rinchi provides reading and writing of InChI and InChIKeys. rinchi provides reading and writing of InChI and InChIKeys. bridgeDbR can be used to map identifiers (metabolites, but also genes and proteins, and interactions) between databases. RMassBank and RChemMass also provide some useful web-retrieval functions. the classyfireR package supports the retrieval of substance classes using the RESTful API of the classyFire tool based on InChIKeys. xMSAnnotator [106] SF Putative annotation of unknowns using MS/MS data. MetDNA [264] GitHub Visualisation of spectral similarity networks, putative annotation of unknowns using MS/MS data. SDAMS BioC Biomarker identification. lilikoi [284] CRAN Differential analysis. INDEED [285] BioC Biomarker identification. lilikoi [284] CRAN Differential analysis. lilikoi [284] CRAN Biomarker identification. INDEED [285] BioC Biomarker identification. interface to Gaggle-enabled software (Cytoscape, Firegoose, Gaggle Genome browser). rWikiPathways [299] BioC Database that integrates metabolite and gene biological pathways from HMDB, KEGG, Reactome. bioNetStat creates correlation-based networks from metabolite concentration data. it analyses networks based on graph spectra, spectral entropy, degree distribution and node centralities. a major challenge in metabolomics is metabolite annotation, spanning the annotation of known compounds or annotation of unknown metabolites. MetDNA, implemented in R, JavaScript and Python, combines MS1 and MS/MS data to putatively annotate features in metabolomics data sets [264] MetCirc visualises the spectral similarity matrix between MS/MS spectra in a Circos-like interactive shiny application. MetaMapR generates metabolic networks by integrating enzymatic transformation, structural similarity between metabolites, mass spectral similarity and empirical correlation information. MetaMapR queries biochemical reactions in KEGG and molecular fingerprints for structural similarities in PubChem. CePa offers enrichment analysis tools extending conventional gene set enrichment methods by incorporating pathway topologies. lilikoi maps features to pathways by using standardised HMDB IDs, transforms metabolomic profiles to pathway-based profiles. inDEED aims to detect biomarkers by performing a differential expression analysis. activity scores are calculated based on differences detected in the differential expression and the topology of the differential network that will guide the selection of biomarkers. another R package for biomarker and feature selection is MoDentify. the package MetaboLouise simulates longitudinal metabolomics data. the simulation builds on a mathematical representation that is parameterised according to underlying biological networks, i.e., by defining metabolites and relation between them by initialising enzyme rates. rWikiPathways is an interface between R and WikiPathways.org. pathways can be queried, interrogated and downloaded to the R session. rWikiPathways integrates pathway, gene, and metabolite annotations from KEGG, HMDB, Reactome, and WikiPathways. functionality is implemented in a plethora of software packages, among others igraph, tidygraph or the statnet suite. these packages offer functions to generate networks from respective data input (e.g., adjacency matrices), to analyse networks, calculate network properties and to visualise networks. such networks can be analysed by the functions provided by the above-mentioned packages or by packages tailored more towards the analysis of biological data. MetNet aims at facilitating detection and putative annotation of unknown MS1 features in untargeted metabolomics studies. the package xMSAnnotator incorporates a multi-criteria scoring algorithm to annotate mass features into different confidence levels. iterated application of similarity matching between reaction pairs allows expansion of annotation using seed metabolites or previously annotated metabolites. MetCirc visualises the spectral similarity matrix (e.g., the normalised dot product) between MS/MS spectra in an interactive shiny application. the package Metabox offers a pipeline for metabolomics data analysis. it includes functionality for data-driven network construction using correlation, estimation of chemical structure similarity networks using substructure fingerprints. it includes functionality to perform targeted metabolome-wide association studies. SDAMS performs differential abundance analysis on metabolomics data by linking (non-normally distributed) metabolite levels to phenotypic data, containing zero and possibly non-normally distributed non-zero intensity values. many R packages guide the discovery of biomarkers for specific phenotypes. the package MetaboLouise simulates longitudinal metabolomics data. the simulation builds on a mathematical representation parameterised according to biological networks, i.e., by defining metabolites and relation between them by initialising enzyme rates. graphite stores pathway information for proteins and metabolites of 14 species. available databases are KEGG, Biocarta, Reactome, NCI/Nature Pathway Interaction Database, HumanCyc, Panther, SMPDB and PharmGKB. RPathVisio enables the creation and editing of biological pathways. a relational database of Metabolomics Pathways integrates pathway, gene, and metabolite annotations from KEGG, HMDB, Reactome, and WikiPathways. the database is downloadable as a standalone MySQL dump, for integration with other software, and is also accessible through an R package. the packages covering larger parts of metabolomics workflows available in R are listed in Table 9. mzMatch [82,105] GitHub xcms and CAMERA-based workflow for non-targeted processing of LC-MS datasets. specmine GitHub Common interface for several different MS-based data processing software. it covers various aspects, such as data preparation and data extraction, formula calculation, compound identification and reporting. enviMass Zenodo Workflow for pre-processing of LC-HRMS data. mzMatch supports peak picking and grouping using xcms. peakMonitor app identifies peaks using the local database. mzMatch supports peak picking and grouping using xcms. metaDB supports both LC-MS and GC-MS datasets. features include peak picking and annotation and QC plots. specmine provides a general framework that addresses different analytical platforms. specmine provides scripts for missing values imputation, univariate and multivariate statistics and machine learning methods. specmine provides scripts for missing values imputation, univariate and multivariate statistics and machine learning methods. enviMass is a comprehensive workflow for data-mining of LC-MS and GC-MS datasets. the shiny framework can create web apps using the full power of R packages as the backend. a current gap in the shiny metabolomics landscape are powerful and re-usable widget collections for, e.g., spectra viewers. shiny apps can range from straightforward to highly complex. Symbols indicate strengths (+, ++) or weaknesses (-, --) or neutral (o) assessment. the binder infrastructure code is available on GitHub, so that the service can be offered by universities and research groups to its users. in some cases, an R package can provide bindings to existing tools and libraries written in other languages. the reticulate package provides the infrastructure to execute Python from R code. examples can be found on the toolshed central repository (toolshed.g2.bx.psu.edu) and in the RGalaxy bioconductor package. workflow developers need to ensure seamless data flow through workflow steps. reuse and reprocessing of data sets is greatly encouraged. mtbls2 [111] BioC 12 UPLC-MS mzML files (AB Sciex TripleTOF 5600, SWATH mode). mtbls297 [329] GitHub Different raw MS files (LTQ, TripleQ, FTICR, Orbitrap, QTOF) some in different formats (mzML, mzXML, mzData, mzData, NetCDF, mz5) metaboData GitHub GC-MS 52 154 peak table. pcaMethods [195] BioC NMR 18 189 peak table. other packages contain pre-processed data from GC-MS and flow injection analysis. the authors have recently adopted Bioschemas [330] to make metadata more easily findable. efforts to start annotation in vignettes allow the ELIXIR Training eSupport System TeSS to pick up newer versions. efforts are underway to expose content from the DESCRIPTION file as Bioschemas annotations on Bioconductor. the metaRbolomics-book will be a continuously developed resource. the authors expect that the metaRbolomics landscape will continue its steady growth rate and keeps track of the evolving metabolomics experiments."}