{"summary": "metagenomics techniques enable the identification and genomic characterisation of microorganisms present in a sample with a generic lab procedure. the approach has gained popularity with the introduction of next-generation sequencing (NGS) methods that provide more data in less time at a lower cost than previous sequencing techniques. many bioinformaticians have developed computational workflows to analyse viral metagenomes. a part of the metagenomics workflows has been tested and described in review articles. some studies involve benchmark tests of a selection of tools. the results were limited to publications between January 2010 and January 2017. the results were limited to publications between January 2010 and January 2017. we listed only benchmark results from in silico tests using simulated viral sequence reads. different publications have used different taxonomic levels for classification, from kingdom to species. correlations between performance (sensitivity, specificity, precision and runtime) and methodical factors were calculated and visualized with R v3.3.2 (https://www.r-project.org/), using RStudio v1.0.136 (https://www.r-project.org/). results and workflow descriptions Available workflows We found 56 publications describing the development and testing of 49 classification workflows. three were unavailable for download or online use and two were only available upon request. Giant Virus Finder Kerepesi and Grolmusz, 2016 http://pitgroup.org/giant-virus-finder GOTTCHA Freitas et al., 2015 https://github.com/LANL-Bioinformatics/GOTTCHA IMSA Dimon et al., 2013 https://github.com/JeremyCoxBMI/IMSA-A Kraken Wood and Salzberg, 2014 https://github.com/DerrickWo MetLab Norling et al., 2016 https://github.com/norling/metlab NBC Rosen et al., 2011 http://nbc.ece.drexel.edu/ PathSeq Kostic et al., 2011 http://www.broadinstitute.org/software/pathseq/ ProViDE Ghosh et al., 2011 http://metagenomics.atc.tcs.com/b taxonomer.com/ Taxy-Pro Klingenberg et al., 2016 \u2013 vFam Skewes-Cox et al., 2014 http://derisilab.ucsf.edu/software/vFam/ VIP Li et al., 2016 https://github.com/keylabivdc/VIP ViralFusionSeq Li et al., 2013 https://sourceforge.net/projects/ the selected metagenomics classification workflows consist of up to five different steps: pre-process, filter, assembly, search and post-process. only three workflows (SRSA, Isakov et al., 2011, Exhaustive Iterative Assembly, Sch\u00fcrch et al., 2014, and VIP, Li et al., 2016) included all of these steps. the adapters, quality, paired-end reads and accuracy of repeats depend on the sequencing technology. removing reads may result in not finding rare viruses, while having fewer reads to process will speed up the analysis. lvet, CAP3 FPAS Python, SOAPDenovo, ABySS, MetaVelvet, CAP3, MegaBLAST, Bowtie2, VecScreen Exhaustive Iterative Assembly (Virus Discovery Pipeline) BLAST, MAFFT, PhyML NCBI BLAST nt + nr, NCBI viral proteins (per hit), Pfam, custom BLASTn NCBI nt. bacteria, NCBI Genomes: GenBank bacteria + archaea \u2013 \u2013 \u2013 S-pp C++, Perl LMAT Custom NCBI Genomes: GenBank bacteria + archaea \u2013 \u2013 \u2013 S-pp Java, DIAMOND, InterPro2GO, SEED viewer, eggNOG viewer, KEGG MEGAN4 BLAST NCBI BLAST nt \u2013 \u2013 \u2013 S Java MePIC Megablast NCBI BLAST nt Scriptree Metavir 2 BLAST, custom, FastTree NCBI RefSeq: viral, phage, vFams Bowtie2 \u201cHost genome\u201d (human) SPAdes P(F)(A)SS Python (2.7) + libraries, GNU MPFR, Prinseq-Lite, Bowtie2, SAMTOOLS, SPAdes, Krona Tools, Kraken. Python QuasQ Bowtie2 \u201cThe reference genome\u201d \u2013 \u2013 PS-pp Perl, SMALT, Makeflow Rega Typing Tool v3 BLAST, TreePuzzle Custom \u2013 \u2013 \u2013 SPh Php, Java, R, TreePuzzle RIEMS GS Mapper, BLAST NCBI BLAST nt, nr \u2013 Newbler PASAS(SS) Bash, 454 genome sequencer software suite, New rRNA, mRNA, mtRNA (March 2012) Minimo, ABySS PFS(AS) Bash, Python, Perl, fastQValidator, Minomo, ABySS, RAPSearch2, seqtk, SNAP, gt-sequniq, fastq, cutadapt, prinseq-lite, dropcache Taxonomer KAnalyze + custom k-mer matching UniRef PS Perl, BWA, BLAST Virana STAR (, BLAST, LASTZ) NCBI RefSeq: \u201cviruses,\u201d repbase human endogenous retroviruses STAR NCBI GRCh37/hg19, Ensembl human cDNA Trinity, Oases PS(A)(S)Ph Python, STAR, BWA-mem, LASTZ, RazerS3, Jalview, Trinity, Oases VirFi GIB-V Bowtie2 NCBI human CRCh37/36-hg19/hg18 Trinity FS(AS/S-pp) Perl, BLAST+, BLAT, Bowtie2, BWA, iCORN, CREST, GATK, SAMtools, SVDetect, Trinity VirusHunter BLAST NCBI BLAST nt, nr BLASTn Host genome \u2013 PFS(S) filtering of non-target reads helps reduce false positive results and prevents assembly of chimaeric virus-host sequences. but with lenient homology cutoffs, too many reads may be identified as non-viral. pathSeq removes human reads in a series of filtering steps. Clinical PathoScope filters human genomic reads as well as human rRNA reads. VirusSeeker uses the complete NCBI nucleotide (nt) and non-redundant protein databases to classify all reads. specialized software, such as Human Best Match Tagger (BMTagger, NCBI, 2011) or riboPicker (Schmieder, 2011), is less commonly used. Table 3. Usability features of classification workflows. use yes, download no http://virome.dbi.udel.edu/, Tutorial videos Unknown VirFind Any (webservice) Yes (webservice) Use yes, download no http://virome.dbi.udel.edu/, Tutorial videos Unknown VirFind Any. er%20Guide.pdf 2-3x slower than Kraken-MetaPhlAn2 Clinical PathoScope Any No Yes https://sourceforge.net/p/pathoscope/wiki/clinical_pathoscope/ 1 h READSCAN Linux No Yes http://www.cbrc.kaust.edu.sa/readscan/, Supplied with download - in scripts 27 min on 16 CPU-HPC - 4 h Vi Unknown IMSA+A Linux No Yes https://github.com/JeremyCoxBMI/IMSA-A/blob/master/IMSA%2BA_Detailed_Direction.pdf Unknown GenSeed-HMM Linux No Yes https://sourceforge.net/projects/genseedhmm/files Unknown VirVarSeq Linux, Mac OS No Yes https://sourceforge.net/projects/virtools/files/\"source=nav de novo assembly liable to generate erroneous contigs by linking together reads containing technical errors. de novo assembly benefits from strict quality control and pre-processing. two of the discussed workflows have multiple iterations of assembly and combine algorithms to improve overall assembly. in total, 18 of the tools incorporate an assembly step (Figure 1B, Table 4) x x Yes (new version) 752 VirSorter Developers Manual curation of prophages 62 (6) \u2013 90 (6) Yes (15-2-2017) 34 Virana Developers FISH, Southern blot 67 (4) \u2013 78 (4) Yes (1-6-2014) 9 vFam Developers Compared to previous studies 33 (3) 99 (3) 34 (3) Yes (9-2-2014) 19 MEGAN Community Edition IMSA+A \u2013 x x Yes (12-7 s \u2013 50 (6) \u2013 93 (6) Yes (17-11-2016) 31 IMSA Developers \u2013 92 (4) \u2013 \u2013 Yes (17-4-2014) 10 READSCAN Developers \u2013 62 (15) \u2013 \u2013 No (16-9-2012) 30 FACS Developers \u2013 99 (2) 100 (2) \u2013 Yes (17-12-2015) 39 Taxonomer Developers \u2013 95 (4) 91 (1) \u2013 Yes (3-7-2017) 16 QuasQ Developers 88 metaViC \u2013 \u2013 \u2013 \u2013 \u2013 Yes (20-6-2017) NA MePIC \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 Yes (new version) 88 metaViC \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 Yes (new version) 88 metaViC \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 yes (20-6-2017) BLAST algorithms rely on alignments to a reference database and report matched sequences with alignment scores. Bowtie and BWA align nucleotide sequences exclusively. BLAST can do either nucleotides or amino acids. ux et al., 2011), VirSorter and MetLab can also use HMMER. composition search requires the program to be \u201ctrained\u201d on reference data and it is not used much in viral genomics. six workflows use phylogeny to place sequences in a phylogenetic tree with homologous reference sequences. this is especially useful for outbreak tracing to elucidate relationships between samples. 18 workflows include post-processing. the speed of upload and the constraint to work with one sample at a time may limit its usability. diagnostic centers may also have concerns about the security of the data transferred. six different workflows (Left) have received more than 100 citations. scores were high (>75%), except for IMSA+A (9%), Kraken (34%), NBC (49%), and vFam (3-73%). runtimes had been determined or estimated for 36 workflows. a crude categorisation was made dividing workflows into three groups. different search algorithms had different performance scores on average. similarity search methods had lower sensitivity, but higher specificity and precision than composition search. workflows are suitable for medical purposes when they can detect pathogenic viruses by classifying sequences to a genus level or further (e.g., species, genotype), or when they detect integration sites. forty-three workflows matched these criteria. workflows we found 56 publications describing the development and testing of 49 classification workflows. three were unavailable for download or online use. 25 were developed for broader use, such as classification of bacteria and archaea. et al., 2015 https://github.com/LANL-Bioinformatics/GOTTCHA IMSA Dimon et al., 2013 https://sourceforge.net/projects/arron-imsa/source=directory IMSA+A Cox et al., 2017 https://github.com/JeremyCoxBMI/IMSA-A Kraken Wood and Salzberg, 2014 https://github.com/DerrickWood ProViDE Ghosh et al., 2011 http://metagenomics.atc.tcs.com/binning/ProViDE/ QuasQ Poh et al., 2013 http://www.statgen.nus.edu.sg/software/quasq.html READSCAN Naeem et al., 2013 http://cbrc.kaust.edu.sa/readscan/ Rega Typing no website could be found, the workflow was unavailable. no website could be found. methods The selected metagenomics classification workflows consist of up to five different steps: pre-process, filter, assembly, search and post-process. only three workflows (SRSA, Isakov et al., 2011 and VIP, Li et al., 2016) incorporated all of these steps. twenty-four workflows include a pre-processing step, applying at least one of the components listed above. other workflows require input of reads pre-processed elsewhere. PhyML NCBI BLAST nt + nr, NCBI viral proteins (per hit), Pfam, custom BLASTn NCBI nt, aves, carnivora, primates, rodentia, ruminantia Newbler, CAP3 PAFSPh Python, Newbler, GSMapper, CAP3, BLAST, HMMER, MEME, MAST, Bioconductor, R FACS Bloom filter Custom \u2013 AMOND NCBI BLAST nt + nr \u2013\u2013 S-pp Java, DIAMOND, InterPro2GO, SEED viewer, eggNOG viewer, KEGG MEGAN4 BLAST NCBI BLAST nt + nr \u2013\u2013\u2013 S Java MePIC Megablast NCBI BLAST nt BWA NCBI human GRCh37/hg19 \u2013 PFS fastq-mcf (ea-utils), BWA vFams Bowtie2 \u201cHost genome\u201d (human) SPAdes P(F)(A)SS Python (2.7) + libraries, GNU MPFR, Prinseq-Lite, Bowtie2, SAMTOOLS, SPAdes, Krona Tools, Kraken, FragGeneScan, vFamParse NBC Custom \u201cUnique N-mer frequency profiles of 635 microbial genomes\u201d. newbler, GS mapper, sff/fna tools, BLAST, Emboss RINS BLAT, BLAST Custom Bowtie Human genome Trinity SPFAS Blat, Bowtie, Trinity, BLAST SLIM BLAST NCBI GenBank: release v209 \u2013 \u2013 S C++, Ruby, Flash, Sickle, Google SparseHash, GNU parallel SRSA Megablast NCBI GenBank: CDS translation gt-sequniq, fastq, cutadapt, prinseq-lite, dropcache Taxonomer KAnalyze + custom k-mer matching UniRef90 viruses. BLAST NCBI BLAST nt \u2013 CLC Genomics SAPh-pp CLC Genomics Workbench (7.5), Blast, Bowtie2, Clustal Omega, MEGA6, SimPlot vFam HMMER NCBI RefS repbase human endogenous retroviruses STAR NCBI GRCh37/hg19, Ensembl human cDNA Trinity, Oases PS(A)(S)Ph Python, STAR, BWA-mem, RazerS3, Jalview, Trinity, Oases VirFind BLAST NCBI BLAST nt, NCBI RefSeq viral protein Bowtie2 Custom Velvet, CAP3 PFAS(S) fast BLAST NCBI BLAST nt, nr BLASTn Host genome \u2013 PFS(S) Perl, MySQL, Blast, CD-HIT, repeatMasker VirusSeeker BLAST NCBI BLAST nt, nr viruses (custom), BWA-MEM, MegaBlast, BLASTn, BLASTx NCBI RefSeq. pathSeq removes human reads in a series of filtering steps. the second step is filtering non-target reads. the second step is filtering non-target reads. Clinical PathoScope filters human genomic reads as well as human rRNA reads. VIP includes filtering by first comparing to host and bacterial databases and then to viruses. taxonomer simultaneously matches reads against human, bacterial, fungal and viral references. workflow PC Platform (Linux, Mac, Windows) Graphical user-interface Freely available User manual Runtime Taxonomer Any (webservice), or Linux, Mac OS Yes/no (webservice/local installation) Yes http://regatools.med.kuleuven.be/typing/v3/hiv/typingtool/tutorial 500 seqs in 5 h NBC Any (webservice) Yes (webservice) Use yes, download no http:// 5.5 h MEGAN4 Any Yes For academic use http://ab.inf.uni-tuebingen.de/data/software/megan6/download/manual.pdf 1 h FACS Linux No Yes https://github.com/sciLifeLab/facs \u201d20 times faster than BLAT/SSAHA2\u201c EnsembleAssembler Linux No Yes https://github.com/xutaodeng/Ensembl Virana Linux, Mac OS No Yes https://github.com/schelhorn/virana 30 min/CPU SURPI Linux No Yes https://github.com/chiulab/surpi 1 h (fast), 5 h (comprehensive) RINS Linux No Yes Supplied with download(\") 3 h (2CPU), 15 min (16CPU) IMSA Linux, Mac OS No Yes https://sourceforge.net/projects/arron-ims forge.net/projects/genseedhmm/files Unknown VirVarSeq Linux, Mac OS No Yes https://sourceforge.net/projects/virtools/files/\"source=navbar Unknown VirusSeeker Linux No Yes https://wupathlabs.wustl.edu/virusseeker/usage/ Unknown vFam Linux, Mac OS No Yes \u2013 Unknown PathSeq Linux, cloud (Amazon de novo assembly is liable to generate erroneous contigs by linking together reads containing technical errors. the short viral genomes generally result in high sequencing coverage, at least for high-titre samples. two of the discussed workflows have multiple iterations of assembly and combine algorithms to improve overall assembly. in total, 18 of the tools incorporate an assembly step. some of the more commonly used assembly programs are Velvet (Zerbino and Birney, 2008), Trinity (Grabherr et al., 2011), Newbler (454 Life Sciences), and SPAdes (Bankevich et al., 2012) vFam Developers compared to previous studies 33 (3) 99 (3) 34 (3) Yes (9-2-2014) 19 MEGAN Community Edition IMSA+A \u2013 x x x Yes (12-7-2017) 22 NBC MetLab \u2013 100 (1) 33 (5) 49 (1) Yes (28-7-2010) 125 SURPI Taxonomer \u2013 61 (3) \u2013 Yes (5-6-2015) 128 PathSeq Readscan, developers \u2013 51 (10) \u2013 \u2013 Yes (23 62 (15) \u2013 \u2013 No (16-9-2012) 30 FACS Developers \u2013 99 (2) 100 (2) \u2013 Yes (17-12-2015) 39 Taxonomer Developers \u2013 95 (4) 91 (1) \u2013 Yes (3-7-2017) 16 QuasQ Developers \u2013 96 (9) \u2013 99 (9) Yes (10-7-2014) 5 ViromeScan Developers \u2013 100 (1) \u2013 100 (1) Yes (29-5-2017) 4 GenSeed-HMM Developers \u2013 unknown 0 Rega Typing Tool v3 \u2013 \u2013 \u2013 \u2013 Unknown 79 + 298 VIROME \u2013 \u2013 \u2013 \u2013 Unknown 59 Giant Virus Finder \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 these programs rely on alignments to a reference database and report matched sequences with alignment scores. BLAST can do either nucleotides or amino acids. algorithms have been developed to reduce this time by using alternatives to classical alignment. composition search requires the program to be \u201ctrained\u201d on reference data and it is not used much in viral genomics. only two workflows discussed here use composition search: NBC and Metavir 2. post-processing Classifications of the sequencing reads can be made by setting the parameters of the search algorithm beforehand to return a single annotation per sequence (cut-offs) six workflows use phylogeny to place sequences in a tree with homologous reference sequences and thereby classify them. twenty-seven different workflows (Left) have been subjected to benchmarks, by the developers (Top) or by independent groups (Bottom), measuring sensitivity (Left column), specificity (Middle column) and precision (Right column) a crude categorisation was made dividing workflows into three groups that process a file in a timeframe of minutes (12 workflows: CaPSID, Clinical PathoScope, DUDes, EnsembleAssembler, FACS, Kraken, LMAT, Metavir, NBC, ProViDE, Readscan, Rega Typing Tool, RIEMS, RINS, SLIM, SURPI, Taxy-Pro. similarity search methods had lower sensitivity, but higher specificity and precision than composition search. performance was generally higher for workflows that used more time. applications of workflows Based on the results of our inventory, decision trees were drafted to address the question of which workflow a virologist could use for medical and environmental studies. workflows are suitable for medical purposes when they can detect pathogenic viruses by classifying sequences to a genus level. our inclusion criteria leave out most phylogenetic analysis tools. each workflow is designed to provide taxonomic classification. but the strategies employed to achieve this differ from simple one-step tools to analyses with five or more steps and creative combinations of algorithms. RIEMS and MetLab are examples of high-specificity workflows including pre-processing, filtering and assembly. high-precision methods are essential in variant calling analyses for characterization of viral quasispecies diversity. some viruses that exist in a patient may not be detected by sequencing. others may be detected because of homology to other viruses, wrong annotation in databases or sample cross-contamination. recombination should not affect the results of the reviewed workflows much. biodiversity studies (Oulas et al., 2015; Posada-Cespedes et al., 2016; Tangherlini et al., 2016); reviews then provide directions for establishing best practices. true and false positive and negative results of synthetic tests have to be provided to compare between benchmarks. the evaluation should include complete workflow comparisons and comparisons of individual analysis steps. author contributions AK and MK conceived the study. SN prepared the draft manuscript. all authors were involved in discussions on the manuscript and revision."}