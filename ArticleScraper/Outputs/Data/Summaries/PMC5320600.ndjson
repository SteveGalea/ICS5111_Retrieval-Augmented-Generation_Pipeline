{"summary": "data Summary Supplementary Text S1 has been deposited in figshare: 10.6084/m9.figshare.1334296 Supplementary Tables S1\u2013S3 have been deposited in figshare: 10.6084/m9.figshare.1334294 Impact Statement Large sequence databases have introduced new opportunities to explore patterns of microbial evolution. results on influenza A/H3N2 highlight the potential to significantly advance the process towards understanding the mechanisms linked to the success of major pathogens. model-based statistical methods have a clear advantage over generic approaches when the model is structured to infer biologically relevant information. for microbial proteins one important question is which isolates or strains constitute phenotypically distinct groups, distinguished by specific amino acids fixed by selection. our approach is based on a two-way clustering model inspired by an earlier method (K-Pax) for clustering single protein sequence alignments from distant homologues to identify substructure within a protein superfamily. our current method possesses two significant improvements over the original K-Pax. HA binds sialic acid receptors on the surface of cells and promotes viral entry by fusion of the viral envelope with the endosome membrane. the tertiary structure of HA indicates that there are two main domains: a variable globular head (HA1) that contains the sialic acid binding sites and a conserved stalk region (HA2) involved in membrane fusion. the binary matrix X is assumed to be of dimension n m. the resulting binary matrix X is assumed to be of dimension n m. the resulting binary matrix X is assumed to be of dimension n m. column j represents a putative \u2018selection signal\u2019 if there are at least two groups for which the corresponding probability is different:for all i wk, and i\u2032 wk\u2032 and for some k k\u2032. such signals are only putative, as random drift could still explain a difference in the residue composition. a collection of binary variables zjhrk attaining value 1 if and only if column has property h (h = 1, 2, 3) with status r (r = 1, 2) in cluster, and attaining value 0 otherwise. the pair (W,Z) then contains all the main parameters of interest in our model. equation 2 is equal to the ratio of Beta functionswhere and where and are the hyperparameters of the Beta distribution. probability function can now be compactly rewritten as Prior distributions Let be the joint prior distribution for the partition W and the column classification Z. the matrix Zjh is then modelled by K independent multinomial distributionswhere hr is the prior probability of observing status r when a column has property h. the matrix Zjh is then modelled by K independent multinomial distributionswhere hr is the prior probability of observing status r when a column has property h. our search query consisted of full-length A/H3N2 HA proteins collected from human hosts in any country. after again removing duplicates, the dataset consisted of 4898 unique strains of 567 amino acids. the optimal model allocated the 4898 sequences into 57 different groups while simultaneously detecting 117 possible cluster-defining sites. clusters are sorted by sampling year of the earliest consensus sequence. a similar temporal pattern can be observed by overlaying the clusters on a maximum-likelihood phylogenetic tree. a core cluster can have only a single ancestral core cluster. but potentially multiple descendant clusters, some of which may not be core clusters themselves. a core cluster can descend only from an ancestral core cluster that precedes it by at least 1 year. ancestors are defined as the minimum (average) genetic distance groups. each cluster is labelled by its earliest consensus sequence. highlighted clusters connecting the viruses observed in 1968 to the most recent ones are the \u2018core\u2019 clusters. unadjusted mutation rate estimates, as observed on the HA1 of influenza A/H3N2 by B cell epitope (BCE) rates have been estimated as, where is the total number of amino acid changes, l is the length of the region and t is the time difference in years between two clusters. 0 0 0.0061 2005 0 0.0455 0.037 0 0 0 0.005 0.0091 2006 0.0526 0 0 0 0 0 0.003 2007 0 0 0 0 0.003 2009 0 0.0455 0.0185 0.0122 0 0 0.0061 2010 0 0.0455 0.1111 0 0 0.0101 0.0182 2012(a)* 0.0263 0 0 0 0 0 a two-way clustering model for identifying groups of viral strains under diversifying or directional selection Let denote a multiple sequence alignment of concatenated amino acid sequences. each alignment element thus belongs to the alphabet representing the set of amino acids, including the gap symbol. non-synonymous changes in viral strains that are free from diversifying selection pressure will fluctuate in frequency in the population due to drift. we assume that non-synonymous mutations that do not induce fitness changes will occur at a constant rate throughout the population. non-synonymous changes that are associated with an increase in fitness should rapidly rise in frequency, leading to the formation of a novel group of strains. a site\u2013amino acid pair (column of X) can then be considered either noise (h = 1), a weak signal (h = 2) or a strong signal (h = 3) we define the (prior) predictive probabilitywhere is the Bernoulli distribution and is the conjugate Beta distribution for its parameter, which is explicitly conditioned on the property and status of column in cluster. the probability function can now be compactly rewritten as Prior distributions Let be the joint prior distribution for the partition W and the column classification Z. to define the conditional prior distribution for Z, we follow a hierarchical approach. let = (1, 2, 3)T denote our prior probabilities for a column to represent noise, weak signal or strong signal, respectively. then, h 0 and. Note that these properties are column-specific and they are not affected by any particular partition under consideration. data collection followed a multi-stage approach. first, 12 295 A/H3N2 HA protein sequences were downloaded from three different search engines. after removing duplicates, we aligned data using muscle. the optimal model allocated the 4898 sequences into 57 different groups while simultaneously detecting 117 (out of 567 possible) cluster-defining sites. a similar temporal pattern can be observed by overlaying clusters on a maximum-likelihood phylogenetic tree. phylogenetic tree of influenza A/H3N2 HA is denoted in the tree as different colours. each virus group is associated with a particular subset of the 117 sites. cluster-defining amino acids can be interpreted as a fingerprint of fitness change that did lead to proliferation of the lineage represented by the cluster. the tree in Fig. 3 was reconstructed by choosing, for each group, the ancestor associated with the minimum distance. core clusters can be interpreted as the backbone clades of the A/H3N2 HA phylogeny, connecting the viruses observed in 1968 to the most recent ones. antigenic drift is thought to occur when an average of four amino acid changes accumulates over time. many of the cluster transitions in Fig. 5 agree with this definition. some carry fewer substitutions, which illustrates the usefulness of more flexible, statistical model-based rules. 0.0526 0.0682 0 0.0244 0 0 0.0106 1983 0.0132 0.0114 0.0093 0.0183 0 0.0013 0.0053 1988 0.0105 0.0273 0 0 0.0091 0 0.0013 0.0053 1989 0.0526 0 0.037 0 0.0909 0 0.0121 1992 0.0175 0.0758 0.0123 0.0081 0.0152 0 0.0091 1993 0.0526 0 0 0.037 many clusters are clearly distinct from each other, supporting the conclusion that K-Pax2 successfully identifies meaningful phenotypes. the pairs of clusters where an overlap occurs represent core clusters that arise in succession in Fig. 4. this suggests that our method has high sensitivity to detect changes that relate to early antigenic separation of strains. a Bayesian modelling approach can identify patterns of sequence variation that reflect known existing drivers of A/H3N2 evolution. the results suggest the power of K-Pax2 to extract evolutionary signals from microbial sequence collections. however, there are caveats to be aware of."}