{"summary": "recent advances in sequencing technologies have enabled more widespread study of heterogeneity and sub-populations in a cell population. such a \u2018population perspective\u2019 has applications in a range of biological systems, from characterization of viral quasi species and intra-host variation (1,2), to bacterial sub-populations (3\u20135), to sub-clonal evolution in cancer (6\u20138) methods used in these studies rely on ad hoc trimming, filtering and thresholds to call variants, limiting their sensitivity and widespread applicability. recent model-based approaches such as Breseq (27,28) and SNVer (29) are potentially more sensitive and generic, but rely on simple binomial models. a more sophisticated approach, that relies on phasing to reduce the effect of sequencing errors and is tailored to 454 sequencing has recently been applied to viral datasets resulting method, LoFreq, adapts automatically to sequencing run and position-specific sequencing biases. the method can call rare somatic SNVs (in exome sequencing datasets for gastric cancer) and for studying dengue virus quasi species before and after treatment in a clinical study. the fragments were gel extracted from 1% agarose gel prepared in 1 TBE buffer. the concentrations were measured using the nanoDrop ND 1000 Spectrophotometer. the samples were purified using the Qiagen PCR purification kit. RNA was extracted using the QIAamp Viral RNA Mini Kit (Qiagen) the extracted RNA underwent library preparation as described above. Sequencing Dengue virus samples were sequenced on an Illumina GA-II sequencer to obtain 35 bp reads. the diluted cDNA and pre-mix were transferred into the primed chip and loaded using an Integrated Fluidic Circuit Controller MX (Fluidigm) data were extracted and analyzed using the Digital PCR Analysis Software (Fluidigm). the abundance of the haplotypes (Metasim\u2019s taxonomy profile) was set according to a geometric series (multiplicative factor of 2) resulting in haplotype and corresponding SNV frequencies. reads supporting any called variants were removed to make the datasets appear \u2018clonal\u2019 while retaining sequencing errors. each trial is assumed to be independent with an associated sequencing error probability that can be derived from a Phred-scaled quality value (Q) for the base. the number of variant bases (K) in a column of N bases is then given by a Poisson\u2013binomial distribution. the number of variant bases (K) in a column of N bases is then given by a Poisson\u2013binomial distribution. a key refinement in LoFreq is based on the following recursion: (2) where Sn = kK Prn(X = k) this recursion can be derived directly from Equation (1). the worst-case runtime for LoFreq is reduced to O(KN) maximization and expectation steps are iterated until error probabilities converge (109) for final SNV calling, the expectation step was used with the converged error probabilities. this EM-based approach (LoFreq-NQ) is faster and more sensitive (but has higher false-positive rates; data not shown) reads of the clinical DENV1 and DENV2 samples were mapped against Genbank sequences FJ410275 and EU660415. a two-step mapping approach was used in which a consensus was derived from the initial mapping. for this, we gradually lowered RazerS\u2019 identity thresholds in 2% steps from the default of 92%. the samples were collected as part of a drug-trial study for the nucleoside-analog Balapiravir (31). Numbers in parentheses report the total number of samples sequenced. un-parenthesized numbers report the number of pairs (a pre- and post-dose sample) that were sequenced. whole-genome sequencing data for analysis of whole-genome sequencing data. we applied the same filtering rules for samtools and LoFreq to allow for a fair comparison. we removed any bases with a quality 13 (samtools default) and removed predicted SNVs with a quality 40 (0.01% error rate) SNVer We used SNVer version 0.3.1, which automatically determines error rates, whereas the original version needed a fixed, user-defined sequencing error threshold (29). the original version needed a fixed, user-defined sequencing error threshold (29). SNVs were called with a Bonferroni-corrected P-value threshold of 0.05. the same threshold was applied for calling somatic variants with the binomial test. sequencing data will be available soon from the Sequence Read Archive. the samples were purified using the Qiagen PCR purification kit. the samples underwent end-repair, A-tailing and ligation of adapters according to the manufacturer\u2019s instructions. RNA was extracted using the QIAamp Viral RNA Mini Kit (Qiagen) the extracted RNA underwent library preparation as described above. the sample was divided into six reactions, which were indexed and multiplexed accordingly. samples were purified using the Qiagen PCR purification kit (Qiagen, Valencia, CA, USA) the samples were quality-checked (2100 Bioanalyzer with a DNA 1000 Chip, Agilent Technologies, Santa Clara, CA, USA) for library preparation, the NEBNext DNA Sample Prep Master Mix 1 kit (New England Biolabs) was used. samples underwent end-repair, A-tailing and ligation of adapters according to manufacturer\u2019 experimental validation Fluidigm digital array DENV2 NGC cDNA was used to construct two sets of libraries in parallel (PCR duplicates) and sequenced on an Illumina Genome Analyzer II to obtain 2 75 bp paired-end reads. 12 low-frequency SNVs were called on both replicates using LoFreq, SNVer and Breseq. assays for the sequence variants were designed in multiplex. the genotyping step comprises an initial PCR reaction to amplify the viral genomic region of interest followed by primer extension. the size of the extended products thus represents viral genotype status. the diluted cDNA and pre-mix were transferred into the primed chip and loaded using an Integrated Fluidic Circuit Controller MX (Fluidigm) the chip was then run on the The BioMarkTM System (Fluidigm) using the Data Collection Software. the abundance of the haplotypes (Metasim\u2019s taxonomy profile) was set according to a geometric series (multiplicative factor of 2) resulting in haplotype and corresponding SNV frequencies ranging from 0.1\u201350%. reads supporting any called variants were removed to make the datasets appear \u2018clonal\u2019 while retaining sequencing errors. from the haplotype sequences, we simulated 35 bp reads using Metasim. for each coverage level (50, 100, 500, 1000, 5000 and 10 000), 10 replicates were simulated. the abundance of the haplotypes was set according to a geometric series. reads supporting any variants were removed to make the datasets appear \u2018clonal\u2019 while retaining sequencing errors. LoFreq Models sequencing error Given an alignment of reads to a consensus reference, each base in a column is assumed to be independent with an associated sequencing error probability. each trial is assumed to be independent with an associated sequencing error probability that can be derived from a Phred-scaled quality value (Q) for the base. a key refinement in LoFreq is based on the following recursion: (2) where Sn = kK Prn(X = k) this recursion can be derived directly from Equation (1) and allows LoFreq to only compute the pmf for k K, in addition to keeping track of Sn using Equation (2). the worst-case runtime for LoFreq is reduced to O(KN) expectation step calls SNVs using a binomial test (Bonferroni-corrected P-value 0.05) the maximization step updates the error probabilities based on base counts in columns in which the respective substitution class was not called a SNV. for final SNV calling, the expectation step was used with the converged error probabilities. a user can choose to ignore variants with high strand bias. a user can then choose to ignore variants with high strand bias. each trial is assumed to be independent with an associated sequencing error probability. each trial can have a distinct success probability. a key refinement in LoFreq is based on the following recursion: (2) where Sn = kK Prn(X = k) this recursion can be derived directly from Equation (1) and allows LoFreq to only compute the pmf for k K. thus, the worst-case runtime for LoFreq is reduced to O(KN)\u2014a significant gain when most columns have few variant bases. expectation step calls SNVs using a binomial test (Bonferroni-corrected P-value 0.05) the maximization step updates the error probabilities based on base counts in columns in which the respective substitution class was not called a SNV. for final SNV calling, the expectation step was used with the converged error probabilities. a user can choose to ignore variants with high strand bias. reads of the clinical DENV1 and DENV2 samples were mapped against Genbank sequences FJ410275 and EU660415. the recognition rate was set to 100%, allowing no indels. resulting numbers were compared for drug and placebo group pairs using the Mann\u2013Whitney test. numbers in parentheses report the total number of samples sequenced. un-parenthesized numbers report the number of pairs (a pre- and post-dose sample) that were sequenced. the resulting numbers were compared for drug and placebo group pairs using the Mann\u2013Whitney test. numbers in parentheses report the total number of samples sequenced. un-parenthesized numbers report the number of pairs (a pre- and post-dose sample) that were sequenced. the real dataset was assumed to be genetically clonal with no true rare SNVs to be detected. the real dataset was assumed to be genetically clonal with no true rare SNVs to be detected. if more than three SNPs are present in a window of 20 bp, they were removed to reduce indel-associated artifacts. if more than three are present in a window of 20 bp, they were removed to reduce indel-associated artifacts. a somatic variant was reported for a variant call unique to the tumor. the normal genotype called by samtools was different and less than two reads of the variant genotype were seen in the normal sample. if more than three SNPs were present in a window of 20 bp, they were removed to reduce indel-associated artifacts. LoFreq LoFreq takes a samtools pileup as input (samtools mpileup; Version 0.1.18) by default samtools applies a coverage cap and we set this to be sufficiently high to avoid filtering reads in a sample (-d 100000). Whenever indels were not allowed for read mapping, we switched off samtools BAQ computation (-B) LoFreq LoFreq takes a samtools pileup as input (samtools mpileup; version 0.1.18) by default samtools applies a coverage cap and we set this to be sufficiently high to avoid filtering reads in a sample (-d 100000) the heuristic approaches performed poorly in terms of sensitivity or PPV. all the model-based approaches (SNVer, Breseq and LoFreq) had perfect PPV and therefore perfect specificity. we present results for Breseq\u2019s stand-alone variant caller (indicated with Breseq*) in this comparison as the Breseq pipeline unexpectedly performed poorly on this dataset. we also created \u2018simulated population\u2019 datasets using real sequencing data. the detection limits of rare variant-calling methods have not been systematically assessed before. the general assumption has been that variants at a frequency lower than the average error rate in a dataset are likely to be undetectable (23) to study this aspect further, we evaluated the methods on datasets with controlled coverage values and counts. sensitivity is the major limiting factor for variant callers. the presence of SNVs seen in two or more replicates, but not in all six replicates. sensitivity and robustness of variant callers suggests sequencing coverage may be a bottleneck to fully capture true variants. LoFreq is generic and fast enough to be applied to large genomes and low-coverage datasets. compared results with those from a commonly used genotype caller on human re-sequencing datasets, samtools (14). the runtime for LoFreq was roughly 1 min on a dataset with 3700 coverage of the dengue virus genome (size = 10.7 kb), 1 h for 600 coverage of the E. coli genome (size = 4.6 Mbp) and 1 h and 20 min for 100 coverage of the human exome (size = 33 Mbp) the runtime for LoFreq was roughly 1 min on a single processor. the frequencies estimated by LoFreq were within the experimentally predicted ranges in all cases. Breseq was correct in seven out of nine predictions while SNVer was only able to correctly call two of the higher frequency variants. SNVer had two false-positive calls on this dataset. paired samples from Zang et al. (32) revealed an asymmetric frequency distribution for the somatic SNVs called. this suggests sample contamination can lead to significantly reduced sensitivity even with high sequencing coverage. a systematic approach to call low-frequency somatic SNVs helps to recover the full distribution. somatic mtDNA mutations have been seen in a diverse set of cancers (45) and mutations in the NADH dehydrogenases could potentially play an important role. we identified one somatic SNV (8300:T>C at 25%) in the tRNA (Lys) gene in patient NGC0082. rare heteroplasmic variations have previously been studied with targeted re-sequencing, followed by ad hoc filtering and detection rules. otype 1, 2 and 3 (DENV1, DENV2 and DENV3) samples using LoFreq SNV calls. no significant changes can be seen in this frequency for any serotype. we do detect other changes in viral intra-host variation. a shared cold-spot in the membrane glycoprotein precursor protein (prM), known to be critical for assembly and secretion of all flavivirus virions (50) this region was only recently shown to be conserved across flaviviruses (51), though this conservation cannot be readily observed from an alignment of >2900 complete dengue virus genomes available in GenBank. cold-spots and hotspots on the NS3 serine protease and helicase. delineating potential interactions surfaces and key resides can be found in Supplementary Figure S6. we suggest sequencing and characterizing the intra-host variation in relatively small set of samples can be sufficient for such analysis. cold-spots include the dengue virus NS5 RNA-dependent RNA polymerase GDD catalytic triad. cold-spots identified from SNV analysis are colored in violet. heuristic approaches performed poorly in terms of sensitivity. SNVer, Breseq and LoFreq consistently detect the highest number of true SNVs in all frequency ranges. the results highlight the utility of the quality-aware approach in LoFreq. LoFreq finds >40 variants that are missed by SNVer and Breseq. predictions made by Breseq and SNVer were found to be essentially a subset of LoFreq\u2019s prediction. LoFreq increased overall sensitivity by 25 and 71% compared with SNVer and Breseq respectively. SNVer had a substantially higher detection limit (1%) that was unaffected by the quality of the data. sensitivity is the major limiting factor for variant callers. sensitivity is the major limiting factor for variant callers. our results from simulated and real datasets suggest that LoFreq is a conservative as well as an ultra-sensitive variant caller. to characterize the false-positive rates for LoFreq further, we analyzed simulated as well as real data for an E. coli clone (560 coverage; see \u2018Materials and Methods\u2019 section) LoFreq had similar precision as samtools (PPV = 99.8% for both methods and datasets) but higher sensitivity as measured on a SNP array. the results provide the basis for applying LoFreq to sensitively and accurately call somatic variants from paired tumor/normal sequencing datasets. coli genome (size = 4.6 Mbp) and 1 h and 20 min for 100 coverage of the human exome (size = 33 Mbp) a parallel implementation of LoFreq is straightforward and would provide further runtime improvements for large genomes. SNVer detected all five calls and Breseq detected four out of five calls. results highlight the fact that LoFreq calls are likely to be at least as sensitive as this commonly used mass-spectrometry-based gold-standard for validating SNVs. samtools-based somatic calls appear \u2018clipped\u2019 at lower frequencies. samtools-based somatic calls appear \u2018clipped\u2019 at lower frequencies. samtools-based somatic calls are symmetrically distributed as expected. sensitivity and robustness of LoFreq allow for the characterization of subtle shifts in the viral quasi species. we highlight this capability by analyzing dengue virus sequencing datasets from a drug-trial study for the nucleoside-analog Balapiravir. mutational hotspots and cold-spots in the dengue virus genome. inner bars mark mutational hotspots (red) and cold-spots (blue) the cold-spot in prM is shared between both serotypes. last hotspot window in NS1 for DENV2 samples was only found in pre-dose samples. a second group of cold-spots corresponds to the carboxyl end which acts as the linker region that connects to the NS5 polymerase domain. a representation of cold-spots on the NS5 RNA-dependent RNA polymerase domain encompasses the critical GDD catalytic triad. the nucleoside-analog ribavirin 5\u2032-triphosphate (RTP) is shown in blue. the by-product of S-adenosyl-l-methionine (SAM) after the transfer of a methyl group, S-adenosyl-l-homocysteine (SAH) is in red, both in ball-and-stick representation. more complex models for sequencing errors can be constructed, that say account for correlations between adjacent bases. but further significant gains in sensitivity are possible using a quality-aware approach (LoFreq) LoFreq is based on calibrated quality values that are commonly generated from sequencing data. conservative quality values or an estimate of average quality values can be employed with an accompanying loss in sensitivity and specificity."}